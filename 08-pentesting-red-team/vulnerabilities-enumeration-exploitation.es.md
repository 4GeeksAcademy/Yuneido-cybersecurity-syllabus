# Enumeración y explotación de vulnerabilidades

## **Enumeración web con WPScan**

WPScan se lanzó por primera vez en 2011, ha sobrevivido al tiempo y se destacó como una herramienta vital que todo pentester debería tener en su caja de herramientas.

WPScan es capaz de enumerar e investigar algunas categorías de vulnerabilidades de seguridad presentes en los sitios de WordPress como:

- Divulgación de información confidencial (versiones de instalación de complementos y temas para vulnerabilidades reveladas o CVE)
- Descubrimiento de ruta (buscando permisos de archivos mal configurados)
- Políticas de contraseñas débiles (fuerza bruta de contraseñas)
- Presencia de instalación predeterminada (buscando archivos predeterminados)
- Prueba de firewalls de aplicaciones web (complementos WAF comunes)

### **Instalación:**

Afortunadamente, WPScan viene preinstalado en la última versión de Kali Linux y Parrot OS. Si está utilizando una versión anterior de Kali, simplemente puede instalarla desde el siguiente comando en su terminal.

> sudo apt update && sudo apt install wpscan

![WPScan1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan1.png?raw=true)

Si está utilizando diferentes sistemas operativos y otras distribuciones, puede consultar la documentación del [desarrollador](https://github.com/wpscanteam/wpscan#install) y aprender cómo instalarlo en su máquina.

**Base de datos de WPScan:**

WPScan utiliza información dentro de una base de datos local como punto de referencia principal al enumerar temas y complementos. Antes de utilizar WPScan, se recomienda encarecidamente que actualice esta base de datos antes de realizar cualquier análisis.

Para actualizar su base de datos wpscan, simplemente ejecute este comando en su terminal

> wpscan --update

![WPScan2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan2.png?raw=true)

### **Enumeración de temas:**

WPS puede tener algunas formas de determinar el tema instalado en el sitio. Básicamente, primero utiliza una técnica que también podemos hacer manualmente. Simplemente podemos mirar los activos de las cargas del navegador web y luego buscar la ubicación del tema instalado en el servidor web. Usando la pestaña "Red" en su navegador web, puede ver qué archivos se cargan cuando visita ese sitio.

![WPScan3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan3.png?raw=true)

Arriba podemos ver una captura de pantalla donde se han cargado muchos archivos y mientras los revisaba encontré esta URL

[http://www.anywordpressintalledsite.com/wp-content/themes/twentynineteen](http://www.anywordpressintalledsite.com/wp-content/themes/twentynineteen)

Al mirar esta URL podemos estar seguros de que el tema instalado es twentynineteen. Ahora automaticemos nuestro trabajo, usemos nuestro wpscan para descubrir qué tema exacto se está ejecutando escribiendo el siguiente comando

> wpscan --url http://www.anywordpressintalledsite.com/ --enumerate t
> 

y aquí esta el resultado:

![WPScan4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan4.png?raw=true)

Lo mejor de  wpscan es que le dice cómo descubrió ese resultado.

![WPScan5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan5.png?raw=true)

### **Enumeración de complementos:**

una característica muy común del servidor web es la lista de directorios, es como el comando **ls** en Linux. Enumera los archivos y directorios enumerados en ese servidor web. El “Listado de directorios” ocurre cuando no hay ningún archivo presente que se le haya indicado al servidor web que procese. Un archivo muy común es “index.html” e “index.php”. Como estos archivos no están presentes en el directorio /a/, se muestran los contenidos:

![WPScan6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan6.png?raw=true)

wpscan puede aprovechar esta función para averiguar qué complementos están instalados. Dado que todos estarán ubicados en /wp-content/plugins/pluginname, WPScan puede enumerar complementos comunes/conocidos. Podemos usar el siguiente comando para enumerar complementos.

> wpscan --url http://www.anywordpressintalledsite.com/ --enumerate p
> 

Al leer la documentación para desarrolladores de WordPress, podemos aprender sobre el "[read me](https://developer.wordpress.org/plugins/wordpress-org/how-your-readme-txt-works/#how-the-readme-is-parsed)" para descubrir cómo WPScan determinó el número de versión. Simplemente, los complementos deben tener un archivo “README.txt”. Este archivo contiene metainformación como el nombre del complemento, las versiones de WordPress con las que es compatible y una descripción.

![WPScan7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan7.png?raw=true)

### **Enumeración de usuarios:**

Después de leer todo esto, creo que se dará cuenta de lo poderosa que es esta herramienta. Entonces, si te digo que también podemos enumerar usuarios usando esta herramienta, no te sorprenderá. La forma en que WPScan enumera a los usuarios es interesantemente simple. Los sitios de WordPress utilizan autores para las publicaciones. Los autores son de hecho un tipo de usuario.

![WPScan8](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan8.png?raw=true)

Usemos nuestro wpscan para escanear a los usuarios y ¿cómo podemos hacerlo exactamente? simple siguiendo el comando dado

> wpscan --url http://www.anywordpressintalledsite.com/ --enumerate u

![WPScan9](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan9.png?raw=true)

Arriba podemos ver que encontró al usuario pero dice algo de fuerza bruta. sí, también puede hacer eso. wpscan puede aplicar fuerza bruta usando una lista mundial. ¿Después de eso dice error de inicio de sesión? sí, intentó iniciar sesión con ese nombre de usuario y descubrió que el usuario es real.

![WPSca10](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan10.png?raw=true)

**La bandera "Vulnerable":**

hasta ahora solo hemos enumerado temas, complementos y usuarios y luego visitaremos sitios como MITRE, NVD y CVEDetails para buscar los nombres de estos complementos y los números de versión para determinar cualquier vulnerabilidad. Lo cual lleva bastante tiempo y es aburrido. Es por eso que wpscan tiene un indicador específico para hacer nuestro trabajo y ese indicador es -v. Para comprobar si algún complemento instalado es vulnerable o no, podemos escribir este comando y averiguarlo.

> wpscan --url http://www.anywordpressintalledsite.com/ --enumerate vp

Arriba dije -v flag pero escribí vp. ¿Cometí un error? No, esa p significa complemento para que pueda indicarle a wpscan que verifique los complementos si son vulnerables o no.

![WPSca11](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan11.png?raw=true)

Obtuvimos nuestros resultados en solo unos segundos y descubrimos que los complementos no son vulnerables.

### **Ataque de contraseña:**

Después de determinar una lista de posibles nombres de usuario en la instalación de WordPress, podemos usar WPScan para realizar una técnica de fuerza bruta contra el nombre de usuario que especificamos y una lista de contraseñas que proporcionamos. Simplemente, usamos el resultado de nuestra enumeración de nombre de usuario para crear un comando como este:

> wpscan --url http://www.anywordpressintalledsite.com/ –-passwords rockyou.txt –-usernames Phreakazoid

![WPSca12](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan12.png?raw=true)

### Ajuste de la agresividad de WPScan (WAF):

a menos que se especifique, WPScan intentará ser lo menos "ruidoso" posible. Muchas solicitudes a un servidor web pueden activar cosas como firewalls y, en última instancia, provocar que el servidor lo bloquee.

Esto significa que nuestro WPScan puede omitir algunos complementos y temas. Afortunadamente, podemos usar argumentos como --plugins-detectiony un perfil de agresividad (pasivo/agresivo) para especificar esto. Por ejemplo:--plugins-detection aggressive

### **Resumen - Hoja de referencia:**

> p Enumerate Plugins --enumerate p

> t Enumerate Themes --enumerate t

> u Enumerate Usernames --enumerate -u

> v  check if plugin is vulnerable  --enumerate vp

> aggressive adjust aggressiveness --plugins-detection aggressive
 

## **Enumeración web usando Gobuster**

### **Enumeración manual**

Cuando comienza su enumeración web, la mejor herramienta que puede utilizar es su navegador favorito. El mío es Firefox, así que puedes usar el tuyo como Chrome, Opera y Brave también es bastante bueno. Mantiene un registro de los datos que recibe y de quién. Podemos usar esto para una variedad de actividades: encontrar esa foto exacta o, más útilmente, la ubicación de ciertos archivos o activos que se están cargando. Esto podría incluir cosas desde scripts hasta URL de páginas.

### **Usando nuestra consola de desarrollador de navegadores**

Los navegadores, incluidos Chrome y Firefox, tienen un conjunto de herramientas ubicadas en "Herramientas de desarrollo/Consola". Vamos a hablar de Firefox, sin embargo, Chrome tiene una suite muy similar. Esta suite incluye una gama de herramientas que incluyen:

- Ver el código fuente de la página
- Encontrar activos
- Depuración y ejecución de código como javascript en el lado del cliente (nuestro navegador)

Usando "F12" en nuestro teclado, este es un atajo para iniciar este conjunto de herramientas.

![WPSca13](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan13.png?raw=true)

En la imagen de arriba puede ver el encabezado de la página Hola mundo y allí abajo puede ver que la herramienta "inspector" de la sección está abierta. Esto nos permite ver el código fuente html de la página web. A menudo contiene cosas como comentarios de desarrolladores y el nombre de ciertos aspectos de las características de la página web, incluidos formularios y me gusta.

Los desarrolladores suelen dejar comentarios en forma de **<! — →** etiquetas…por ejemplo: <! — Este es un comentario → que no se muestra en el navegador como podemos ver aquí:

![WPSca14](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan14.png?raw=true)

## **Gobuster**

Gobuster es una de las mejores herramientas que existen para enumerar sitios web y por web me refiero a directorios, DNS, subdominios y mucho más. Puede obtener más información y el código fuente [aquí](https://github.com/OJ/gobuster) .

**Comencemos con cómo instalar Gobuster en Kali Linux:**

Puede instalar gobuster usando el siguiente comando en su terminal.

> sudo apto instalar gobuster

**Flags**

> - t --threads No. de subprocesos simultáneos
> - v --verbose Salida detallada
> - z --no-progress No mostrar el progreso
> - q --quiet No imprimir el banner y el ruido
> - o -- salida Archivo de salida para escribir los resultados

Normalmente cambiaré la cantidad de subprocesos a 64 para aumentar la velocidad de mis escaneos. Si no cambia la cantidad de subprocesos, Gobuster puede ser un poco lento.

## **Modos Gobuster**

Gobuster es una herramienta muy poderosa y versátil. Tiene diferentes modos para hacer diferentes cosas, como el modo dir se usa cuando busca directorios web en una aplicación web y el modo dns se usa cuando busca subdominios.

### **Modo “dir”:**

podemos adivinar qué hace este modo, ya que su nombre lo indica se utiliza para forzar directorios en aplicaciones web. Es una herramienta muy poderosa que no solo escanea el sitio web sino que también devuelve su código de estado y esto le permitirá saber inmediatamente si usted, como usuario externo, puede solicitar ese directorio o no. La funcionalidad adicional de Gobuster es que también te permite buscar archivos con la adición de una simple bandera.

- **Usando el modo dir** :

Para usar el modo dir, escriba el siguiente comando

> gobuster dir

Este no es el comando completo pero le dice al gobuster que el usuario desea buscar directorios en web. Ahora, después de esto, tendrás que agregar la URL y la lista de palabras.

> gobuster dir -u [http://](https://google.com/)10.10.10.10 -w wordlist.txt

**Nota** : La URL será la ruta base desde donde Gobuster comienza a buscar. Entonces, la URL anterior utiliza el directorio web raíz. Por ejemplo, en una instalación típica de Apache en Linux, esto es */var/www/html* . ***[Entonces ,](http://10.10.10.10/products.)*** si tiene un directorio de " **productos** " y desea enumerar ese directorio, debe configurar la URL como *[http://10.10.10.10/productos* .](http://10.10.10.10/products.) También puedes pensar en esto como *[http://example.com/path/to/folder* .](http://example.com/path/to/folder.) Observe también que especifiqué el protocolo HTTP. Esto es importante y necesario.

**Otras banderas útiles:**

> - c --cookies Cookies que se usarán en las solicitudes
> - x --extensions Extensión(es) de archivo a buscar
> - H --headers Especifique encabezados HTTP, -H 'Encabezado1: val1'
> - k --no-tls -validation Omitir la verificación del certificado TLS
> - n --no-status No imprimir códigos de estado
> - P --password Contraseña para autenticación básica
> - s --status-codes Códigos de estado positivos
> - b --status-codes-blacklist Códigos de estado negativos
> - U --username Nombre de usuario para autenticación básica

aquí -x o - el indicador de extensiones es realmente útil para buscar archivos con una extensión específica.

> gobuster dir -u http://10.10.10.10 -w wordlist.txt -x html,php,bak

En el comando anterior especificamos buscar solo aquellos archivos que tengan extensión .html, .php, .bak. El indicador -k es especial porque tiene un uso importante durante las pruebas de penetración y captura los eventos del indicador. En una sala de captura de bandera en TryHackMe, por ejemplo, si HTTPS está habilitado, lo más probable es que encuentre un error de certificado no válido como el siguiente

![WPSca15](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan15.png?raw=true)

Si ejecuta gobuster en este sitio sin -k flag gobuster aparecerá un error largo, así que para evitar este tipo de certificaciones no válidas y brindarle sus resultados, use -k falg en su comando.

### **Modo “dns”:**

el siguiente modo en el que nos centraremos es el modo “dns”. Esto permite a Gobuster aplicar fuerza bruta a subdominios. Durante una prueba de penetración (o capturar la bandera), es importante verificar los subdominios del dominio principal de su objetivo. Los subdominios aumentan su alcance, por lo que un alcance mayor tiene mayores posibilidades de encontrar una vulnerabilidad.

- **Usando el modo “dns”:**

Puede usar el modo dns escribiendo el siguiente comando en su terminal

> gobuster dns 

Como modo directorio, este comando está incompleto, esto le indicará al gobuster que el usuario desea realizar fuerza bruta en el subdominio, por lo que debe especificar nuevamente un dominio y un archivo de lista de palabras.

> gobuster dns -d mydomain.com -w subdomains.txt

Este comando le dice a gobuster que realice una fuerza bruta en un subdominio en midominio.com

Otras falgs útiles:

> -c --show-cname Mostrar registros CNAME (no se puede usar con '-i')
> - i --show-ips Mostrar direcciones IP
> - r --resolverUsar servidor DNS personalizado

### **Modo vhost:**

El último modo en el que nos centraremos es el modo “vhost”. Esto permite a Gobuster aplicar fuerza bruta a hosts virtuales. Los hosts virtuales son diferentes sitios web en la misma máquina. En algunos casos, pueden parecer subdominios, ¡pero no te dejes engañar! Los hosts virtuales están basados ​​en IP y se ejecutan en el mismo servidor. Esto no suele ser evidente para el usuario final. En un compromiso, puede que valga la pena ejecutar Gobuster en este modo para ver si se le ocurre algo. ¡Nunca se sabe, puede que encuentre algo! Al participar en salas de TryHackMe, los hosts virtuales serían una buena manera de ocultar un sitio web completamente diferente si no apareciera nada en el escaneo del puerto principal 80/443.

**Usando el modo vhost:**

como dir y dns, simplemente puede escribir el siguiente comando y ejecutar el modo vhost en gobuster:

> gobuster vhost

Esto notifica al gobuster que el usuario desea aplicar fuerza bruta a los hosts virtuales en la URL de destino. Después de esto, debes proporcionar una URL y un archivo de lista de palabras.

> gobuster vhost -u [http://10.10.10.10](http://10.10.10.10/) -w wordlist.txt

**Otras banderas útiles:**

Puedes ver su bandera y otra documentación en la [documentación oficial.](https://github.com/OJ/gobuster#vhost-mode-options)

**Listas de palabras predeterminadas de Kali Linux:**

estas son las listas de palabras predeterminadas que vienen preinstaladas en Kali Linux. Mencionaré las listas de palabras uso para realizar fuerza bruta de directorios en Kali Linux.

- /usr/share/wordlists/dirbuster/directory-list-2.3-*.txt
- /usr/share/wordlists/dirbuster/directory-list-1.0.txt
- /usr/share/listas de palabras/dirb/big.txt
- /usr/share/wordlists/dirb/common.txt
- /usr/share/listas de palabras/dirb/small.txt
- /usr/share/wordlists/dirb/extensions_common.txt: ¡útil para buscar archivos!

/usr/share/wordlists tiene muchas listas de palabras para diferentes tareas. Puedes ir allí y comprobarlas todas vos mismo.

**Listas no estándar:**

además de lo anterior, Daniel Miessler ha creado un increíble repositorio de GitHub llamado [SecLists](https://github.com/danielmiessler/SecLists) . Compila muchas listas diferentes utilizadas para muchas cosas diferentes. ¡La mejor parte es que está en apto! simplemente puede instalar todas esas listas de palabras en su kali usando el siguiente comando:

> sudo apt install seclists

En estas dos listas de palabras creo que obtendrás todo tipo de listas mundiales para hacer tu trabajo de fuerza bruta.

## **Burp Suite: enumeración de páginas web y pruebas de vulnerabilidad**

**¿Qué es Burp Suite?**

Burp Suite es una plataforma integral para pruebas de seguridad de aplicaciones web. Se puede utilizar para enumeraciones y análisis detallados de aplicaciones web. La herramienta puede simplemente interceptar solicitudes HTTP/S y actuar como intermediario entre el usuario y los sitios. Los detalles necesarios se capturan del sitio web a medida que el usuario navega. Esta información proporciona información sobre la seguridad de una aplicación web. *Burp puede actuar como intermediario interceptando el tráfico desde su navegador a una página web, permitiéndole modificar y automatizar cambios en las solicitudes de la página web.*

Al abrir Burp, te encuentras con un proyecto en blanco con un montón de pestañas. No te preocupes, cubriremos las pestañas esenciales.

### **Configuración de la suite Burp**

Confirme que el oyente Burp Proxy esté activo

- Abra burp y navegue hasta la pestaña proxy → opciones
- Verifique que el detector de proxy esté activo y configurado en 127.0.0.1:8080

Configurar proxy en el navegador web

- Para Firefox, navegue a preferencias → avanzado → red → configuración
- Active *la configuración manual de proxy: verifique que esté configurado en el mismo proxy que burp (127.0.0.1 en el puerto 8080).*

![WPSca16](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan16.png?raw=true)

### **Instalación del certificado SSL Burp**

- Navegue hasta [http://burp](http://burp/) y descargue el certificado haciendo clic en *Certificado CA* a la derecha.
- Regrese a la página de configuración de seguridad de la red en Firefox y haga clic en *Certificados*
- Desde allí, importe el certificado que descargó y marque todas las casillas.

![WPSca17](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan17.png?raw=true)

### **Características básicas**

Para comenzar, familiaricémonos con algunas de las pestañas comunes disponibles en Burp Suite: Intruso, Repetidor y Secuenciador.

**Intruder**

Con Burp Intruder, se pueden automatizar ataques personalizados contra aplicaciones web. La personalización de ataques requiere que especifiquemos una o más cargas útiles y la posición donde se colocarán en el sitio web.

- Casos de uso: enumeración de identificadores, recopilación de datos útiles y búsqueda de vulnerabilidades.

**Repeater**

- El repetidor se puede utilizar para repetir solicitudes HTTP individuales manipuladas manualmente. Esto resulta tremendamente útil cuando se prueban varias cargas útiles en la misma solicitud. Con el repetidor puedes probar parámetros en la misma página sin hacer ningún trabajo adicional con el navegador. Emitir solicitudes en una secuencia específica se vuelve mucho más fácil y puede identificar cómo reacciona la página a los parámetros cambiantes en cada paso.
- Casos de uso: probar un conjunto de parámetros específicos en la misma solicitud de página web y volver a emitir solicitudes para verificar manualmente los problemas informados.

**Sequencer**

- El secuenciador Burp se puede utilizar para analizar la calidad de la aleatoriedad en una muestra de elementos de datos. En última instancia, esto significa que el secuenciador es bueno para probar elementos de datos que deben ser impredecibles.
- Casos de uso: prueba de tokens anti-CSRF o tokens de restablecimiento de contraseña, etc.

### **Ejemplo de explotación de vulnerabilidad con Burp**

Burp Suite nos brinda herramientas de automatización adicionales para usar mientras probamos una aplicación web. Para practicar el ataque a vulnerabilidades utilizaremos la **[aplicación web Damn Vulnerable (DVWA)](http://www.dvwa.co.uk/)** . **DVWA** viene precargado con Metasploitable 2 pero también se puede descargar de forma independiente y ejecutar desde un servidor local. **DVWA** está separado para ataques específicos, como se ve en su barra de navegación lateral. Esto nos brinda la oportunidad de explorar ataques web comunes en distintos niveles de dificultad.

Una vez que **DVWA** esté en funcionamiento, inicie sesión y navegue hasta la pestaña de seguridad para cambiar el nivel de seguridad a bajo. Esto hará que el sitio web sea vulnerable a una gama más amplia de ataques, lo que hará que sea más fácil sentirse cómodo con una nueva herramienta.

**Fuerza bruta en una página de inicio de sesión**

Para este ejemplo usaremos Intruder de Burp para alterar la solicitud HTTP para la página de inicio de sesión dentro de **DVWA** .

- Comience iniciando sesión en **DVWA** usando el nombre de usuario " *admin* " y la contraseña "*password*".
- Verifique que la seguridad de **DVWA** esté baja para este ataque. Unos niveles de seguridad más altos impedirán que este ataque funcione.
- Navega a la sección *Fuerza Bruta* de la navegación lateral. Aquí verá cuadros de entrada para nombre de usuario y contraseña.
- Al pasar las credenciales incorrectas aparecerá un error.

![WPSca18](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan18.png?raw=true)

Intento de nombre de usuario: admin y contraseña: 1234, lo que arrojó un error. Supongamos que conocemos el nombre de usuario del usuario que inició sesión en el sitio. Podemos usar Burp para interceptar solicitudes e intentar obtener una lista de contraseñas en esta página de inicio de sesión.

Muestra que el nombre de usuario y la contraseña se pasan en la URL

- Haga clic derecho en la sección sin formato y *Enviar a Intruso*
- Desde la pestaña *Intruso → Posiciones* podemos seleccionar los parámetros que queremos modificar en nuestra solicitud. Desde el principio se seleccionan todas las entradas posibles. Presione el botón borrar a la derecha para borrar las selecciones.
- Resalte el valor de la contraseña. En mi caso, la contraseña inicial ingresada fue "1234". Seleccione ese valor y presione el botón Agregar a la derecha.

![WPSca19](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan19.png?raw=true)

Se podrían realizar más selecciones para modificar más valores en cada solicitud.

- La última parte de este ataque es agregar una carga útil para modificar el valor de la contraseña que seleccionamos.
- Vaya a la pestaña *Cargas útiles* . El conjunto de carga útil permanecerá como una lista simple y a continuación agregaremos valores a una lista para que Burp los use en su carga útil.
- La siguiente imagen muestra las contraseñas adivinadas agregadas a la carga útil para que Burp las pruebe. La lista de contraseñas comunes se puede descargar en línea para utilizarla en intentos de fuerza bruta más extensos.
- Haga clic en *Iniciar ataque* para iniciar el ataque.

![WPSca20](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan20.png?raw=true)

- Debería aparecer una nueva ventana mostrando los resultados de Intruder.

![WPSca21](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan21.png?raw=true)

- ¿Cómo sabemos si funcionó? Observar la longitud nos dice que cuando la carga útil es "password", obtenemos un resultado diferente al de los otros envíos. Eso significa que deberíamos examinar más de cerca ese valor.
- Al hacer clic en la fila, aparecerán acciones adicionales en la parte inferior de la ventana.
- Pasar a la pestaña *Renderizar* nos mostrará el resultado cuando se ingrese esa carga útil específica.

![WPSca22](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan22.png?raw=true)

- Como puede ver, la contraseña funcionó y se nos muestra una página de inicio de sesión válida. Esto se puede verificar yendo a **DVWA** y probando administrador y contraseña como valores de inicio de sesión. El mismo resultado debería aparecer.

![WPSca24](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan24.png?raw=true)

¡Felicidades! Ya ha completado su primer ataque utilizando Burp para modificar las solicitudes HTTP. Este es un ejemplo sencillo de cómo se puede utilizar Burp para realizar pruebas de seguridad de aplicaciones. Existen muchos más ataques a aplicaciones web. Burp Suite proporciona herramientas adicionales para solucionar ataques, ya sea de forma manual o automatizada. Profundizar en Burp Suite revelará cuán poderoso puede ser realmente.

### **¿Qué sigue?**

- Consulte tutoriales de ataques adicionales en el sitio web de Burp Suite para familiarizarse con el papel de Burp en ataques más intensivos.
- Utilice Burp para realizar ataques web comunes a otra aplicación web vulnerable, como [Mutillidae](https://www.owasp.org/index.php/OWASP_Mutillidae_2_Project) o el [proyecto OWASP WebGoat](https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project) .
- Continúe usando Burp en su próximo flujo de trabajo de prueba de aplicaciones web y juegue con una extensión de terceros para Burp para agregar más funciones.
- Actualice a la versión Pro para comprobar las capacidades de escaneo de vulnerabilidades de Burp Suite. Si el precio de Pro parece demasiado elevado, entonces OWASP Zap es una alternativa gratuita a Burp que permite escanear vulnerabilidades.

### Recursos adicionales

- [La metodología Burp](https://support.portswigger.net/customer/portal/articles/2326039-the-burp-methodology-) : tutoriales proporcionados por Burp Suite
- [Burp Suite para la seguridad de aplicaciones web](https://vimeo.com/album/3510171) : tutoriales en vídeo de Bucky Roberts

## **Nuclei: Automatización de pruebas de servicios de red y aplicaciones web**

Nuclei es un marco de código abierto diseñado para automatizar la detección y explotación de vulnerabilidades en aplicaciones web y otros servicios de red. Permite a los pentester e investigadores de seguridad definir plantillas personalizadas que especifican un conjunto de solicitudes HTTP para enviar a un objetivo, junto con las reglas de coincidencia correspondientes que pueden usarse para identificar vulnerabilidades o configuraciones incorrectas.

### **Instalación**

Para instalar Nuclei, puedes descargar la última versión desde el repositorio oficial de [GitHub](https://github.com/projectdiscovery/nuclei) y seguir las instrucciones.

### **Hoja de trucos**

Aquí hay una hoja de trucos completa con algunos comandos de Nuclei comúnmente utilizados para la búsqueda de recompensas por errores:

> 1. Mostrar información de ayuda
>  
> nuclei -h
> 
> 2. Mostrar la versión actual de Nuclei
> 
> nuclei -version
> 
> 3. Cargar una lista de objetivos desde un archivo
> 
> nuclei -l target.txt -t ~ /nuclei-templates/
> 
> 4. Especificar un único objetivo para probar
> 
> nuclei -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 5. Especifique una URL para probar
> 
> los núcleos -u https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 6. Ejecute núcleos en modo silencioso (suprima la salida)
> 
> núcleos -silent -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 7. Especifica el número de subprocesos simultáneos para usar
> 
> núcleos -c 10 -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 8. Omitir plantillas que requieren
> 
> núcleos de autenticación - no -verify -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 9. Personaliza el formato de salida del informe de
> 
> núcleos nuclei -o output.txt -t https: // ejemplo. com -t ~ /nuclei-templates/
> 
> 10. Ignorar errores de certificado SSL
> 
> nuclei -insecure -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 11. Especificar un encabezado HTTP personalizado para incluir en las solicitudes
> 
> nuclei -headers "Autorización: Bearer TOKEN" -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 12. Especifique una cadena de agente de usuario personalizada para incluir en las solicitudes
> 
> nuclei -user-agent "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, como Gecko) Chrome/58.0.3029.110 Safari/537.3" -t https: // ejemplo.com -t ~ /nuclei-templates/
> 

<aside>
👉 Estos comandos deberían ayudarlo a comenzar a ejecutar Nuclei y personalizar sus pruebas de acuerdo con sus necesidades específicas. Es importante tener en cuenta que Nuclei admite muchos más comandos y opciones además de estos, así que asegúrese de consultar la documentación oficial para obtener más información.
</aside>

### **Plantillas**

Para crear una plantilla para Nuclei, siga estos pasos:

1. Elija un objetivo para probar, como una aplicación web o un servicio de red.
2. Identifique una vulnerabilidad o configuración incorrecta que desee probar.
3. Utilice el lenguaje de plantilla de Nuclei para definir la prueba. El lenguaje de plantilla se basa en la sintaxis YAML y admite una amplia gama de funciones, como solicitudes HTTP, coincidencia de respuestas y variables. Consulte la documentación de Nuclei para obtener más información sobre el lenguaje de la plantilla y sus características.
4. Guarde la plantilla en un archivo con una extensión .yaml. Se recomienda guardar las plantillas en una carpeta dentro del directorio de plantillas de Nuclei para facilitar su administración y organización.
5. Pruebe la plantilla ejecutando Nuclei con la bandera -t y especificando la ruta al archivo de plantilla. Por ejemplo:

> núcleos -t https://example.com -t ~/nuclei-templates/my-template.yaml

Analice el resultado para determinar si la prueba fue exitosa y si se identificó alguna vulnerabilidad o configuración incorrecta. Realice cambios en la plantilla según sea necesario y repita el proceso de prueba hasta lograr los resultados deseados.

- *Recuerde probar sus plantillas de manera cuidadosa y responsable, y siempre obtenga el permiso del objetivo antes de realizar cualquier pentest.*

### **Script de inyección SQL de plantilla de núcleos personalizados con explicaciones :**

> id: example-template # A unique identifier for the template

> info:  # Information about the template

> name: Example Template

> author: Your Name

> severity: low

> requests:  # List of HTTP requests to send

> method: GET  # HTTP method (GET, POST, etc.)

> path: /  # Request path

> headers:  # Optional request headers

> User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)

> matchers:  # List of matchers to apply to the response

> type: word  # Matcher type (word, status, regex, etc.)

> words: "Example"  # Keyword to search for in the response

> attacks:  # Optional list of attack payloads to send

> - payload: "' OR true--"

### **Explicación:**

- id: un identificador único para la plantilla que se puede utilizar para hacer referencia a ella en argumentos de línea de comandos y otras plantillas.
- info: metadatos sobre la plantilla, como el nombre, el autor y la gravedad de las vulnerabilidades o configuraciones incorrectas que prueba.
- requests: una lista de solicitudes HTTP para enviar al destino. Esta sección define el método HTTP, la ruta, los encabezados y otros atributos de las solicitudes. Las solicitudes se pueden personalizar aún más con variables, credenciales de autenticación y otras características.
- matchers: Una lista de comparadores para aplicar a la respuesta de las solicitudes. Los comparadores definen cómo buscar patrones o palabras clave específicos en el cuerpo o los encabezados de la respuesta. Nuclei admite varios tipos de comparadores, como palabras, expresiones regulares, estados y binarios.
- attacks: una lista opcional de cargas útiles de ataque para enviar las solicitudes. Estas cargas útiles se pueden utilizar para probar vulnerabilidades como inyección SQL, XSS e inyección de comandos. Nuclei admite varios tipos de cargas útiles, incluidas las basadas en archivos, las basadas en parámetros y las basadas en JSON.

### **Conclusión**

Nuclei es una poderosa herramienta de código abierto que automatiza el escaneo de vulnerabilidades de servicios de red y aplicaciones web. Su enfoque flexible y personalizable permite a los usuarios crear y utilizar plantillas para identificar vulnerabilidades y configuraciones erróneas. Al utilizar Nuclei con otras herramientas, los cazarrecompensas de errores pueden optimizar sus flujos de trabajo de prueba y mejorar la seguridad. El desarrollo de Nuclei y el apoyo de la comunidad lo convierten en una herramienta valiosa para las pruebas de seguridad.