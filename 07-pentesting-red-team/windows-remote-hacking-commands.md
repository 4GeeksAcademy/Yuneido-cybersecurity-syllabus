---
title: "Windows CMD Commands for Remote Hacking"
subtitle: "Mastering Windows Command Line for Remote System Control"
tags: ["pentesting", "cybersecurity", "red-team"]
authors: ["blindma1den", "lorenagubaira"]

---

## Windows remote CMD commands for hacking

Many new hackers come from Windows, but rarely (if ever) use its built-in command line tools. As a hacker, you will often be forced to control the target system using only Windows commands and no GUI.

While we would love to have Metasploit's Meterpreter on the target and use all of its capabilities on the system, that is only sometimes possible. Some exploits will only allow us to get a CMD shell on the target Windows system.

In these cases, you will need to understand how to control the system strictly through the command prompt, without ever having the comfort and familiarity of the Windows GUI.

I want to demonstrate some Windows commands on a Windows system. I will run the Windows commands from a remote Kali system on the target.

### Step 1: Connect to a remote Windows system from Kali

Windows makes a distinction between commands that can be physically executed on the system and those that can be executed remotely. We cannot assume that a command that we can run while on the system will run remotely.

Here we are only interested in those that can be executed remotely. In my case, I will connect to the target system with a Netcat connection, but a command shell generated by Metasploit or others will work just as well.

### Step 2: Basic commands

In many ways, Windows CMD commands are similar to Linux/Unix commands (Unix preceded these commands by over a decade, and Microsoft borrowed heavily from it). In its most basic form, we need to change directories within the file system. Like Linux, Windows uses the **cd** (change directory) command. To travel to the root of the directory system, we can simply type:

```bash
cd \
```

In addition, we can go up one level in the directory structure by typing:

```bash
cd ..
```

![Buffer 21](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer21.png?raw=true)

If we want to see the contents of a directory, we type **dir** as seen above. Some other key and basic commands include:

```bash
from <filename>
```

This will delete the file, similar to Linux **rm**.

```bash
type <filename>
```

This will display the contents of the file, similar to Linux **cat**.

As you can see below, I used the font to display the contents of the confidential.txt file. I then **delete** the confidential.txt file, and when I display its contents again, I get the message "The system cannot find the specified file."

![Buffer 22](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer22.png?raw=true)

To create a new directory, we use the **md** (create directory) command (in Linux, it is mkdir). To create a directory named "newdirectory", we type:

```bash
md new directory
```

![Buffer 23](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer23.png?raw=true)

After creating a new directory, we can now run **dir** and see the new directory we created.

### Step 3: Network commands

When we are on the remote system, we may need network information. For this, we have two basic commands, **ipconfig** and **netstat**. ipconfig is very similar to Linux's **ifconfig**, as seen below.

![Buffer 24](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer24.png?raw=true)

To see the system network connections, we can type **netstat**, just like in Linux.

**netstat**

![Buffer 25](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer25.png?raw=true)

### Step 4: Viewing processes

Often, when we are on a remote system, we will need to see a list of the running processes. From the GUI, of course, we can use the Task Manager (Ctrl + Alt + Del), but from the remote command prompt we use the **task list**.

**task list**

![Buffer 26](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer26.png?raw=true)

If we want to find a single process, we could use the **findtr** (search string) filter. This works similarly to **grep** in Linux. So, to find the process named "explorer", we could type:

**Task list | Explorer findtr**

![Buffer 27](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer27.png?raw=true)

Note that we use the pipeline (|), just like in Linux, to send the results of the **tasklist** command to the filtering command, **findstr**.

If I want to terminate a process, I can use the taskkill command. It requires the PID (process ID) of the process we want to kill. In this case, the explorer process has a PID of 1532, so to terminate it, I can type:

**tareakill /PID 1532 /F**

![Buffer 28](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer28.png?raw=true)

Where **/F** stands for "force kill".

### Step 5: Search the user accounts

If we want to see the users on the target system, we can type:

`network users`

![Buffer 29](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer29.png?raw=true)

As you can see, this system has three users: guest, administrator, and victim, with the appropriate name.

### Step 6: Run a browser on the target

While operating the system from the command prompt, we can run some applications, such as the web browser. Internet Explorer is called **iexplore** (may not be available in newer Windows versions) in the command prompt, and we can find it in "Program Files" with the 64-bit version or in "Program Files (x86)" with the 32-bit version. So, if I want to open Internet Explorer on the remote system from the command prompt and open **Wonderhowto.com**, I would type:

Iexplore [www.google.com](http://www.google.com/).

When we do this, it opens Internet Explorer on the target system and goes to **google.com**. This could be useful if you had a malicious XSS link set up or wanted to use **Metasploit's web delivery module** and needed the target to go to a web server.

Also, we might want the target system to go to our web server in Kali. We could start the Apache web server and then direct the target system to our web server, where we may have some malware.

We can type:

```bash
Iexplore <direcciÃ³n IP>
```

As you can see below, we have directed the target system to our web server in Kali.

![Buffer 29](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/buffer29.png?raw=true)
