---
title: "Effective Privilege Escalation during Pentesting"
subtitle: "Techniques for Scanning and Exploiting Security Vulnerabilities to Gain Elevated Access"
tags: ["pentesting","cybersecurity"]
keywords: ["escalada de privilegios 0 - 40"]
authors: ["blindma1den", "lorenagubaira"]

---

## Privilege escalation vulnerability scanning

Searching for privilege escalation vulnerabilities is crucial for assessing the security of a system and preventing potential threats. Here are some common steps and techniques used to identify vulnerabilities that could allow an attacker to escalate privileges:

- **Information Gathering:** Obtain detailed information about the system, including operating system version, running services, and security settings.
- **User and Group Enumeration:** Using commands and tools such as whoami, id, or net user to enumerate users and groups on the system.
- **Review of Security Policies:** Examine system security policies to understand access restrictions and configurations.
- **Configuration Analysis:** Review security configurations, such as file permissions, service configurations, and access control policies.
- **Search for Known Vulnerabilities:** Use vulnerability databases, vulnerability scanners, and tools such as Nessus or OpenVAS to identify known vulnerabilities.
- **Privilege Escalation Active Testing:** Perform active testing, such as exploit attempts, to identify vulnerabilities that could lead to privilege escalation.

## Common Techniques

- **User Privilege Escalation:** Search for vulnerabilities that allow a regular user to elevate their privileges to higher levels.
- **Service and Application Exploitation:** Search for vulnerabilities in services and applications that could allow code execution with elevated privileges.
- **Weak Configuration Attacks:** Identify weak security configurations or bad practices that could be exploited for privilege escalation.
- **System-Level Privilege Escalation:** Search for vulnerabilities that allow a user to gain administrator or system privileges.
- **Server Exploitation:** Investigate specific server vulnerabilities that can be exploited for privilege escalation.

## Common Tools

- **Windows-Exploit-Suggester:** Tool to identify possible exploits on Windows systems.
    - **Usage:** Exploit search for specific versions of Windows.
- **Linux Exploit Suggester:** Tool to identify possible exploits in Linux systems.
    - **Usage:** Exploit search for specific versions of Linux systems.
- **PowerUp:** PowerShell script to list information and search for vulnerabilities in Windows systems.
    - **Use:** Identification of possible privilege escalation vectors.
- **BeRoot:** Tool to verify configurations and search for vulnerabilities in Linux systems.
    - **Use:** Search for weaknesses that could lead to privilege escalation.
   
> üëâ It is crucial to carry out these activities ethically and responsibly, always obtaining the consent of the system owner and respecting applicable laws and regulations. Transparent communication of findings is critical to facilitate mitigation and improve the security of the assessed system.

## Use of basic privilege escalation techniques

The use of basic privilege escalation techniques is a critical component of penetration testing. Here are some common techniques that security professionals can use to identify and exploit vulnerabilities that lead to privilege escalation:

1. Vulnerable Service Exploitation: Identify running services with known vulnerabilities and use specific exploits to elevate privileges.
2. Exploiting Weak Configurations: Identify incorrect or weak configurations that allow privilege escalation, such as inappropriate permissions on files or directories.
3. Command Injection: Exploiting vulnerabilities that allow command injection to execute arbitrary code with elevated privileges.
4. Exploitation of Zero-Day Vulnerabilities: Using exploits of zero-day vulnerabilities that have not yet been patched by the manufacturer.
5. Brute Force Attacks: Performing brute force attacks to gain unauthorized access to user accounts with higher privileges.
6. Use of Exploitation Tools: Use specialized tools such as Metasploit, PowerShell Empire, or Covenant to automate vulnerability exploitation and privilege escalation.
7. Exploiting Servers with Elevated Permissions: Identify services running with elevated privileges and look for vulnerabilities that allow manipulation of those services.
8. Access Token Manipulation: Modifying access tokens to obtain additional privileges in the system.
9. Use of Operating System Specific Privilege Escalation Exploits: Use specific exploits for privilege escalation on particular operating systems, such as Windows or Linux.
10. Exploiting Web Application Vulnerabilities: Identify vulnerabilities in web applications that allow privilege escalation at the system level.

## Important Considerations

- Owner Consent: Obtain explicit consent from the system owner before performing penetration testing.
- Detailed Documentation: Document every action taken, including findings, exploits used, and results obtained.
- Ethical and Legal Tracking: Perform all activities within ethical and legal boundaries, avoiding any unauthorized damage.
- Transparent Communication: Communicate transparently with the customer or system owner about actions taken and results obtained.

> üí° It is essential to carry out these activities ethically and responsibly, always ensuring the consent of the system owner and respecting applicable laws and regulations. Privilege escalation should be performed with the goal of improving system security, identifying weaknesses, and facilitating mitigation.

## Gaining privileged access to the target system

Privilege escalation is the act of exploiting a bug, design flaw, or configuration oversight in an operating system or software application to gain elevated access to resources that are normally protected from an application or user. We are going to use a vulnerable Linux distro to give an example of elevation of privilege, it is Metasploitable II. Our attacking machine will be a Kali Linux. The process that is going to be carried out in a summarized way is the following one:

1. We look for the services that are running on the Metasploitable machine.
2. We check if it has vulnerabilities.
3. We exploit the vulnerability that we choose.
4. We are inside with limited privileges, so we look for processes running as root and not belonging to the kernel.
5. We look for an exploit that allows us to elevate and run it.

### The machines and their IPs are as follows

- Kali Linux > `192.168.1.50`
- Metasploitable II > `192.168.1.49`

Searching for services on the victim machine. For this task, we will use Nmap, the command to run:

```bash
nmap -p 1-65535 -T4 -sV 192.168.1.49
```

As we are going to use Metasploit, we can make use of Nmap in the tool itself (db_nmap), the result will be the same, but the results will be saved in the database, so as to not get lost before we delete the database with ‚Äúclear database‚Äù. The output (not complete) is shown in the following screenshot:

![capture](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/captura.png?raw=true)

Now we can query the services as many times as we want with the Metasploit services command.

## We look for possible exploits

Let's focus on port 21, the FTP service, and look for a possible exploit:

![exploits](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/exploits.png?raw=true)

We find an exploit available for the version running on the victim machine. We configure the exploit and launch it:

![exploit available](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/exploit-disponible.png?raw=true)

We are already inside the victim machine, and above with the root user, what more can we ask for? In the next post, we will see that it is not always so easy to get high privileges, and we will have to work a little more to get there.
