## Instalar las dependencias requeridas

Antes de comenzar, deberá instalar algunas dependencias en su servidor. Puede instalarlos todos ejecutando el siguiente comando:

> apt install build-essential libpcap-dev libpcre3-dev libnet1-dev zlib1g-dev luajit hwloc libdnet-dev libdumbnet-dev bison flex liblzma-dev openssl libssl-dev pkg-config libhwloc-dev cmake cpputest libsqlite3-dev uuid-dev libcmocka-dev libnetfilter-queue-dev libmnl-dev autotools-dev libluajit-5.1-dev libunwind-dev libfl-dev -y


Una vez que todas las dependencias estén instaladas, se puede continuar con el siguiente paso.

### Instalar Snort DAQ

A continuación, deberá instalar la biblioteca de adquisición de datos en su sistema. De forma predeterminada, no está disponible en el repositorio predeterminado de Ubuntu. Por lo tanto, deberá compilarlo desde la fuente.

Primero, descargue Snort DAQ de Git con el siguiente comando:

> git clone https://github.com/snort3/libdaq.git

Una vez que se complete la descarga, navegue hasta el directorio descargado y configúrelo con el siguiente comando:

> cd libdaq

> ./bootstrap

> ./configure

Debería ver el siguiente resultado:

> cc:         gcc
> 
> 
> cppflags:
> 
> am_cppflags: -fvisibility=hidden -Wall -Wmissing-declarations -Wpointer-arith -Wcast-align -Wcast-qual -Wformat -Wformat-nonliteral -Wformat-security -Wundef -Wwrite-strings -Wextra -Wsign-compare -Wno-unused-parameter -fno-strict-aliasing -fdiagnostics-show-option
> 
> cflags:     -g -O2
> 
> am_cflags:   -Wstrict-prototypes -Wmissing-prototypes -Wold-style-definition -Wnested-externs
> 
> ldflags:
> 
> am_ldflags:
> 
> libs:
> 
> code_coverage_enabled:  no
> 
> code_coverage_cppflags:
> 
> code_coverage_cflags:
> 
> code_coverage_ldflags:
> 
> Build AFPacket DAQ module.. : yes
> 
> Build BPF DAQ module....... : yes
> 
> Build Divert DAQ module.... : no
> 
> Build Dump DAQ module...... : yes
> 
> Build FST DAQ module....... : yes
> 
> Build netmap DAQ module.... : no
> 
> Build NFQ DAQ module....... : yes
> 
> Build PCAP DAQ module...... : yes
> 
> Build Savefile DAQ module.. : yes
> 
> Build Trace DAQ module..... : yes
> 
> Build GWLB DAQ module...... : yes
> 

A continuación, instálelo con el siguiente comando:

> Make
> make install

## Instalar Gperftools

- Coloca el contenido de los datos del portapapeles dentro del evento para permitir la creación de reglas sobre el contenido del portapapeles.
- Integrar eventos de ProcessTampering
    - Enriquecer el evento con una puntuación diferente entre la sección .text en el disco y en la memoria
- Se implementó la fijación de certificados en el cliente para mejorar la seguridad del canal de comunicación entre los puntos finales y el servidor de administración.
- Capacidades de filtrado de registros, lo que permite recopilar eventos contextuales. El filtrado de registros se logra mediante la creación de reglas de filtrado Gene (consulta [la documentación de Gene](https://github.com/0xrawsec/gene) ).
- Archivos de configuración en formato TOML para una mejor legibilidad
- Mejor protección del directorio de instalación.

### **Trabajo relacionado**

- EDR basado en Sysmon escrito en PowerShell:  [https://github.com/ion-storm/sysmon-edr](https://github.com/ion-storm/sysmon-edr)
- Comodo Open Source EDR con componentes de usuario y kernel:  [https://github.com/ComodoSecurity/openedr](https://github.com/ComodoSecurity/openedr)
- Sysmon X:  [https://github.com/marcosd4h/sysmonx](https://github.com/marcosd4h/sysmonx)
