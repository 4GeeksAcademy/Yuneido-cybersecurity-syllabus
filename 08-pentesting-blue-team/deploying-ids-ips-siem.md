---
title: "Deployment recommendations"
subtitle: "Comprehensive Guide to Deploying and Managing IDS, IPS, and SIEM Technologies in Control Systems"
tags: ["pentesting", "cybersecurity", "blue-team"]
authors: ["blindma1den", "lorenagubaira"]

---

The following points will detail different types of deployments using IDS/IPS and SIEM technologies. We will start from a base architecture that will evolve to a complete architecture that contains all the necessary elements to have an intrusion detection/prevention system as well as an event collection and management system.

## Base architecture of control systems

The selected base architecture is based on the proposal offered by the IEC 62443 standard. It defines different zones associated with the levels into which an industrial control system is divided. The base architecture presents a segmentation based on firewalls to separate the control and corporate zones, with two DMZs for the exchange of information between the two zones. The following proposed architectures present security architectures to secure communications and devices located in the control part of the network. The security of the corporate side has not been taken into account in this study, as it is outside the scope of this study.

![Architecture1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura1.us.png?raw=true)

## Security architectures for control systems

### Security architecture with IDS

The first architecture, presented in Figure, describes the placement of IDS-type devices to monitor traffic within the control network. For this purpose, all traffic passing through the routers/switches is brought to the IDS sensor through mirror ports (*mirror/SPAN*). A probe is also added to receive information from the firewall and thus control the traffic exchanged with the network corresponding to the enterprise zone. The IDS must have the appropriate rules to generate the appropriate alerts that will be displayed to the corresponding operator or security administrator through the console.

![Architecture2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura2.us.png?raw=true)

### Security architecture with IPS

The evolution of a security architecture with IDS involves blocking traffic. This requires the sensors to be in the middle of the traffic, instead of listening to the traffic through the mirror ports (*mirror/SPAN*), as shown in the Figure. The rule configuration must be appropriate so that the usual control traffic flow is not interrupted and only intrusions and security breaches are blocked. The situation of the IPS sensors is similar to that of the IDS sensors, and the operation will be the same, generating alerts that will be displayed on the IDS console.

![Architecture3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura3.us.png?raw=true)

### Security architecture with SIEM

The Figure represents the installation of a SIEM within the control systems. It should be noted that the SIEM is dedicated to collecting and managing log events, so the data sources will come from all devices. In this case, care must be taken with communications, since all devices must be able to send their event logs to the SIEM, and this may imply a traffic overload on the network. The best way to solve this overload is to have an exclusive network for sending these messages.

![Architecture4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura4.us.png?raw=true)

### Unified architecture with IDS, IPS, and SIEM

The final representation (see Figure) shows how the three technologies are put together in a control system network architecture. The IPS would be for the upper levels, controlling the traffic exchanged between the control part and the corporate or business part; the IDS would manage the traffic between the control network and the field ones, reporting possible anomalies in the traffic; and the SIEM would collect the information from the largest possible number of devices, including process devices and network elements, as well as the alert information from both the IDS and the IPS.

The red lines shown in the figures indicate the points where both IDS sensors and IPS sensors connect to collect traffic and constitute a network connection. The monitoring network is used as a link between the IDS/IPS sensors and the central management core, and for this reason, no access to the network is required from any other part of the architecture. The green marked lines ending the SIEM show where information is obtained from and not actual network connections. The information will be sent over existing connections by enabling the corresponding rules in the firewall (and if applicable in the IDS/IPS).

![Architecture5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura5.us.png?raw=true)

## Conclusions

Intrusion detection and prevention systems and event and incident processing and management systems provide a level of security to control systems, provided they are correctly configured and monitored. The configuration of a prevention system can involve many problems on a control system in production, so all the implications must be correctly assessed, and all possible tests must be carried out beforehand, including keeping the system only in detection mode until it is certain that critical traffic for the system will not be blocked and progressively fine-tuning the system so that it only detects or reports important events.

SIEMs provide system status information to security operators, but are only useful if the information collected is properly analyzed. Centralizing all events in a single piece of equipment has the advantage that all actions occurring will be controlled in the minimum time and will not be lost by having to review multiple applications. The inclusion of these tools in the architecture of control systems can be complex depending on the system to be controlled, but the benefits will compensate for all the effort invested in the deployment, gaining control over the network, and ensuring the correct operation of the system without intrusions.