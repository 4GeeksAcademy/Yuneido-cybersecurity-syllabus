

# PREWORK

## **Configuraci√≥n del entorno en Kali Linux**

Este es un tema ya abordado en este bootcamp, a modo de repaso dejare el material completo y agregamos y ampliamos m√°s algunos completos para un comprendimiento mucho m√°s profundo en la materia.

### C√≥mo crear un Laboratorio de Hacking

Tener un laboratorio de hacking es esencial para el aprendizaje pr√°ctico y el perfeccionamiento de habilidades. Este art√≠culo te guiar√° paso a paso en la creaci√≥n de tu laboratorio de hacking en 2024, proporcionando las herramientas y conocimientos necesarios para experimentar de manera segura y efectiva en un entorno controlado.

Aprender ciberseguridad requiere muchos ejercicios pr√°cticos. Para eso, es √∫til tener un entorno dedicado y protegido para practicar diferentes t√©cnicas de forma legal y segura.

Puedes lograr esto de dos maneras:

- La primera es tener tu propio laboratorio de hacking, creado con fines educativos y con un equipamiento realista, similar al que encontrar√≠as en una red normal.
- Y el segundo es a trav√©s de plataformas CTF (Capture The Flag), que son sitios web con desaf√≠os de ciberseguridad por resolver.

En esta gu√≠a, te mostrar√© c√≥mo construir un laboratorio para practicar hacking. Este entorno contar√° con servidores reales que podr√°s utilizar sin meterte en problemas.

Para eso vamos a preparar un entorno virtualizado con herramientas gratuitas que luego usaremos para implementar t√°cticas ofensivas y defensivas. Lo √∫nico que necesitas es una computadora port√°til o de escritorio.

<aside>
ü§ì El hacking √©tico es una habilidad que se aprende con el tiempo.
</aside>

Se requiere pr√°ctica y paciencia para alcanzar un nivel de habilidad decente en este campo. Tener a mano una configuraci√≥n de laboratorio puede ayudarte mucho en tu aprendizaje. Un laboratorio le permite practicar sus habilidades en un entorno controlado, lo que reduce los riesgos que surgen al practicar en sistemas reales. Tener tu laboratorio virtual te ayudar√° de muchas maneras:

- Puedes practicar en cualquier momento seg√∫n tu conveniencia.
- No tiene que exponer sus datos al peligro de que se borren debido a una infecci√≥n de malware.
- Tambi√©n se salva de problemas legales que pueden resultar de realizar pruebas en un sitio web real que no es de su propiedad.
- Tienes la libertad de experimentar y modificar (casi imposible con los laboratorios en l√≠nea).

Aprender hacking y convertirse en un hacker √©tico experto requiere una pr√°ctica inmensa. Para ello, necesita configurar un laboratorio donde pueda probar las cosas que aprende. Adem√°s, si practica en un sistema real, puede conllevar riesgos de seguridad.

### Objetivos

- Comprender c√≥mo funcionan las m√°quinas virtuales
- Aprenda a crear un entorno virtual b√°sico para fines de pentesting.

### Requisitos

Arranquemos con lo que tengamos, pero es vital al menos tener:

- Windows 10, 11, macOS o cualquier distribuci√≥n de Linux
- Al menos 16 GB de RAM, ya que vamos a virtualizar entornos, sino ir√° muy lento. Esto se debe a que la memoria se divide entre el host y la m√°quina virtual. (se recomiendan 32 GB para trabajar con multiples m√°quina virtuales)
- Oracle Virtualbox o VMWare para crear las m√°quinas virtuales dentro de su computadora f√≠sica.
- M√°quina atacante. Lo vamos a crear con Kali Linux para tener todas las herramientas ofensivas necesarias.
- M√°quinas v√≠ctimas que ser√°n servidores reales con vulnerabilidades que vamos a explotar. Usaremos VulnHub, que tiene un conjunto de m√°quinas vulnerables listas para descargar y usar.

## Planificaci√≥n de la configuraci√≥n de su laboratorio

Cuando comenc√© a montar mi laboratorio personal, me di cuenta de que un poco de pensamiento estrat√©gico ayuda mucho. Entonces, aqu√≠ est√° la primicia sobre c√≥mo abord√© la fase de planificaci√≥n:

**1. Definir tus metas y objetivos:** Lo primero es lo primero: me pregunt√©: ¬´¬øPor qu√© quiero este laboratorio?¬ª ¬øEs para dominar una t√©cnica de hacking concreta, explorar las vulnerabilidades de la red o tal vez para comprender c√≥mo funciona el malware? Tener objetivos claros en mente ayuda a dar forma al resto de tu configuraci√≥n. Por ejemplo, si le interesa m√°s la seguridad web, su laboratorio podr√≠a inclinarse hacia plataformas y herramientas de prueba de aplicaciones web.

**2. Identificar herramientas y tecnolog√≠as:** Seamos realistas, el mundo del hacking √©tico tiene m√°s herramientas que el taller de un personal de mantenimiento. Examin√© los distintos tipos de herramientas, desde esc√°neres de red hasta descifradores de contrase√±as, y eleg√≠ las que se alineaban con mis objetivos. Es como armar la caja de herramientas de tus sue√±os: ¬°solo con l√≠neas de c√≥digo y exploits virtuales!

**3. Elegir el hardware y el software adecuados:** Ahora, antes de dejarse llevar y empezar a pedir un mont√≥n de dispositivos llamativos, piense en lo que se adapta a su espacio y presupuesto. Para m√≠, el software de virtualizaci√≥n cambi√≥ las reglas del juego. Podr√≠a ejecutar varias m√°quinas virtuales (VM) en una sola m√°quina f√≠sica, creando diferentes entornos para realizar pruebas sin saturar mi habitaci√≥n con pilas de hardware.

<aside>
üëâ Entonces, este es el trato, amigos: t√≥mate un tiempo para intercambiar ideas, investigar y decidir cu√°l ser√° el enfoque principal de tu laboratorio. ¬øEst√°s sumergi√©ndote en la seguridad inal√°mbrica? ¬øQuiz√°s tienes curiosidad por la ingenier√≠a social? Una vez que hayas resuelto tu misi√≥n, ¬°podemos pasar al meollo de la cuesti√≥n de construir este patio de juegos digital! üéÆ
</aside>

## Sistemas a Usar

**Windows:** Depende el √°rea de seguridad en la que trabajen es lo que van a necesitar en hardware y software no es lo mismo ser un forense que un pentester. Como tengo que hacer reportes me sirve trabajar en Windows. Uso mucho ONENOTE para llevar todo el material que estoy estudiando y trabajando.

Adem√°s, la cantidad de herramientas de gesti√≥n de disco, archivos, documentos y gr√°ficos al nivel que necesito trabajarlas no est√°n disponibles en Linux. Lo m√°s probable es que te convenga iniciar virtualizando Kali, por lo que podr√°s mantener como nativo a Windows.

**Linux:** La mayor√≠a de herramientas est√°n disponibles en Linux y, de hecho, Kali ya soluciona eso. Tenemos una guia de como crear tu laboratorio y resolver los problemas m√°s comunes: [Crea tu Laboratorio de Pentest con Kali Linux, Metasploitable y Beebox](https://achirou.com/crea-tu-laboratorio-de-pentest-con-kali-linux-metasploitable-y-beebox/)

## Hardware

Arranquen con lo que tengan, al final todos empezamos con lo que tenemos. Si van a mejorar o comprar un equipo mi recomendaci√≥n PC es mejor que notebook por m√∫ltiples razones. Va a depender del √°rea en la que trabajen, si necesitan movilidad no les queda m√°s que ir por una notebook.

Fuera de la √∫nica ventaja que tiene la notebook que es la de ser portable un PC es superior en todo. Menor costo, mayor capacidad de expansi√≥n, f√°cil y econ√≥mico de reparar, y cuando comparas la ‚Äúmisma‚Äù versi√≥n entre PC y notebook la de pc tiende a ser MUY superior en rendimiento.

Otra gran ventaja son los monitores, mi recomendaci√≥n es de 2 o 3 es ideal. Yo en este momento estoy usando 4. Realmente usar varios monitores simplifica mucho el trabajo. En uno podr√°n trabajar con Kali y en el otro realizar un informe m√°s c√≥modamente. Nuevamente esto depende del √°rea en el que est√©n. En este momento estoy trabajando en un i5 (algo viejo de 10ma) con 64gb de RAM y no he tenido problemas virtualizando.

![Gestor de tareas](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/gestor-tareas.png?raw=true)

Por citar un ejemplo si usan un scanner como ZAP ver√°n que estos comen mucha RAM y si guardan la secci√≥n mucho disco. Me refiero a que pueden gastar 10gb/16GB de RAM y 70gb ‚Äì 150gb de disco tan solo con una sola aplicaci√≥n. Por eso las recomendaciones y buenas pr√°cticas a la hora de crear su m√°quina virtual con Linux.

![Propiedades zap](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/propiedades-zap.png?raw=true)

|  | M√≠nimo | Recomendado |
| --- | --- | --- |
| CPU | I3 / Ryzen3 o superior | I5 / Ryzen 5 o superior |
| Memoria | 16gb | 32gb+ |
| SO | W10/kali | W11/Kali everything |
| Disco | SSD 512 | SSD 1TB+ |
| Placa de Video | No vital | Puede ser √∫til si desean colocar 3 o m√°s monitores. Esto depender√° del motherboard y las entradas de sus monitores. |

## Instalaci√≥n de Metasploitable 2

Metasploitable es un sistema operativo que ha sido dise√±ado con el objetivo de ser vulnerado con sencillez y gracias a esto poder llevar a cabo cientos de pruebas de penetraci√≥n para mejorar la seguridad y prevenir ataques a corto, mediano o largo plazo.

### Qu√© es Metasploitable

Es un sistema de Linux que ha sido desarrollado con las m√°s altas vulnerabilidades de seguridad en el cual podemos llevar a cabo todas las pruebas necesarias para perfeccionar las t√©cnicas de seguridad o conocer c√≥mo sacar el m√°ximo provecho a aplicaciones dise√±adas para este fin.

Metasploitable no cuenta con entorno gr√°fico y se recomienda ser usado en redes privadas exclusivamente debido a su tolerancia a ataques. Es de c√≥digo abierto y permite realizar pruebas de vulnerabilidades en archivos incrustados, atributos de archivo, permisos, etc. A continuaci√≥n veremos c√≥mo instalar Metasploitable en VirtualBox para realizar las diversas pruebas seg√∫n sea la necesidad de cada uno.

### Requisitos previos

Para esto ser√° necesario contar con lo siguiente:

- [VIRTUALBOX](https://www.virtualbox.org/wiki/Downloads)
- [https://sourceforge.net/projects/metasploitable/files/Metasploitable2/](https://sourceforge.net/projects/metasploitable/files/Metasploitable2/)

Para iniciar el proceso podremos crear la m√°quina virtual en VirtualBox pulsando en el icono **Nueva** ubicado en el costado superior y en la ventana desplegada ingresaremos los siguientes valores:

![metasploitable1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/metasploitable1.png?raw=true)

Pulsamos en **Next** y en la siguiente ventana podremos dejar el valor de la memoria RAM por defecto, 2048MB, o bien asignar un poco m√°s si as√≠ lo deseamos.

![metasploitable2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/metasploitable2.png?raw=true)

Pulsamos en **Next** y en la siguiente ventana seleccionamos la opci√≥n **Crear un disco duro virtual ahora:**

![metasploitable3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/metasploitable3.png?raw=true)

Pulsamos en **Next** y en Terminar.

![metasploitable4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/metasploitable4.png?raw=true)

Ahora pulsaremos en el bot√≥n **Iniciar** para comenzar el proceso de instalaci√≥n del sistema.

![metasploitable5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/metasploitable5.png?raw=true)

Este proceso tarda alrededor de 5 minutos y veremos lo siguiente:

![metasploitable6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/metasploitable6.png?raw=true)

Las credenciales de acceso son:

- **Usuario: msfadmin**
- **Contrase√±a: msfadmin**

![metasploitable7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/metasploitable7.png?raw=true)

De esta forma podremos usar Metasploitable con todas las pruebas necesarias.

## Bee-Box

Si deseamos instalar en una m√°quina virtual el proyecto es [Bee-Box](https://sourceforge.net/projects/bwapp/files/bee-box/bee-box_v1.6.7z/download). **Bee-box es una m√°quina virtual Linux con todo preinstalado**. As√≠ solo deberemos explorar todas las vulnerabilidades bWAPP sin correr el riesgo de desfigurar el sitio web bWAPP. Adem√°s con la m√°quina virtual podremos intentar conseguir acceso root.

I**nstalaremos la versi√≥n Bee-Box de bWAPP**, para ello descomprimimos el archivo que descargamos y los creara una carpeta con muchos archivos vmdk a nuestro servidor local. A continuaci√≥n crearemos la m√°quina virtual asignando una versi√≥n Linux Ubuntu de 32 bit.

![Bee-Box1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/beebox1.png?raw=true)

![Bee-Box2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/beebox2.png?raw=true)

A continuaci√≥n deberemos seleccionar el archivo descargado denominado **bee-box.vdmk**

![Bee-Box3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/beebox3.png?raw=true)

![Bee-Box4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/beebox4.png?raw=true)

Antes de iniciar la m√°quina virtual, recordemos que deberemos configurar la red esto la hacemos desde **Configuraci√≥n** para poder tener una direcci√≥n IP y poder acceder a la m√°quina virtual desde otro ordenador.

![Bee-Box5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/beebox5.png?raw=true)

Hacemos clic en crear y luego en Iniciar, para que la m√°quina virtual comience a funcionar, una vez cargada veremos el escritorio.

![Bee-Box6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/beebox6.png?raw=true)

### Recomendaciones

**Excluye directorios en el antivirus**. La soluci√≥n de seguridad de tu equipo puede estar escaneando los archivos de la m√°quina virtual cada vez que se acceda a ellos, reduciendo el rendimiento. El antivirus no puede ver el interior de la m√°quina virtual para detectar virus que se ejecuten en sistema operativo invitado, por lo que esta exploraci√≥n es in√∫til. Para acelerar las cosas, a√±ade el directorio de la m√°quina virtual a la lista de exclusiones de tu antivirus.

**Suspender en lugar de apagar**. Cuando hayas terminado de utilizar la m√°quina virtual, es posible que desees guardar su estado en lugar de apagarla completamente. La pr√≥xima vez que la necesites, basta hacer un doble clic para ponerla en marcha. El sistema operativo hu√©sped se reanudar√° donde lo dej√≥ en lugar de arrancar desde cero. La funci√≥n es similar a la hibernaci√≥n o suspensi√≥n. La aplicaci√≥n guarda el contenido de la memoria de la m√°quina virtual en un archivo en el disco duro, para cargarla cuando lo requiera el usuario.

**Para m√°quinas virtuales, mejora tu hardware**. Todo lo dicho anteriormente es una ayuda para mejorar el rendimiento de nuestras m√°quinas virtuales pero, no hay milagros al utilizar este recurso tecnol√≥gico. Aqu√≠ s√≠ vale el dicho de cuanto m√°s mejor. Como habr√°s visto, para que funcionen adecuadamente tenemos que cederles recursos de nuestra m√°quina principal. Y no pocos. Si tu hardware no es lo suficientemente potente y las utilizas, puedes bloquear por completo tu equipo en cuanto ejecutes un sistema que requiera un cierto nivel de potencia, si bien el consumo de recursos de, por ejemplo, Windows 11 o DOS es totalmente diferente.

<aside>
üëâ Ya ten√©s listo tu laboratorio para pentest
</aside>

Al seguir esta gu√≠a, has construido un laboratorio de pentest s√≥lido que te brinda la oportunidad de enfrentarte a escenarios del mundo real de manera controlada. Contin√∫a explorando nuevas vulnerabilidades, t√©cnicas de explotaci√≥n y soluciones de seguridad. Tu viaje en el mundo del pentesting acaba de comenzar, ¬°sigamos avanzando hacia la maestr√≠a en ciberseguridad!

Con estos pasos hemos aprendido a instalar Kali Linux en VirtualBox y as√≠ tener a mano un sistema vital tanto para trabajar como para nuestro laboratorio.

## Preguntas frecuentes (FAQ)

**P1: ¬øQu√© es el hacking y por qu√© deber√≠a crear un laboratorio personal para ello?**

El hacking √©tico implica el uso de t√©cnicas de hacking para identificar vulnerabilidades en sistemas, redes y aplicaciones con el fin de mejorar su seguridad. Configurar un laboratorio personal le permite practicar y aprender hacking en un entorno controlado, adquiriendo experiencia pr√°ctica sin causar da√±os a los sistemas del mundo real.

**P2: ¬øQu√© hardware y software necesito para mi laboratorio de hacking?**

Para el hardware, se recomienda una computadora potente con soporte de virtualizaci√≥n. Tambi√©n necesitar√°s una conexi√≥n a Internet estable. En cuanto al software, necesitar√° software de virtualizaci√≥n como VirtualBox o VMware, im√°genes del sistema operativo (por ejemplo, Kali Linux), herramientas de prueba de penetraci√≥n (por ejemplo, Metasploit), esc√°neres de vulnerabilidades (por ejemplo, OpenVAS) y herramientas de monitoreo de red (por ejemplo, Wireshark). ).

**P3: ¬øC√≥mo puedo proteger la red de mi laboratorio para evitar el acceso no autorizado?**

Implemente contrase√±as seguras para sus m√°quinas virtuales, m√°quina host y equipos de red. Configure firewalls para controlar el tr√°fico entrante y saliente. Cree segmentos de red aislados para diferentes tipos de pruebas. Considere el uso de VPN para mayor seguridad y practique h√°bitos de navegaci√≥n seguros dentro del entorno de su laboratorio.

**P4: ¬øEs legal practicar hacking en un laboratorio personal?**

S√≠, practicar la hacking en su laboratorio personal es legal siempre que trabaje dentro de los l√≠mites de la ley y se centre en sistemas para los que tiene permiso expl√≠cito para probar. Cumpla siempre con las pautas de hacking y evite participar en actividades maliciosas.

**P5: ¬øC√≥mo me aseguro de que mis pr√°cticas de hacking sean √©ticas y responsables?**

Adhi√©rase al c√≥digo de conducta de hacking √©tico, que incluye obtener permiso antes de probar cualquier sistema, informar las vulnerabilidades de manera responsable a las partes correspondientes y abstenerse de causar da√±os o interrupciones. Priorice siempre la seguridad y la privacidad de los sistemas que est√° probando.

**P6: ¬øPuedo utilizar mi experiencia de laboratorio personal para seguir una carrera en ciberseguridad?**

¬°Absolutamente! Las habilidades que desarrolle en su laboratorio personal pueden ser muy valiosas para seguir una carrera en ciberseguridad, hacking o pruebas de penetraci√≥n. Muchos profesionales comienzan con laboratorios personales para adquirir experiencia pr√°ctica antes de pasar a escenarios m√°s complejos del mundo real.

**P7: ¬øD√≥nde puedo encontrar recursos adicionales para seguir aprendiendo sobre hacking √©tico?**

Hay muchos recursos, foros y comunidades en l√≠nea dedicados al hacking √©tico y la ciberseguridad. Sitios web como Hack The Box, foros como r/NetSec de Reddit y cursos en l√≠nea de plataformas como Udemy y Coursera ofrecen una gran cantidad de informaci√≥n para ayudarlo a ampliar sus conocimientos.

**P8: ¬øPuedo especializarme en un √°rea espec√≠fica de hacking, como seguridad de aplicaciones web o pruebas de penetraci√≥n de redes?**

¬°Absolutamente! El hacking √©tico es un campo amplio con varios nichos. Puede especializarse en √°reas como seguridad de aplicaciones web, pruebas de penetraci√≥n de redes, seguridad inal√°mbrica, ingenier√≠a social y m√°s. Su laboratorio personal puede servir como campo de capacitaci√≥n para desarrollar experiencia en el nicho elegido.

OWASP Top 10

# C√≥mo utilizar el OWASP Top 10 para pruebas de penetraci√≥n de aplicaciones web

A medida que las aplicaciones web muestran una adopci√≥n cada vez mayor, las pruebas de penetraci√≥n de OWASP siguen siendo esenciales para proteger y asegurar sus recursos digitales. Esta gu√≠a detallada sirve como una br√∫jula pr√°ctica que lo ayuda a navegar por el denso panorama de pruebas de penetraci√≥n de aplicaciones web respaldado por el respetado marco de pruebas OWASP.

A lo largo de esta gu√≠a completa, exploraremos los pilares de las pruebas de penetraci√≥n de OWASP. Revelaremos los conceptos que dan forma a este campo, analizaremos t√©cnicas pr√°cticas y le presentaremos las herramientas utilizadas por los expertos de la industria. Nuestro objetivo es brindarle una visi√≥n amplia de esta disciplina din√°mica, estableciendo una conexi√≥n clara con el renombrado Top Ten de OWASP.

## ¬øQu√© es OWASP?

Significa Proyecto Abierto de Seguridad de Aplicaciones Web, una piedra angular vital del panorama de la seguridad cibern√©tica. Esta organizaci√≥n internacional sin fines de lucro se dedica a mejorar la seguridad del software. Si est√° ejecutando Kali Linux, **ya sea como m√°quina virtual** o como **sistema operativo principal** , es probable que ya haya encontrado algunas herramientas OWASP como Zed Attack Proxy (ZAP), que viene preinstalado. Son recursos invaluables tanto para los reci√©n llegados como para los profesionales experimentados en el campo del hacking y ciberseguridad.

La misi√≥n de OWASP se extiende m√°s all√° del desarrollo de herramientas. Est√°n comprometidos a promover pr√°cticas de codificaci√≥n segura, proporcionar recursos sobre los riesgos de seguridad predominantes y fomentar una comunidad centrada en la seguridad de las aplicaciones web. Entre las muchas aportaciones de OWASP destaca el **[OWASP Top 10 .](https://owasp.org/Top10/)** Es una lista actualizada peri√≥dicamente de los riesgos de seguridad m√°s cr√≠ticos para las aplicaciones web, que sirve como una gu√≠a de lectura obligada para cualquier persona encargada de proteger o mantener aplicaciones web.

En las pr√≥ximas secciones, profundizaremos en el papel de OWASP en las pruebas de penetraci√≥n. Analizaremos el OWASP Top 10, sus casos de uso, limitaciones y c√≥mo se puede aprovechar de manera efectiva en su trabajo de seguridad cibern√©tica.

Recuerde, OWASP es m√°s que un recurso para identificar vulnerabilidades. Es su socio para comprenderlos y mitigarlos, ofreci√©ndole gu√≠as pr√°cticas y recursos para reforzar su seguridad.

## Top 10 de OWASP

El OWASP Top 10 es m√°s que una simple lista: es una hoja de ruta para comprender y mitigar los riesgos de seguridad m√°s cr√≠ticos de las aplicaciones web. Actualizado cada pocos a√±os en funci√≥n de datos de varias organizaciones de seguridad, el Top 10 ayuda a los profesionales de seguridad cibern√©tica nuevos y experimentados a priorizar sus estrategias defensivas. La versi√≥n actual del OWASP Top 10 incluye los siguientes riesgos (a partir de la actualizaci√≥n de 2021):

### Qu√© ha cambiado en el Top 10 de 2021

Hay tres nuevas categor√≠as, cuatro categor√≠as con cambios de nombre y alcance, y alguna consolidaci√≥n en el Top 10 de 2021. Hemos cambiado los nombres cuando ha sido necesario para centrarnos en la causa principal en lugar del s√≠ntoma.

![owasp1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/owasp1.png?raw=true)

## [A01:2021 - P√©rdida de Control de Acceso](https://owasp.org/Top10/es/A01_2021-Broken_Access_Control/)

Sube de la quinta posici√≥n a la categor√≠a con el mayor riesgo en seguridad de aplicaciones web; los datos proporcionados indican que, en promedio, el 3,81% de las aplicaciones probadas ten√≠an una o m√°s Common Weakness Enumerations (CWEs) con m√°s de 318.000 ocurrencias de CWEs en esta categor√≠a de riesgo. Las 34 CWEs relacionadas con la P√©rdida de Control de Acceso tuvieron m√°s apariciones en las aplicaciones que cualquier otra categor√≠a.

## [A02:2021 - Fallas Criptogr√°ficas](https://owasp.org/Top10/es/A02_2021-Cryptographic_Failures/)

Sube una posici√≥n ubic√°ndose en la segunda, antes conocida como **A3:2017-Exposici√≥n de Datos Sensibles**, que era m√°s una caracter√≠stica que una causa ra√≠z. El nuevo nombre se centra en las fallas relacionadas con la criptograf√≠a, como se ha hecho impl√≠citamente antes. Esta categor√≠a frecuentemente conlleva a la exposici√≥n de datos confidenciales o al compromiso del sistema.

## [A03:2021 - Inyecci√≥n](https://owasp.org/Top10/es/A03_2021-Injection/)

Desciende hasta la tercera posici√≥n. El 94% de las aplicaciones fueron probadas con alg√∫n tipo de inyecci√≥n y estas mostraron una tasa de incidencia m√°xima del 19%, promedio de 3.37%, y las 33 CWEs relacionadas con esta categor√≠a tienen la segunda mayor cantidad de ocurrencias en aplicaciones con 274.000 ocurrencias. El Cross-Site Scripting, en esta edici√≥n, forma parte de esta categor√≠a de riesgo.

## [A04:2021 - Dise√±o Inseguro](https://owasp.org/Top10/es/A04_2021-Insecure_Design/)

Nueva categor√≠a para la edici√≥n 2021, con un enfoque en los riesgos relacionados con fallas de dise√±o. Necesitamos m√°s modelos de amenazas, patrones y principios con dise√±os seguros y arquitecturas de referencia. Un dise√±o inseguro no puede ser corregida con una implementaci√≥n perfecta debido a que, por definici√≥n, los controles de seguridad necesarios nunca se crearon para defenderse de ataques espec√≠ficos.

## [A05:2021 - Configuraci√≥n de Seguridad Incorrecta](https://owasp.org/Top10/es/A05_2021-Security_Misconfiguration/)

Asciende desde la sexta posici√≥n en la edici√≥n anterior; el 90% de las aplicaciones se probaron para detectar alg√∫n tipo de configuraci√≥n incorrecta, con una tasa de incidencia promedio del 4,5% y m√°s de 208.000 casos de CWEs relacionadas con esta categor√≠a de riesgo. Con mayor presencia de software altamente configurable, no es sorprendente ver qu√© esta categor√≠a ascendiera. El **A4:2017-Entidades Externas XML(XXE)**, ahora en esta edici√≥n, forma parte de esta categor√≠a de riesgo.

## [A06:2021 - Componentes Vulnerables y Desactualizados](https://owasp.org/Top10/es/A06_2021-Vulnerable_and_Outdated_Components/)

Antes denominado como Uso de Componentes con Vulnerabilidades Conocidas, ocupa el segundo lugar en el Top 10 de la encuesta a la comunidad, pero tambi√©n tuvo datos suficientes para estar en el Top 10 a trav√©s del an√°lisis de datos. Esta categor√≠a asciende desde la novena posici√≥n en la edici√≥n 2017 y es un problema conocido que cuesta probar y evaluar el riesgo. Es la √∫nica categor√≠a que no tiene ninguna CVE relacionada con las CWEs incluidas, por lo que una vulnerabilidad predeterminada y con ponderaciones de impacto de 5,0 son consideradas en sus puntajes.

## [A07:2021 - Fallas de Identificaci√≥n y Autenticaci√≥n](https://owasp.org/Top10/es/A07_2021-Identification_and_Authentication_Failures/)

Previamente denominada como P√©rdida de Autenticaci√≥n, descendi√≥ desde la segunda posici√≥n, y ahora incluye CWEs que est√°n m√°s relacionadas con fallas de identificaci√≥n. Esta categor√≠a sigue siendo una parte integral del Top 10, pero el incremento en la disponibilidad de frameworks estandarizados parece estar ayudando.

## [A08:2021 - Fallas en el Software y en la Integridad de los Datos](https://owasp.org/Top10/es/A08_2021-Software_and_Data_Integrity_Failures/)

Es una nueva categor√≠a para la edici√≥n 2021, que se centra en hacer suposiciones relacionadas con actualizaciones de software, los datos cr√≠ticos y los pipelines CI/CD sin verificaci√≥n de integridad. Corresponde a uno de los mayores impactos seg√∫n los sistemas de ponderaci√≥n de vulnerabilidades (CVE/CVSS, siglas en ingl√©s para Common Vulnerability and Exposures/Common Vulnerability Scoring System). La **A8:2017-Deserializaci√≥n Insegura** en esta edici√≥n forma parte de esta extensa categor√≠a de riesgo.

## [A09:2021 - Fallas en el Registro y Monitoreo](https://owasp.org/Top10/es/A09_2021-Security_Logging_and_Monitoring_Failures/)

Previamente denominada como **A10:2017-Registro y Monitoreo Insuficientes**, es adicionada desde el Top 10 de la encuesta a la comunidad (tercer lugar) y ascendiendo desde la d√©cima posici√≥n de la edici√≥n anterior. Esta categor√≠a se ampl√≠a para incluir m√°s tipos de fallas, es dif√≠cil de probar y no est√° bien representada en los datos de CVE/CVSS. Sin embargo, las fallas en esta categor√≠a pueden afectar directamente la visibilidad, las alertas de incidentes y los an√°lisis forenses.

## [A10:2021 - Falsificaci√≥n de Solicitudes del Lado del Servidor](https://owasp.org/Top10/es/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/)

Es adicionada desde el Top 10 de la encuesta a la comunidad (primer lugar). Los datos muestran una tasa de incidencia relativamente baja con una cobertura de pruebas por encima del promedio, junto con calificaciones por encima del promedio para la capacidad de explotaci√≥n e impacto. Esta categor√≠a representa el escenario en el que los miembros de la comunidad de seguridad nos dicen que esto es importante, aunque no est√° visualizado en los datos en este momento.

## Obt√©n informaci√≥n sobre las t√©cnicas de ataque

Cada uno de estos riesgos representa una debilidad com√∫n y significativa que a menudo puede explotarse para comprometer la seguridad de una aplicaci√≥n web. OWASP proporciona informaci√≥n detallada sobre posibles vulnerabilidades y t√©cnicas de ataque para cada riesgo. Como probador de pentester o cazarrecompensas de errores, puede aprovechar eficazmente el Top 10 de OWASP.

El OWASP Top 10 no se trata s√≥lo de conocer las vulnerabilidades, sino tambi√©n de comprenderlas y mitigarlas. √öselo para enriquecer sus conocimientos de seguridad y como lista de verificaci√≥n en su trabajo de seguridad. Aprovechando la utilidad del OWASP Top 10, es crucial entender que este recurso va m√°s all√° de simplemente enumerar los riesgos de seguridad prevalentes. Ofrece una visi√≥n m√°s profunda de las t√©cnicas de ataque asociadas a cada riesgo, lo que podr√≠a cambiar las reglas del juego en su trabajo de ciberseguridad.

A medida que navega por el OWASP Top 10, no solo se le presentar√°n las vulnerabilidades m√°s comunes, sino que tambi√©n se le brindar√° una ventana a las t√°cticas empleadas por actores maliciosos para explotar estas debilidades. Esta informaci√≥n puede ayudarle a pensar como un atacante, una habilidad invaluable cuando intenta encontrar y explotar vulnerabilidades potenciales durante las pruebas de penetraci√≥n o la b√∫squeda de errores.

Por ejemplo, si la 'inyecci√≥n' encabeza la lista, OWASP no solo le dir√° que las vulnerabilidades de inyecci√≥n son comunes; Tambi√©n proporcionar√° ejemplos de c√≥mo se suelen explotar estas debilidades. Esta informaci√≥n puede ayudarle a comprender c√≥mo dise√±ar sus ataques de inyecci√≥n de manera m√°s efectiva o c√≥mo probar estas vulnerabilidades de manera m√°s completa.

## Mant√©nte informado sobre las amenazas en evoluci√≥n

El panorama de la ciberseguridad no es est√°tico; est√° evolucionando continuamente a medida que avanza la tecnolog√≠a y se descubren nuevas vulnerabilidades. Las

actualizaciones peri√≥dicas del OWASP Top 10 reflejan estos cambios, lo que garantiza que se mantenga informado sobre el terreno cambiante de la seguridad de las aplicaciones web.

Al mantenerse al tanto de estas actualizaciones, siempre estar√° al tanto de las nuevas entradas, la prevalencia creciente o decreciente de ciertos riesgos y la aparici√≥n de nuevas t√©cnicas de ataque. Esta informaci√≥n es fundamental para mantener la relevancia y eficacia de sus estrategias de prueba y mitigaci√≥n.

Recuerde, mantenerse actualizado no se trata s√≥lo de estar informado; se trata de estar preparado. Cuanto m√°s sepa acerca de las amenazas actuales, mejor podr√° abordarlas de frente. El OWASP Top 10 no es s√≥lo una lista est√°tica de vulnerabilidades: es un documento vivo que refleja la naturaleza cambiante de los riesgos de seguridad de las aplicaciones web. Al mantenerse actualizado con la √∫ltima versi√≥n, se estar√° equipando con los conocimientos y estrategias m√°s relevantes para sobresalir en su trabajo de ciberseguridad.

Finalmente, al centrar sus pruebas en OWASP Top 10, mejora la seguridad de la aplicaci√≥n que est√° probando y contribuye a la misi√≥n m√°s amplia de promover la concientizaci√≥n sobre la seguridad de las aplicaciones web dentro de su organizaci√≥n.

# ¬øPor qu√© se utiliza OWASP Top 10?

Una vez que hayamos comprendido el OWASP Top 10 y c√≥mo se puede aprovechar en su viaje hacia la ciberseguridad, examinemos por qu√© este recurso es tan utilizado y respetado en la industria. Hemos identificado cuatro razones principales que contribuyen al uso ubicuo del OWASP Top 10.

### Identificaci√≥n de vulnerabilidades comunes

En esencia, OWASP Top 10 proporciona una instant√°nea de las vulnerabilidades encontradas con m√°s frecuencia en las aplicaciones web. Se basa en una gran cantidad de datos recopilados de varias organizaciones de seguridad de todo el mundo. Por lo tanto, como pentester, centrarse en estos riesgos principales puede ayudarle a detectar y explotar la mayor parte de las vulnerabilidades en una aplicaci√≥n determinada. Al hacerlo, aumentar√° su eficiencia y el impacto potencial de su trabajo.

### Aumentar la conciencia sobre la seguridad

Otro beneficio importante de utilizar OWASP Top 10 en pruebas de penetraci√≥n es su papel en el fomento de la conciencia sobre la seguridad. Al centrarse sistem√°ticamente en estos riesgos principales e informar sobre ellos, puede informar a su organizaci√≥n o a sus clientes sobre las amenazas m√°s acuciantes a la seguridad de las aplicaciones web. Esta mayor conciencia a menudo conduce a estrategias de mitigaci√≥n proactivas y a una cultura m√°s consciente de la seguridad.

### Ayudar al cumplimiento

La influencia del OWASP Top 10 se extiende al cumplimiento normativo. Varios √≥rganos rectores y organizaciones de normalizaci√≥n hacen referencia al OWASP Top 10 en sus directrices. Como resultado, una prueba de penetraci√≥n que eval√∫e estas vulnerabilidades puede ayudar a una organizaci√≥n a cumplir con las leyes y regulaciones pertinentes, evitando as√≠ posibles sanciones y da√±os a la reputaci√≥n.

### Gu√≠a de codificaci√≥n segura

OWASP Top 10 no es simplemente una herramienta para pentesters y cazarrecompensas de errores; Tambi√©n es un recurso vital para los desarrolladores. Proporciona una gu√≠a invaluable sobre pr√°cticas de codificaci√≥n segura, lo que ayuda a evitar que estas principales vulnerabilidades lleguen al c√≥digo base en primer lugar. Al educar a los desarrolladores sobre estos riesgos comunes, OWASP Top 10 puede generar aplicaciones m√°s seguras desde cero.

Ya sea que sea un pentester, un desarrollador o una persona que toma decisiones en una organizaci√≥n, la herramienta OWASP Top 10 puede ayudarlo a comprender y administrar las amenazas m√°s importantes a la seguridad de las aplicaciones web. Se trata de encontrar vulnerabilidades, generar conciencia, cumplir con las normas y crear software m√°s seguro.

# Las principales limitaciones de OWASP

A pesar de su amplia utilidad, es importante tener en cuenta que OWASP Top 10 no es una herramienta integral para evaluar la seguridad de las aplicaciones web. Profundicemos en sus limitaciones para comprender por qu√© es una parte valiosa de un enfoque de seguridad m√°s amplio en lugar de una soluci√≥n integral.

### El alcance es limitado

En primer lugar, el OWASP Top 10 no cubre todo el espectro de posibles vulnerabilidades de aplicaciones web. Se centra en los m√°s comunes, lo que sin duda es valioso, pero sigue siendo s√≥lo una porci√≥n de la totalidad de vulnerabilidades. Por lo tanto, si su prueba de penetraci√≥n se concentra exclusivamente en OWASP Top 10, podr√≠a pasar por alto otras vulnerabilidades importantes fuera de su alcance.

### Descripci√≥n general de alto nivel, no an√°lisis profundo

El OWASP Top 10 ofrece una imagen general de las vulnerabilidades m√°s urgentes de las aplicaciones web. Estas descripciones generales de alto nivel se pueden mejorar investigando la hoja de referencia de OWASP sobre cada vulnerabilidad para un tema en particular. Aun as√≠, es posible que no prevea todas las amenazas aprovechadas contra un sistema o aplicaci√≥n web. Es fundamental recordar esto mientras lo utiliza como gu√≠a, reconociendo que puede haber m√°s cosas bajo la superficie que merecen su atenci√≥n.

### Sin adaptaci√≥n a aplicaciones o negocios espec√≠ficos

Cada organizaci√≥n y aplicaci√≥n conlleva un conjunto √∫nico de riesgos y vulnerabilidades. El OWASP Top 10 es una lista generalizada que puede no capturar estos riesgos √∫nicos, espec√≠ficos de la aplicaci√≥n o espec√≠ficos del negocio. Entonces, si bien es un excelente punto de partida, es crucial complementarlo con una evaluaci√≥n de riesgos adaptada a la aplicaci√≥n y al contexto empresarial.

### Sin pruebas de l√≥gica empresarial

El OWASP Top 10 se centra principalmente en vulnerabilidades t√©cnicas. No aborda las fallas de la l√≥gica empresarial, que pueden ser igualmente cr√≠ticas y, por lo general, no pueden detectarse mediante herramientas automatizadas. Tales fallas requieren una comprensi√≥n m√°s profunda de la aplicaci√≥n y sus procesos comerciales asociados.

Si bien OWASP Top 10 sirve como un excelente trampol√≠n para las pruebas de penetraci√≥n, no deber√≠a ser el √∫nico recurso en su caja de herramientas. Una prueba de penetraci√≥n integral tambi√©n debe considerar otras vulnerabilidades y riesgos exclusivos de la aplicaci√≥n y su contexto comercial. Un enfoque equilibrado le ayudar√° a fortalecer sus aplicaciones web de forma eficaz.

No se limite al Top 10 de OWASP. Consid√©relo como una plataforma de lanzamiento para su trabajo de seguridad y pruebas de penetraci√≥n, pero tambi√©n recuerde realizar una evaluaci√≥n de riesgos personalizada, considerar riesgos comerciales y de aplicaciones √∫nicos, y evaluar las fallas de la l√≥gica comercial para garantizar una evaluaci√≥n exhaustiva. Cobertura de seguridad.

# Herramientas y t√©cnicas para las pruebas de penetraci√≥n OWASP

En esta secci√≥n, exploramos varias herramientas y t√©cnicas fundamentales para realizar pruebas de penetraci√≥n basadas en OWASP. Analizaremos las funcionalidades, los beneficios y las posibles deficiencias de cada herramienta para comprender mejor c√≥mo se pueden emplear para realizar pruebas efectivas de seguridad de aplicaciones web.

## Burp Suite

![Burp Suite](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/burp-suite1.png?raw=true)

**Burp Suite** es una plataforma integral de prueba de seguridad de aplicaciones web. Contiene varias herramientas, pero es esencialmente un servidor proxy que se ubica entre el navegador del evaluador y el servidor web, permitiendo al usuario interceptar, inspeccionar y modificar el tr√°fico entre el navegador y el servidor web.

### **Beneficios**

Burp Suite ofrece funciones s√≥lidas e invaluables para probar aplicaciones web. Estos incluyen una herramienta Intruder para automatizar ataques personalizados, una herramienta Repetidora para manipular y reenviar solicitudes individuales y una herramienta Esc√°ner para descubrir vulnerabilidades autom√°ticamente.

### **Desaf√≠os**

Un posible inconveniente de Burp Suite es su pronunciada curva de aprendizaje, especialmente para principiantes. Si bien tiene una versi√≥n gratuita, muchas funciones m√°s avanzadas requieren una licencia paga.

## Metasploit

![Metasploit7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/metasploit7.png?raw=true)

**Metasploit** es una poderosa herramienta de pentesting que le permite encontrar, explotar y validar vulnerabilidades. Permite recopilar informaci√≥n sobre el objetivo, explotar vulnerabilidades conocidas y crear exploits personalizados.

### **Beneficios**

Metasploit es de c√≥digo abierto y tiene una gran comunidad de usuarios, lo que significa que tiene una amplia gama de exploits y se actualiza continuamente. Se puede utilizar para pruebas de penetraci√≥n de aplicaciones web y de redes.

### **Desaf√≠os**

Metasploit, como Burp Suite, puede tener una curva de aprendizaje pronunciada para los principiantes. Adem√°s, como herramienta centrada principalmente en vulnerabilidades a nivel de red, es posible que no tenga tantas funciones dise√±adas espec√≠ficamente para pruebas de aplicaciones web en comparaci√≥n con herramientas como Burp Suite u OWASP ZAP.

## Nmap

![Nmap1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nmap1.png?raw=true)

**Nmap ("Network Mapper")** es una utilidad de auditor√≠a de seguridad y descubrimiento de redes gratuita y de c√≥digo abierto. Puede ayudar a encontrar puertos abiertos, servicios en ejecuci√≥n y otra informaci√≥n sobre el sistema de destino.

### **Beneficios**

Nmap es una excelente herramienta para las etapas iniciales de pentesting, conocidas como reconocimiento. Sus poderosas capacidades de escaneo pueden ayudar a identificar posibles puntos de entrada y prepararse para una mayor explotaci√≥n.

### **Desaf√≠os**

Nmap es principalmente una herramienta de escaneo de red y, si bien es excelente para recopilar informaci√≥n sobre un objetivo, no prueba ni explota vulnerabilidades directamente.

## ZAP OWASP

![ZAP OWASP](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/zap-owasp.png?raw=true)

OWASP Zed Attack Proxy (ZAP) es un esc√°ner de seguridad de aplicaciones web gratuito y de c√≥digo abierto. Est√° dise√±ado para ser utilizado por personas nuevas en seguridad de aplicaciones y pentester profesionales.

### **Beneficios**

ZAP ofrece funcionalidades similares a Burp Suite, como interceptaci√≥n de proxy, esc√°ner automatizado y otras herramientas √∫tiles. Al ser parte de los proyectos de OWASP, est√° particularmente dise√±ado para probar vulnerabilidades incluidas en el Top 10 de OWASP.

### **Desaf√≠os**

Es posible que ZAP no tenga tantas funciones como Burp Suite, especialmente en lo que respecta a la automatizaci√≥n de escenarios de ataque complejos. Sin embargo, ZAP ofrece un conjunto completo de herramientas m√°s que suficientes para muchos usuarios, especialmente aquellos que se inician en la seguridad de aplicaciones web.

## Kit de Pentesting OWASP

![Pentesting OWASP](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pentesting-owasp.png?raw=true)

El **[kit de pruebas de penetraci√≥n de OWASP](https://owasp.org/www-project-penetration-testing-kit/)** es una extensi√≥n de navegador dise√±ada para optimizar sus tareas diarias en materia de seguridad de aplicaciones. Estas son algunas de sus caracter√≠sticas clave:

- **Acceso con un solo clic a informaci√≥n detallada** : con un solo clic, puede acceder a datos valiosos sobre la pila de tecnolog√≠a, firewalls de aplicaciones web (WAF), encabezados de seguridad, enlaces rastreados y flujo de autenticaci√≥n de la aplicaci√≥n que est√° probando.
- **Proxy con registro de tr√°fico detallado** : esta funci√≥n le permite repetir cualquier solicitud en R-Builder o reenviarla a R-Attacker para realizar autom√°ticamente inyecciones de scripts entre sitios (XSS), SQL o comandos del sistema operativo.
- **R-Builder y R-Attacker** : puede crear su propia solicitud en R-Builder o ejecutar un an√°lisis de prueba din√°mica de seguridad de aplicaciones (DAST) utilizando R-Attacker. Estas herramientas pueden ayudarle a identificar directamente las posibles vulnerabilidades de inyecci√≥n SQL o XSS de su navegador.
- **Escaneo de an√°lisis de composici√≥n de software (SCA)** : este escaneo ayuda a identificar vulnerabilidades de JavaScript conocidas, tambi√©n conocidas como vulnerabilidades y exposiciones comunes (CVE).
- **Editor de cookies** : administre las cookies de manera efectiva con opciones para agregar, editar o eliminar cookies. Tambi√©n puede crear reglas para bloquear o proteger cookies o exportar cookies y luego importarlas nuevamente.
- **Utilidad decodificador/codificador** : esta funci√≥n ayuda a administrar la codificaci√≥n y decodificaci√≥n desde y hacia UTF-8, Base64, MD5 y m√°s.
- **Integraci√≥n con Swagger.IO** : esta integraci√≥n le ayuda a comprender mejor la documentaci√≥n de la API y a crear solicitudes de punto final.

### **Beneficios**

Este kit proporciona una gran cantidad de recursos y metodolog√≠as dise√±adas expl√≠citamente para realizar pentesting de acuerdo con las mejores pr√°cticas de OWASP.

### **Desaf√≠os**

Como es m√°s una colecci√≥n de recursos que una herramienta singular, la efectividad del kit de pruebas de penetraci√≥n OWASP depender√° en gran medida de la capacidad del evaluador para utilizar los recursos proporcionados de manera efectiva. Adem√°s, puede que no sea tan "pr√°ctico" o inmediatamente pr√°ctico como otras herramientas como Burp Suite u OWASP ZAP.

Herramientas adicionales que podr√≠an considerarse para esta tarea son:

- **Wireshark** : un popular analizador de protocolos de red que le permite monitorear e inspeccionar el tr√°fico de la red en tiempo real, lo que puede ayudar a detectar anomal√≠as e identificar posibles amenazas a la seguridad.
- **SQLmap** : una herramienta de pentesting de c√≥digo abierto que automatiza **la detecci√≥n y explotaci√≥n de vulnerabilidades de inyecci√≥n SQL en la** base de datos de una aplicaci√≥n.
- **Nikto** : Es un esc√°ner de servidor web que busca archivos y programas potencialmente peligrosos, software de servidor obsoleto y otras vulnerabilidades en los servidores web.
- **WPScan** : un esc√°ner de vulnerabilidades de WordPress de caja negra, gratuito y de uso no comercial, que busca vulnerabilidades conocidas en temas, complementos y versiones principales de WordPress.

## Mejores pr√°cticas para las pruebas de penetraci√≥n OWASP

Ahora que hemos revisado algunas de las herramientas, tambi√©n vale la pena considerar los aspectos estrat√©gicos de las pentesting. Asegurarse de cumplir con las mejores pr√°cticas establecidas ayudar√° a agilizar el proceso de prueba, maximizar la eficiencia de sus esfuerzos y, en √∫ltima instancia, generar aplicaciones m√°s seguras. Profundicemos ahora en algunas de las mejores pr√°cticas clave para las pruebas de penetraci√≥n de OWASP.

Establecer objetivos y alcance claros: es esencial definir los objetivos de una prueba de penetraci√≥n, incluidos los sistemas que se probar√°n, los m√©todos de prueba que se utilizar√°n y los tiempos de prueba permitidos. Todas las partes involucradas deben acordar el alcance, incluido el evaluador y la organizaci√≥n que se est√° probando, para garantizar que la prueba no da√±e inadvertidamente los sistemas o los datos.

### Mantener consideraciones √©ticas y cumplimiento legal

Los pentester siempre deben cumplir con un c√≥digo de √©tica para realizar pruebas de manera responsable. Esto incluye respetar la privacidad de la organizaci√≥n, obtener la autorizaci√≥n adecuada antes de realizar pruebas y cumplir con todas las leyes y regulaciones pertinentes.

### Actualizar peri√≥dicamente conocimientos y habilidades

La seguridad cibern√©tica evoluciona constantemente, por lo que los pentester deben actualizar continuamente sus conocimientos y habilidades. Deben mantenerse informados sobre las √∫ltimas vulnerabilidades, t√©cnicas de ataque y medidas defensivas. El OWASP Top 10, por ejemplo, es un recurso clave que se actualiza peri√≥dicamente para reflejar los riesgos de seguridad de aplicaciones web m√°s cr√≠ticos.

### Colaborar con equipos de desarrollo para una mejor seguridad

Los pentesters deben trabajar en estrecha colaboraci√≥n con los equipos de desarrollo para ayudarlos a comprender los resultados de las pruebas e implementar las mejoras de seguridad necesarias. Por ejemplo, el kit de pruebas de penetraci√≥n de OWASP proporciona herramientas como R-Builder y R-Attacker para ayudar a los evaluadores y desarrolladores a identificar y abordar vulnerabilidades como la inyecci√≥n SQL y XSS.

### Programas de recompensas por errores

Estos programas alientan a los investigadores independientes a encontrar e informar fallas de seguridad en el software de una organizaci√≥n. Luego, la organizaci√≥n puede corregir estas fallas antes de que actores malintencionados puedan explotarlas. El propio OWASP tiene una variedad de proyectos y herramientas que pueden ayudar a ejecutar un programa de recompensas por errores exitoso.

### Huellas digitales de aplicaciones web

La toma de huellas digitales de aplicaciones web es una t√©cnica que se utiliza para identificar el tipo y la versi√≥n de un servidor web que aloja una aplicaci√≥n. Esta informaci√≥n puede ser crucial para identificar posibles vulnerabilidades, especialmente si los servidores ejecutan software desactualizado o sin parches. Las t√©cnicas van desde la captura de banners, donde se realiza una solicitud HTTP y se analiza el encabezado de respuesta del servidor, hasta el uso de solicitudes con formato incorrecto y herramientas automatizadas como Netcraft, Nikto y Nmap.

## Conclusi√≥n

Navegar por el complejo panorama de las pruebas de penetraci√≥n de aplicaciones web puede resultar un desaf√≠o. Aun as√≠, con la ayuda de las estrategias, herramientas y t√©cnicas detalladas en esta gu√≠a, especialmente aquellas alineadas con el Top Ten de OWASP, estar√° bien equipado para realizar auditor√≠as de seguridad efectivas.

Esta gu√≠a es s√≥lo un trampol√≠n en el vasto mundo de la seguridad de las aplicaciones. Es imperativo comprender estos conceptos y dominar estas herramientas, pero recuerde que la ciberseguridad es un campo en constante evoluci√≥n. Requiere aprendizaje continuo y adaptaci√≥n a nuevas amenazas y vulnerabilidades.

# Blue team

# Detecci√≥n y respuesta de red (NDR)

## **¬øQu√© es la detecci√≥n y respuesta de red (NDR)?**

La detecci√≥n y respuesta de red (NDR) es una soluci√≥n de ciberseguridad que ingiere el tr√°fico de la red y utiliza el aprendizaje autom√°tico para detectar actividades maliciosas y comprender los riesgos y la exposici√≥n de seguridad. Combina la detecci√≥n de comportamientos de ataque conocidos con la capacidad de comprender qu√© es normal para una organizaci√≥n determinada, se√±alando cambios inusuales que pueden indicar un ataque.

Al igual que la detecci√≥n y respuesta de endpoints (EDR) , las soluciones de seguridad NDR no previenen la actividad maliciosa. En cambio, su objetivo es detener la actividad de ataque en curso antes de que pueda resultar perjudicial. NDR se diferencia de EDR en que no utiliza un agente para obtener informaci√≥n sobre la actividad maliciosa, sino que depende de una red o un grifo virtual para el an√°lisis del tr√°fico entre cargas de trabajo locales y en la nube.

## **Capacidades de las soluciones NDR**

Las soluciones NDR analizan el tr√°fico de la red para detectar actividad maliciosa dentro del per√≠metro (tambi√©n conocido como corredor este-oeste) y respaldan la detecci√≥n, investigaci√≥n y respuesta inteligente a amenazas. Utilizando un puerto espejo de red fuera de banda o un grifo virtual, las soluciones NDR capturan pasivamente las comunicaciones de la red y aplican t√©cnicas avanzadas, incluidos an√°lisis de comportamiento y aprendizaje autom√°tico, para identificar patrones de ataque conocidos y desconocidos. Estos datos tambi√©n se pueden utilizar para realizar investigaciones en tiempo real sobre la actividad posterior al compromiso y para investigar incidentes de forma forense. Si bien no todas las soluciones NDR descifran el tr√°fico de red, las soluciones m√°s avanzadas brindan capacidad de descifrado seguro para ayudar a identificar las amenazas que se esconden dentro del tr√°fico cifrado.

### **La necesidad de una soluci√≥n NDR**

La mayor√≠a de los ciberataques se producen a trav√©s de la red, lo que es a la vez bueno y malo para los defensores. Por un lado, los ataques a la red pueden detectarse y mitigarse mediante defensas a nivel de red. Por otro lado, la complejidad y escala de la red de una organizaci√≥n promedio y la creciente sofisticaci√≥n de los actores de amenazas cibern√©ticas pueden dificultar la detecci√≥n de ataques del tr√°fico leg√≠timo.

La visibilidad profunda de la red y las capacidades avanzadas de prevenci√≥n y detecci√≥n de amenazas son esenciales para proteger a la empresa contra las amenazas cibern√©ticas. Los m√©todos tradicionales de detecci√≥n basados ‚Äã‚Äãen firmas suelen ser ineficaces contra las amenazas modernas, lo que deja a la organizaci√≥n con una falsa sensaci√≥n de seguridad. Las soluciones de seguridad NDR brindan una capa adicional de seguridad a nivel de red y capacidades de prevenci√≥n de amenazas que las organizaciones requieren.

### **¬øC√≥mo funciona NDR?**

Las soluciones NDR deber√≠an poder monitorear los flujos de tr√°fico de norte a sur y de este a oeste con sensores estrat√©gicamente ubicados. Esto proporciona una visibilidad profunda de la red que admite otras caracter√≠sticas de una soluci√≥n NDR, que incluyen:

- **Detecci√≥n de incidentes cibern√©ticos:** las soluciones NDR van m√°s all√° de la detecci√≥n basada en firmas para utilizar inteligencia artificial (IA), aprendizaje autom√°tico (ML) y an√°lisis de datos para analizar el tr√°fico de la red. Esto les permite detectar patrones e identificar anomal√≠as en el tr√°fico de la red, lo que permite detectar tr√°fico sospechoso o malicioso.
- **Investigaci√≥n:** Las soluciones de seguridad de NDR monitorean el tr√°fico de la red y extraen patrones que pueden se√±alar conexiones an√≥malas o sospechosas. Esta informaci√≥n se utiliza para generar respuestas automatizadas por parte de la soluci√≥n NDR y se proporciona a los analistas del Centro de operaciones de seguridad (SOC) para facilitar sus actividades de investigaci√≥n de incidentes.
- **Gesti√≥n de inteligencia:** las soluciones de detecci√≥n y respuesta de redes pueden consumir inteligencia sobre amenazas desde dentro y fuera de la organizaci√≥n. Esta inteligencia se utiliza para ayudar a detectar amenazas potenciales dentro del tr√°fico de la red y puede compartirse con otras soluciones de seguridad como parte de una arquitectura de seguridad convergente.
- **Creaci√≥n de feeds:** la funci√≥n principal de una soluci√≥n NDR es proporcionar a los analistas de SOC informaci√≥n sobre la postura de seguridad actual y las amenazas a su red. NDR crear√° una fuente de alertas de seguridad que indicar√°n tr√°fico de red sospechoso y potencialmente malicioso.
- **Prevenci√≥n de amenazas:** adem√°s de alertar a los analistas de seguridad sobre posibles amenazas, las soluciones NDR tambi√©n pueden actuar de forma autom√°tica y proactiva para evitar que los ciberataques tengan √©xito. Esto puede incluir trabajar con firewalls y otras soluciones de seguridad para impedir que el tr√°fico sospechoso o malo llegue a su destino, interrumpiendo el ataque.

### **¬øC√≥mo mejora NDR su seguridad?**

Las soluciones de seguridad de red tradicionales suelen centrarse en la detecci√≥n y utilizan capacidades de detecci√≥n basadas en firmas. Ambos son pasivos a la hora de proteger a la empresa contra las amenazas cibern√©ticas modernas. Los esquemas de detecci√≥n basados ‚Äã‚Äãen firmas utilizados en muchas soluciones de seguridad heredadas, como los antivirus tradicionales y los sistemas de detecci√≥n de intrusiones (IDS), ya no son eficaces para detectar amenazas modernas.

Los ciberdelincuentes suelen utilizar malware dise√±ado para diferir de una campa√±a a otra, lo que significa que las firmas quedan obsoletas tan pronto como se generan. Una soluci√≥n NDR utiliza capacidades avanzadas de detecci√≥n de IA para identificar y responder incluso a amenazas cibern√©ticas novedosas, para las cuales a√∫n no existen firmas.

NDR proporciona visibilidad dentro de la red empresarial, lo que permite a los analistas determinar los activos afectados y correlacionar su comportamiento an√≥malo, generando indicadores de las t√°cticas, t√©cnicas y procedimientos de los atacantes. Los indicadores se utilizan para interrumpir y contener los ataques y para guiar la evaluaci√≥n de da√±os y las operaciones de recuperaci√≥n.

# Recomendaciones de despliegues

En los siguientes puntos se detallar√°n diferentes tipos de despliegues usando las tecnolog√≠as, IDS/IPS y SIEM. Se partir√° de una arquitectura base que ir√° evolucionando para llegar a una arquitectura completa que contiene todos los elementos necesarios para disponer de un sistema de detecci√≥n/prevenci√≥n de intrusiones as√≠ como de un sistema de recolecci√≥n y gesti√≥n de eventos.

## **Arquitectura base de sistemas de control**

La arquitectura base seleccionada est√° basada en la propuesta ofrecida por la norma IEC 62443. En ella se definen diferentes zonas asociadas a los niveles en los que se divide un sistema de control industrial. La arquitectura base presenta una segmentaci√≥n basada en cortafuegos para separar las zonas de control y corporativa, contando adem√°s con dos DMZ para el intercambio de informaci√≥n entre ambas zonas. Las arquitecturas siguientes propuestas presentas arquitecturas de seguridad para asegurar las comunicaciones y los dispositivos situados en la parte de control de la red. La seguridad de la parte corporativa no se ha tenido en cuenta en este estudio al quedar fuera del √°mbito del mismo.

![Arquitectura1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura1.png?raw=true)

## **Arquitecturas de seguridad para sistemas de control**

### **Arquitectura de seguridad con IDS**

La primera arquitectura, presentada en la Figura, describe la colocaci√≥n de dispositivos de tipo IDS para monitorizar el tr√°fico dentro de la red de control. Para ello, todo el tr√°fico que pasa por los router/switches se lleva al sensor del IDS a trav√©s de puertos espejo (*mirror/SPAN*). Tambi√©n se a√±ade una sonda para recibir informaci√≥n del cortafuegos y tener as√≠ controlado el tr√°fico intercambiado con la red correspondiente a la zona empresarial. Los IDS deber√°n de disponer de las reglas adecuadas para generar las alertas oportunas que ser√°n mostradas al operario o administrador de seguridad correspondiente a trav√©s de la consola.

![Arquitectura2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura2.png?raw=true)

### **Arquitectura de seguridad con IPS**

La evoluci√≥n de una arquitectura de seguridad con IDS pasa por bloquear el tr√°fico. Para ello es necesario que los sensores pasen a estar en medio del tr√°fico, en lugar de escuchando el tr√°fico a trav√©s de los puertos espejo (*mirror/SPAN*), como refleja la Figura. La configuraci√≥n de reglas debe ser adecuada para que no se interrumpa el flujo de tr√°fico de control habitual y solo se bloqueen las intrusiones y fallos de seguridad. La situaci√≥n de los sensores IPS es similar a la de los sensores IDS, y el funcionamiento ser√° exactamente el mismo, generando alerta que ser√°n mostradas en la consola de IDS.

![Arquitectura3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura3.png?raw=true)

### **Arquitectura de seguridad con SIEM**

La Figura representa la instalaci√≥n de un SIEM dentro de los sistemas de control. Hay que tener en cuenta que el SIEM se dedica a recoger y gestionar eventos de log, por lo que las fuentes de datos provendr√°n de todos los dispositivos. En este caso hay que tener cuidado con las comunicaciones, ya que todos los dispositivos deben poder enviar sus registro de eventos hasta el SIEM, y esto puede implicar una sobrecarga de tr√°fico en la red. La mejor forma de solucionar esta sobrecarga es disponer de una red exclusiva para el env√≠o de estos mensajes.

![Arquitectura4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura4.png?raw=true)

### **Arquitectura unificada con IDS, IPS y SIEM**

La representaci√≥n final (Ver Figura) muestra la puesta en conjunto de las tres tecnolog√≠as dentro de una arquitectura de red de sistemas de control. El IPS quedar√≠a para los niveles superiores, controlando el tr√°fico intercambiado entre la parte de control y la parte corporativa o de negocio, los IDS gestionar√≠an el tr√°fico entre la red de control y las de campo, informado de posibles anomal√≠as en el tr√°fico; y el SIEM recoger√≠a la informaci√≥n del mayor n√∫mero posible de dispositivos, incluyendo dispositivos de proceso y elementos de red, as√≠ como la informaci√≥n de las alertas tanto de los IDS como del IPS.

Las l√≠neas rojas mostradas en las figuras indican los puntos donde tanto los sensores IDS como los sensores IPS se conectan para recabar el tr√°fico, y constituyen una conexi√≥n de red. La red de monitorizaci√≥n se utiliza como nexo de uni√≥n entre los sensores IDS/IPS y el n√∫cleo central de gesti√≥n, y por este motivo no se requiere un acceso a dicha red desde ninguna otra parte de la arquitectura. Las l√≠neas marcadas en verde que finalizan el en SIEM muestran de d√≥nde se obtiene informaci√≥n y no conexiones de red reales. La informaci√≥n se enviar√° a trav√©s de las conexiones existentes, habilitando en el cortafuegos (y en su caso en el IDS/IPS) las reglas correspondientes

![Arquitectura5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/arquitectura5.png?raw=true)

## Conclusiones

Los sistemas de detecci√≥n y prevenci√≥n de intrusiones y los sistemas de tratamiento y gesti√≥n de eventos e incidentes aportan un nivel de seguridad a los sistemas de control siempre y cuando est√©n correctamente configurados y supervisados. La configuraci√≥n de un sistema de prevenci√≥n puede implicar muchos problemas sobre un sistema de control en producci√≥n, por lo que deben ser correctamente valoradas todas las implicaciones, as√≠ como realizar todas las posibles pruebas previamente, incluyendo las de mantener el sistema s√≥lo en modo detecci√≥n hasta estar totalmente seguros de que no se bloquear√° tr√°fico cr√≠tico para el sistema e ir afinando progresivamente el sistema para que s√≥lo detecte o informe de eventos importantes.

Los SIEM proporcionan informaci√≥n del estado del sistema a los operadores de seguridad, pero s√≥lo son √∫tiles si la informaci√≥n recogida es correctamente analizada. Centralizar todos los eventos en un √∫nico equipamiento tiene la ventaja de que todas las acciones ocurridas van a ser controladas en el m√≠nimo tiempo y no se van a perder por tener que revisar m√∫ltiples aplicaciones. La inclusi√≥n de estas herramientas en la arquitectura de los sistemas de control puede ser compleja dependiendo del sistema que se quiera controlar, pero los beneficios van a compensar todo el esfuerzo invertido en el despliegue, ganando un control en la red y que permite asegurar el correcto funcionamiento del sistema sin intrusiones.

# SIEM

### **¬øQu√© es un SIEM?**

SIEM o Gesti√≥n de Eventos e Informaci√≥n de Seguridad (Security Information and Event Management) es una categor√≠a de software que tiene como objetivo otorgar a las organizaciones informaci√≥n √∫til sobre potenciales amenazas de seguridad de sus redes cr√≠ticas de negocio, a trav√©s de la estandarizaci√≥n de datos y priorizaci√≥n de amenazas. Esto es posible mediante un an√°lisis centralizado de datos de seguridad, obtenidos desde m√∫ltiples sistemas, que incluyen aplicaciones antivirus, firewalls y soluciones de prevenci√≥n de intrusiones.

Las soluciones SIEM son una soluci√≥n h√≠brida de las categor√≠as de productos como SIM (*Security Information Management*) y SEM (*Security Event Manager*). La tecnolog√≠a SIEM proporciona un an√°lisis en tiempo real de las alertas de seguridad generadas por el hardware y software de red. Las soluciones SIEM pueden venir como software, aplicaciones, o administraci√≥n de servicios, y tambi√©n son utilizados para registrar datos de seguridad y generar reportes para fines de cumplimiento.

> SEM: Es el primer √°rea de gesti√≥n de la seguridad, se ocupa de la monitorizaci√≥n en tiempo real, correlaci√≥n de eventos, notificaciones y vistas de la consola que com√∫nmente se conoce como Gesti√≥n de Eventos de Seguridad (Security Event Management).
 
> **SIM**: Ofrece almacenamiento a largo plazo, an√°lisis y comunicaci√≥n de los datos de eventos, y se conoce como **Gesti√≥n de Seguridad de la Informaci√≥n (*Security Information Management*)**.

El t√©rmino Gesti√≥n de la Informaci√≥n de Seguridad y de Eventos (***Security Information and Event Management***) describe m√∫ltiples capacidades como la recopilaci√≥n, an√°lisis y presentaci√≥n de informaci√≥n de la red y los dispositivos de seguridad. A esto se le a√±aden

las aplicaciones de gesti√≥n de identidades y accesos, gesti√≥n de vulnerabilidades y los instrumentos de pol√≠tica de cumplimiento, sistema operativo, base de datos, logs, y datos de amenazas externas. La clave es monitorizar y ayudar a controlar los privilegios de usuario y de servicio, servicios de directorio y otros cambios de configuraci√≥n del sistema, as√≠ como proporcionar datos para auditor√≠a de eventos, revisi√≥n y respuesta a incidentes.

La detecci√≥n de eventos de inter√©s puede ser a trav√©s de cualquiera de los grupos funcionales, con el soporte SEM, capaz de monitorizar en tiempo real; y el SIM, que proporciona un medio eficaz para comparar la gran cantidad de eventos recopilados. Los SIEM est√°n dise√±ados para recopilar eventos de seguridad a partir de una amplia variedad de fuentes dentro de una organizaci√≥n. Una vez que el SIEM tiene los eventos, procesa los datos para estandarizarlos, lleva a cabo el an√°lisis de los datos "normalizados", genera alertas cuando detecta actividad an√≥mala, y produce informes a petici√≥n de los administradores. Algunos productos SIEM tambi√©n pueden actuar para bloquear las actividades maliciosas.

### **¬øPor qu√© es importante tener un SIEM?**

No es un secreto que las amenazas de seguridad aumentan continuamente, y que pueden provenir tanto de fuentes internas como externas. Una preocupaci√≥n que crece es la posibilidad de que, accidentalmente, los empleados configuren err√≥neamente los ajustes de seguridad, dejando los datos vulnerables a un ataque. Para prevenir estos problemas, las organizaciones de IT han incorporado varios sistemas para protegerse de intrusiones y de una gran cantidad de amenazas diversas.

La desventaja de estos sistemas de protecci√≥n es que generan tanta informaci√≥n para monitorizar, que los equipos de IT se enfrentan al problema de tener que interpretarla en su totalidad para poder reconocer los problemas reales. De hecho, el volumen de datos de Seguridad que fluyen a los equipos de Seguridad de IT con poco personal, es m√°s que nada in√∫til, a menos que pueda ser r√°pidamente analizado y filtrado en alertas procesables. Teniendo en cuenta la cantidad de datos que pueden llegar a ser, para las organizaciones ya no es posible hacer este an√°lisis en forma manual. Es aqu√≠ donde aparece el software SIEM.

Con un SIEM, los profesionales de IT cuentan con un m√©todo efectivo para automatizar sus procesos y centralizar la gesti√≥n de Seguridad de una forma que ayude a simplificar la dif√≠cil tarea de proteger informaci√≥n sensible. Un SIEM proporciona a los expertos una ventaja para comprender la diferencia entre una amenaza de bajo riesgo y una que puede ser determinante para su negocio.

<aside>
üëâ **La estandarizaci√≥n de datos es fundamental**
</aside>

La posibilidad de contar con datos de Seguridad que fluyen en una vista centralizada de su infraestructura es efectiva solo si esos datos pueden ser estandarizados. Esto significa que, a pesar de las miles o millones de entradas provenientes de los distintos sistemas y fuentes, todo puede ser colocado en un formato com√∫n, listo para que la soluci√≥n SIEM pueda ejecutar su an√°lisis y correlaci√≥n. Esto reduce la carga de trabajo de su equipo y le permite aprovechar una vista optimizada de la actividad y las potenciales preocupaciones.

## **Funcionalidades claves de una soluci√≥n SIEM**

Las soluciones SIEM disponibles comparten puntos en com√∫n que son importantes para sus operaciones. Debe contar con la capacidad de:

- Centralizar la vista de potenciales amenazas
- Determinar qu√© amenazas requieren resoluci√≥n y cu√°les son solamente ruido
- Escalar temas a los analistas de Seguridad apropiados, para que puedan tomar una acci√≥n r√°pida
- Incluir el contexto de los eventos de Seguridad para permitir resoluciones bien informadas
- Documentar, en un registro de auditor√≠a, los eventos detectados y c√≥mo fueron resueltos
- Cumplir con las regulaciones de la industria en un formato de reporte sencillo

## **El rol de SIEM en el cumplimiento regulatorio**

Los SIEM ganaron popularidad entre las grandes compa√±√≠as que deben cumplir con PCI DSS (el Est√°ndar de Seguridad de Datos para la Industria de Tarjetas de Pago). Adem√°s, dispone de aplicaciones muy √∫tiles que ayudan al cumplimiento de normativas como la Regulaci√≥n General de Protecci√≥n de Datos (GDPR), y Sarbanes-Oxley (SOX), entre otras. Estas leyes obligan a las empresas a contar con mecanismos instalados que les permitan detectar amenazas y resolverlas r√°pidamente. Esto significa que debe saber lo que est√° sucediendo en un amplio espectro de su infraestructura de IT, ya sea en entornos locales, en la nube, o h√≠bridos.

Una soluci√≥n SIEM es fundamental para obtener la informaci√≥n necesaria para monitorizar datos y actuar r√°pidamente sobre las amenazas que est√°n determinadas a ser una causa de alarma. Cuando toda esta actividad est√° capturada en un registro de auditor√≠a detallado, los auditores pueden ver que su compa√±√≠a est√° tomando los pasos necesarios para proteger sus datos.

### **Ejemplos de SIEM en acci√≥n:**

Un SIEM puede ser utilizado para detectar cualquier n√∫mero de amenazas de Seguridad, incluso la presencia de ransomware, accesos no autorizados a datos, intentos de log-in fallidos que no coinciden con los problemas est√°ndares de log-in, y picos inusuales en el ancho de banda. Ya sea que estas amenazas provengan de fuentes internas o externas, el software es capaz de enviar una alerta priorizada que notifique a su equipo del problema potencial para que sea investigado de inmediato. A medida que las amenazas de Seguridad evolucionan, las soluciones SIEM se convierten en un componente cr√≠tico para proporcionar a las organizaciones un entorno seguro para sus datos.

- **Capacidades de detecci√≥n en tiempo real**

La gesti√≥n de eventos de seguridad (SEM) proporciona herramientas y funcionalidades en tiempo real o casi para facilitar la gesti√≥n de los eventos relacionados con la seguridad, mediante la evaluaci√≥n de los eventos y la correlaci√≥n de la informaci√≥n procedente de diferentes fuentes. Al no depender de una sola fuente de informaci√≥n, como lo hacen los IDS / IPS, la funci√≥n de gesti√≥n de eventos puede ayudar a reducir el n√∫mero de falsos positivos, asegurando que el evento que haya sido descubierto se comunique al resto de sistemas. A medida que la base de datos se actualiza se vuelve m√°s eficaz y diferencia mejor los incidentes de seguridad de los patrones habituales de eventos.

Las tecnolog√≠as avanzadas SEM soportan capacidades de visualizaci√≥n de datos, que pueden ayudar al analista de seguridad a evaluar r√°pidamente los acontecimientos y tendencias. Las funciones de an√°lisis de amenazas y la priorizaci√≥n de eventos proporcionan una asistencia extra al personal de operaciones de seguridad, ya que pueden concentrar sus esfuerzos en la investigaci√≥n de los eventos que tienen las clasificaciones de amenaza m√°s altas.

- **SEM en industria**

Las herramientas y funcionalidades proporcionadas por el gestor de eventos de seguridad son a menudo muy competitivas en el sector industrial. Debido al uso de protocolos propietarios de los elementos industriales, se requiere llevar a cabo un aprendizaje exhaustivo; pero gracias a los pocos cambios ocurridos en la red y su alta estabilidad proporciona una seguridad elevada, al poder detectar f√°cilmente cualquier conexi√≥n o mensaje fuera de la transmisi√≥n habitual entre las m√°quinas.

- **Gesti√≥n de archivos de eventos**

Las funciones del SIM se caracterizan por el an√°lisis de datos en tiempo no real, a trav√©s de la recopilaci√≥n y estandarizaci√≥n de sistemas dispares y la informaci√≥n centralizada de aplicaciones (por ejemplo, eventos del sistema, pistas de auditor√≠a, registros de eventos y registros de transacciones).

El analista de seguridad puede consultar el archivo y recuperar informaci√≥n a trav√©s de consultas estandarizadas; almacenando la informaci√≥n de diferentes sistemas en un solo lugar, de manera cronol√≥gica y formalizada.

Las tecnolog√≠as avanzadas SIM pueden evaluar estos eventos guardados, a medida que se recogen o bajo demanda, con el fin de examinar comportamientos an√≥malos en futuros an√°lisis.

El an√°lisis forense se favorece por las funciones de gesti√≥n de eventos, mientras que los eventos centralizados ayudan a gestionar los tiempos de retenci√≥n para cumplir con las leyes y normas aplicables. La capacidad de generaci√≥n de informes puede simplificar las evaluaciones internas y los ciclos de auditor√≠a de una organizaci√≥n.

Los sistemas SIEM proporcionan detecci√≥n de eventos por medio de la evaluaci√≥n en tiempo real de la informaci√≥n y por el an√°lisis forense de eventos previamente almacenados.

El funcionamiento para analizar la red se basa en reglas y firmas, aunque tambi√©n dispone de soporte para crear nuevos scripts mediante el lenguaje LUA. Dispone de entradas y salidas estandarizadas a formatos como YAML que le permiten integrarse f√°cilmente con otras herramientas como SIEM o bases de datos. Al involucrar a la comunidad de c√≥digo abierto y el conjunto de los recursos m√°s importantes de reglas IDS/IPS disponible, OISF ha construido el motor Suricata para simplificar el proceso de mantenimiento del nivel de seguridad √≥ptimo. A trav√©s de asociaciones estrat√©gicas, OISF est√° aprovechando la experiencia de Amenazas Emergentes y otros recursos importantes en la industria para proporcionar las reglas m√°s actualizadas y completas disponibles.

![SIEM1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/siem1.png?raw=true)

***Fases en la gesti√≥n de amenazas***

**SIM en la industria**

Las funciones de recopilaci√≥n de datos son perfectas para los procesos de auditor√≠a. Por suerte, los datos registrados por los sensores suelen ser muy homog√©neos en redes donde los equipos no se modifican durante grandes periodos de tiempo. Es f√°cilmente detectable cualquier anomal√≠a en los protocolos, valores o tiempos, viendo al instante los cambios producidos por posibles ataques a la red.

## **Entendiendo un SIEM**

Los SIEM requieren de una gran cantidad de planificaci√≥n antes de que comience la ejecuci√≥n, identificaci√≥n y prevenci√≥n de las violaciones de seguridad. La implementaci√≥n suele declararse como desalentadora para gran cantidad de empresas, muchas veces siendo externalizada, por ser dif√≠cil de ajustar y puede llevar un tiempo considerable antes de obtener los resultados deseados.

Existen varias razones que podr√≠an conducir a una empresa a poner en pr√°ctica un SIEM, desde el cumplimiento de una norma de gobierno o de industria, pasando por haber sido la v√≠ctima de un ataque cibern√©tico, o tal vez obtener un cierto nivel de seguridad antes de firmar un contrato. Independientemente de la convicci√≥n, cuando una compa√±√≠a se decide a implementar un SIEM, tendr√° que realizar grandes esfuerzos antes de que comience a ver los resultados.

## **Implantaci√≥n del SIEM en redes industriales**

La implementaci√≥n de un SIEM en una red OT conlleva varias dificultades:

- **Ciclos de vida muy largos:** El problema m√°s habitual en los sistemas industriales viene por el ciclo de vida, muchas veces entre 20 y 40 a√±os dependiendo del tipo de industria. A√±adir elementos de seguridad a la red o a equipo, pueda afectar, modificar o retrasar la se√±al de comunicaciones de los PLC u otros equipos, debido a la baja potencia de procesado con la que cuenta. Esto puede conllevar a una problem√°tica asociada a la compatibilidad y al funcionamiento entre los equipos de esa red.
- **Prestaciones**: Los ordenadores que se encuentran en las redes industriales, as√≠ como los propios dispositivos industriales, suelen ser equipos poco potentes, desfasados y desactualizados, con las capacidades justas para las tareas de control asignadas. Un antivirus moderno, las herramientas IDS/IPS y otras que son necesarias para el procesamiento de los logs, pueden conllevar incompatibilidades, disminuci√≥n de potencia los dispositivos o incluso el mal funcionamiento general del sistema.
- **Personal**: Los empleados y t√©cnicos necesarios para la gesti√≥n de los SIEM deben tener adem√°s los conocimientos suficientes para entender los protocolos y equipos de la red industrial para poder interpretar correctamente los eventos generados.

## **Consideraciones de implantaci√≥n de un SIEM**

La implantaci√≥n de un SIEM requiere un profundo conocimiento de la topolog√≠a de red y de sus protocolos, y de una comprensi√≥n clara de lo que se espera que haga. La mejor manera de implantar un SIEM es por medio de sus dos componentes m√°s importantes por separado, la gesti√≥n de las capacidades de registro y seguimiento por una parte y la respuesta ante las alertas por otra. La primera tarea para la organizaci√≥n ser√° conocer que considera como activo cr√≠tico y posteriormente se pasar√° al estudio de su protecci√≥n.

Algunas compa√±√≠as disponen de una variedad de eventos que recopilar y procesar de manera diferente. Antes de que el sistema SIEM sea capaz de proporcionar informes √∫tiles, los diversos eventos deber√°n ser normalizados para que los datos sean coherentes. Antes de que una empresa pueda sacar el m√°ximo provecho de su SIEM, deber√° configurar el sistema para hacer frente a los datos que se recogen en cada tipo de dispositivo, c√≥mo y d√≥nde se almacenan los datos, y c√≥mo los incidentes crean los avisos, adem√°s de gestionar el horario, que tambi√©n puede ser condicionante a la hora de generar los avisos.

Cada SIEM tiene su propio conjunto de requisitos para la recopilaci√≥n de eventos. Hay muchos tipos de fuentes de eventos, pero syslog y los registros de eventos de Windows generalmente cubren el 75 por ciento o m√°s del entorno de una empresa. La seguridad es un proceso y no una operaci√≥n t√°ctica. Con el fin de obtener los mejores resultados medibles para la inversi√≥n en el SIEM deber√°n elegir las mejores situaciones para incorporar sus sensores distribuidos por la red.

![SIEM2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/siem2.png?raw=true)

## **El camino hacia el √©xito SIEM**

Hacer funcionar correctamente un SIEM para que sea eficiente y efectivo para la empresa requiere de una serie de pasos y medidas a tener en cuenta:

- Recoger los eventos de las fuentes de seguridad est√°ndar.
- Enriquecer los eventos con datos suplementarios provenientes de otras fuentes.
- Aplicar inteligencia de global de amenazas (listas negras).
- Correlaci√≥n de la informaci√≥n recogida.
- Investigar los eventos generados, realizando seguimiento y correcci√≥n.
- Documentar las acciones a realizar, los procedimientos operativos est√°ndar, acuerdos de nivel de servicio, tickets de problema.
- Incorporar nueva informaci√≥n al SIEM mediante la creaci√≥n de listas blancas o nuevos contenidos.

<aside>
üí° En algunos casos, una organizaci√≥n podr√≠a optar por la gesti√≥n externalizada SIEM sobre una empresa especializada en seguridad. En los sistemas IT la gesti√≥n se llevar√≠a desde las propias instalaciones de la empresa de seguridad, pero en los sistemas OT es m√°s com√∫n que un t√©cnico o m√°s de la empresa de seguridad se desplacen a trabajar conjuntamente en la industria.
</aside>

## **Gesti√≥n interna vs externalizada**

El beneficio de SIEM dedicado hace que los datos de la empresa nunca salgan al exterior, la empresa tiene control sobre el hardware y los eventos almacenados. Tienen la capacidad de configurar las correlaciones (reglas), la presentaci√≥n de informes, los per√≠odos de

retenci√≥n, y otros ajustes para satisfacer sus necesidades. Los SIEM administrados internamente, pueden causar problemas en la dotaci√≥n de personal o que el personal asignado pueda ser requerido para otros proyectos o funciones.

La gesti√≥n de un SIEM requiere una formaci√≥n especializada y de unos procedimientos de trabajo normalizados que deben ser creados y mantenidos para cada entorno. Un enfoque fuera de las instalaciones requiere que los eventos se env√≠en al administrador, y con esto, se pierde la visibilidad.

Las desventajas a las que un cliente se enfrenta cuando se trata de un SIEM externalizado son: la falta de visibilidad y la incapacidad para moverse entre proveedores y mantener los eventos m√°s antiguos. Esta falta de visibilidad provoca problemas con la b√∫squeda de nuevas amenazas. Dado que los proveedores de servicios gestionados se suelen especializar en un fabricante de SIEM, son mucho m√°s eficientes y por lo general tienen una mayor experiencia para recurrir a operaciones.

## **Capacidades de un SIEM**

- **Agregaci√≥n de datos**: SEM / LM (administraci√≥n de logs) soluciones para administraci√≥n de logs desde muchas fuentes, incluyendo redes, seguridad, servidores, bases de datos, aplicaciones, proporcionando la capacidad de consolidar los datos monitorizados para ayudar a evitar la p√©rdida de los acontecimientos cruciales.
- **Correlaci√≥n**: busca atributos comunes y relaciona eventos en paquetes o incidentes. Esta tecnolog√≠a realiza t√©cnicas de correlaci√≥n para integrar diferentes fuentes, con el fin de convertir los datos en informaci√≥n.
- **Alerta**: el an√°lisis automatizado de eventos correlacionados y la producci√≥n de alertas, que ser√°n enviadas al administrador.
- **Cuadros de mando**: SIEM / LM herramienta para transformar los datos y convertirlos en tablas y gr√°ficas informativas que ayuden a reconocer patrones o identificar actividades an√≥malas.
- **Cumplimiento**: Las aplicaciones SIEM se pueden emplear para automatizar la recopilaci√≥n de datos y en la elaboraci√≥n de informes adaptados a normativas existentes.
- **Retenci√≥n**: SIEM / SIM emplea soluciones a largo plazo de almacenamiento de datos, que constituyen un proceso cr√≠tico en la investigaci√≥n forense, ya que es poco probable que el descubrimiento de una violaci√≥n de la red sea en el instante en el que se produzca.
- **Redundancia**: Los motores de correlaci√≥n no requieren ser redundantes, sin embargo, es muy aconsejable que la base de datos si est√© redundada para no perder informaci√≥n.
- **Escalabilidad**: Permitir que el sistema sea configurado jer√°rquicamente, de manera que pueda crecer atendiendo a las necesidades.

## **Opciones SIEM basadas en la nube**

Un enfoque que est√° empezando a crecer es el SIEM como un servicio en la nube. Mientras que los proveedores en la nube podr√≠an ofrecer programas especiales para los clientes SIEMaaS (SIEM as a Service) por primera vez, los proveedores m√°s grandes quieren ofrecer tambi√©n soluciones SIEM. Los proveedores deben reconocer que los eventos son propiedad del cliente, y los clientes tienen que entender que los eventos pueden contener informaci√≥n confidencial de la empresa.

Se recomienda que si la empresa recoge datos protegidos, se ha de firmar un acuerdo entre ambos para asegurar que los datos se manejan apropiadamente. A diferencia tradicional, en el software SIEM basado en la nube generalmente se factura en funci√≥n del modelo de uso, y no por servidor o por usuario. Sin embargo, si el software SIEM env√≠a todos los eventos a la nube, o de lo contrario se configura incorrectamente, el costo del ancho de banda del proveedor de la nube podr√≠a ser alto.

Las empresas m√°s peque√±as pueden encontrar mayores beneficios en la utilizaci√≥n de un proveedor de servicios que ofrece seguridad basada en SaaS o un proveedor de servicios de seguridad gestionada (MSSP) que va a proporcionar algunas de las demandas en curso.

## **SIEM Open Source**

Existe una gran multitud de ofertas y opciones, en este estudio nos centraremos en uno de los SIEM m√°s conocidos y populares, se trata de Security Onion, desarrollado por Doug Burks, creando una implementaci√≥n o uni√≥n de todos los programas libres para el trabajo con IDS/IPS de una forma muy sencilla de instalar, permitiendo instalar software de terceros como Splunk por medio de aplicaciones.

Existen otros muchos SIEM, tambi√©n efectivos contra amenazas, pero pueden llevar asociados costes o quiz√° puedan ser menos usados. Por hablar de otras posibilidades, tenemos a modo de ejemplo:

- AlienVault Open Source SIEM (OSSIM), [https://www.alienvault.com/products/ossim](https://www.alienvault.com/products/ossim)
- EMC RSA Security Analytics, [http://spain.emc.com/security/security-analytics/security-analytics.htm](http://spain.emc.com/security/security-analytics/security-analytics.htm)
- HP ArcSight Enterprise Security Manager (ESM), [http://www8.hp.com/es/es/software-solutions/arcsight-esm-enterprise-security-management/](http://www8.hp.com/es/es/software-solutions/arcsight-esm-enterprise-security-management/)
- IBM Security QRadar SIEM, [http://www-03.ibm.com/software/products/es/qradar-siem](http://www-03.ibm.com/software/products/es/qradar-siem)
- LogRhythm Security Intelligence Platform, [https://logrhythm.com/es/](https://logrhythm.com/es/)
- McAfee Enterprise Security Manager, [http://www.mcafee.com/es/products/enterprise-security-manager.aspx](http://www.mcafee.com/es/products/enterprise-security-manager.aspx)
- SolarWinds Log & Event Manager, [http://www.solarwinds.com/log-event-manager](http://www.solarwinds.com/log-event-manager)
- Splunk Enterprise, [https://www.splunk.com/en_us/products/splunk-enterprise.html](https://www.splunk.com/en_us/products/splunk-enterprise.html)
- Lookwise Enterprise Manager, [http://www.lookwisesolutions.com/index.php/es/productos/lookwise-enterprise-manager](http://www.lookwisesolutions.com/index.php/es/productos/lookwise-enterprise-manager)
- Graylog 2, [https://www.graylog.org/](https://www.graylog.org/)
- LOGanalize, [http://loganalyzer.adiscon.com/](http://loganalyzer.adiscon.com/)

## **Herramientas SIEM**

### **Snorby**

Snorby es un interfaz para la monitorizaci√≥n de alertas basado en Ruby20. La ventaja clave es la flexibilidad, es decir, se puede configurar la interfaz para que acepte eventos provenientes de diferentes aplicaciones, siendo solo necesario a√±adir determinados c√≥digos. Snorby se utiliza para supervisar la seguridad de red gracias a la incorporaci√≥n de eventos de IDS/IPS como Snort o Suricata.

![Snorby](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/snorby.png?raw=true)

Mediante la captura de paquetes (CapME21) proporcionados por Snorby, se puede hacer un filtrado con las caracter√≠sticas que se deseen, por ejemplo seleccionar direcci√≥n del equipo y destino, el protocolo de transmisi√≥n, la fecha y hora en la que queremos buscar en la base de datos para obtener todos los eventos relacionados. De esta forma, se simplifica la b√∫squeda y permite centrar el an√°lisis en los eventos necesarios.

### **Sguil**

La herramienta Sguil est√° construida por y para los analistas de seguridad de red. El principal componente de Sguil es una interfaz gr√°fica de usuario que proporciona acceso a los eventos en tiempo real, datos de sesi√≥n, y capturas de paquetes. Sguil facilita el seguimiento y an√°lisis de eventos en la red. El cliente Sguil se puede ejecutar en multitud de sistemas operativos, incluyendo Linux, BSD, Solaris, MacOS y Windows.

![Sguil](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sguil.png?raw=true)

Sguil proporciona visibilidad sobre los datos de evento recogidos y el contexto para validar la detecci√≥n. Proporciona una √∫nica interfaz gr√°fica de usuario, en cual, se ven las alertas de Snort o Suricata, alertas OSSEC, eventos HTTP Bro, y las alertas del sistema de detecci√≥n pasivo de activos en tiempo real (PRADS23).

M√°s importante a√∫n, Sguil permite ver todo el tr√°fico asociado a una alerta, consultar todos los paquetes capturados, y tambi√©n el tr√°fico que no tiene porqu√© pertenecer a esa alerta, pero podr√≠a estar asociado con la actividad maliciosa o no deseada.

Sguil se diferencia de otras interfaces de alerta en que permite la colaboraci√≥n entre los analistas permitiendo comentar las alertas.

![Sguil1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sguil1.png?raw=true)

### **Squert**

Squert es una aplicaci√≥n web que se utiliza para consultar y ver eventos de datos almacenados en una base de datos Sguil (por lo general son breves datos de alerta). Squert es una herramienta visual que intenta proporcionar informaci√≥n adicional a los eventos a trav√©s del uso de metadatos, representaciones de series de tiempo, ponderaciones y conjuntos de resultados agrupados de forma l√≥gica.

![Squert](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/squert.png?raw=true)

La herramienta para b√∫squeda y almacenado de logs de empresa (ELSA - Enterprise Log Search and Archive) es un analizador de eventos que opera en tres niveles: receptor de log, base de datos o almacenador e interfaz web para syslog entrantes. Aprovecha un analizador basado en una base de patrones para la normalizaci√≥n de eventos y usa el motor de b√∫squeda Sphinx26 para la indexaci√≥n de texto completo para realizar la b√∫squeda de eventos.

ELSA permite realizar una exploraci√≥n que puede estar escalada en los diferentes nodos que tenga un sistema distribuido. El proceso de normalizaci√≥n asigna a cada usuario entrante un identificador seg√∫n la clase de usuario. Los usuarios pueden conceder permisos (listas blancas) granulares para un host o programa, es decir, un usuario puede limitarse a uno o varios hosts pero es capaz de consultar cualquier programa o clase en estos equipos. ELSA se divide en tres componentes principales: los nodos finales, el DAEMON27 (proceso demonio) que se ejecuta en el servidor web, y el propio sitio Web. Los nodos no tienen conocimiento de la interfaz web y responden a cualquier petici√≥n a su puerto de escucha.

![Squert1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/squert1.png?raw=true)

ELSA permite realizar b√∫squedas de logs igual que si fuera un navegador web, tan solo insertar un espacio de tiempo para realizar un filtrado de todos los logs e indicar un filtro ya predefinido para realizar la b√∫squeda.

**ELSA en redes industriales:** Los filtros configurados en ELSA no permiten hacer filtrado de protocolos industriales por defecto. Los protocolos industriales no son reconocidos, pero como se ve en el apartado que trata el IDS Snort, la implementaci√≥n de las reglas Quickdraw permite reconocer y filtrar por ejemplo, el puerto 502 o por protocolo ModBus, sin que se encuentre como filtro por defecto.

### **SPLUNK**

Splunk es un sistema que permite la correlaci√≥n de eventos y la incorporaci√≥n de los datos de campo e informes para sguil, Bro IDS y OSSEC, e incluye varios cuadros de mando e interfaz de b√∫squeda para correlar eventos. Proporciona una plataforma altamente escalable para los datos generados por todos los dispositivos de los sistemas de control, sensores, sistemas SCADA, redes, aplicaciones y usuarios finales conectados a estas redes industriales. Splunk eleva la eficiencia operativa por medio de:

- La integraci√≥n y agregaci√≥n de datos a trav√©s de tecnolog√≠a operativa.
- Busca, explora y correlaciona a trav√©s de m√∫ltiples fuentes para diagnosticar r√°pidamente los problemas operativos m√°s costosos.
- Aprovecha la anal√≠tica avanzada, proporcionando la capacidad de detectar patrones, tendencias y anomal√≠as
- Entrega r√°pidamente valores a trav√©s de modelos de implementaci√≥n flexibles.

![SPLUNK](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk.png?raw=true)

### **Security Onion**

Security Onion es una distribuci√≥n de Linux para la detecci√≥n de intrusiones sobre la que se basa este estudio con el fin de controlar la seguridad de la red y de gestionar los eventos. Creada por Doug Burks, esta distribuci√≥n ha sido la elegida por tener como objetivo la monitorizaci√≥n de anomal√≠as y detecci√≥n de problemas de seguridad, dada la cantidad de las herramientas libres (Snort, Suricata, Bro, Sguil, Squert, Snorby, ELSA, Xplico, Network Miner, etc.) incluidas en la misma y sin obviar su f√°cil instalaci√≥n y puesta en marcha

![Security Onion1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/security-onion1.png?raw=true)

La idea de Doug Burks es crear un Gestor de Seguridad de Red NSM (Network Security Manager) por medio de la compilaci√≥n de varios programas libres, creando como un conjunto de seguridad de f√°cil instalaci√≥n. Las caracter√≠sticas de Security Onion favorecen su actuaci√≥n en redes industriales, primero por el bajo coste de la soluci√≥n, y despu√©s por la capacidad de introducir reglas definidas en Snort para monitorizar los protocolos industriales.

**Componentes Principales**

Security Onion se compone fundamentalmente de tres funcionalidades b√°sicas:

- Captura de paquetes
- Sistemas de detecci√≥n de intrusiones basado en host y basado en la red y (HIDS y NIDS)
- Herramientas de an√°lisis con gran capacidad y potencia

La captura de paquetes completa se logra a trav√©s netsniff-ng, wireshark y otros programas que poseen el mismo objetivo, capturando todo el tr√°fico de los sensores definidos en Security Onion. La informaci√≥n capturada permite identificar no s√≥lo de d√≥nde o ad√≥nde van los paquetes, sino tambi√©n d√≥nde han sido almacenados (esto permite explotar payloads, correos electr√≥nicos de phishing, exfiltraci√≥n de archivos). Los HIDS y NIDS analizan el tr√°fico que pasa por el host y la red y proporcionan datos de alerta, registro de eventos y actividades detectadas. Security Onion ofrece m√∫ltiples opciones de IDS:

1. **NIDS: Security Onion dispone de Snort y Suricata.**
- **An√°lisis guiado por NIDS:** Para la detecci√≥n de intrusiones de red impulsada por el an√°lisis, se incluye Bro.
- **HIDS:** Security Onion ofrece OSSEC.

**Visi√≥n de conjunto**

Una Gesti√≥n de Seguridad de Red (NSM) se refiere a la monitorizaci√≥n de la red obteniendo los eventos relacionados con la seguridad. Puede ser que sea proactivo, cuando se utiliza para identificar las vulnerabilidades o los certificados SSL que expiran, o podr√≠a ser reactivo, tal como en la respuesta a incidentes y an√°lisis forense de red. Ya sea porque est√© realizando el seguimiento a un adversario o tratando de mantener a raya el malware, un NSM proporciona el contexto, la inteligencia y el conocimiento de la situaci√≥n de la red.

Security Onion proporciona visibilidad en el tr√°fico de la red y el contexto en torno a las alertas y eventos an√≥malos, pero requiere un compromiso hacia el administrador o analista, el cual, deber√° revisar las alertas y supervisar la actividad de la red. Security Onion integra para este cometido las herramientas Sguil, Squert y ELSA.

**Implantaci√≥n**

Security Onion se basa en un modelo cliente-servidor distribuido. Un sensor de Security Onion es el cliente y otro un servidor. Los componentes del servidor y de los sensores se pueden ejecutar en una √∫nica m√°quina f√≠sica o virtual, o m√∫ltiples sensores pueden ser distribuidos a trav√©s de una infraestructura y configurados para informar a un solo servidor designado. Los siguientes son los tres escenarios de implantaci√≥n de Security Onion:

Independiente (Standalone): Una instalaci√≥n independiente consiste en una √∫nica m√°quina f√≠sica o virtual en la que se ejecuta tanto el servidor como los componentes de los sensores y los procesos relacionados. Una instalaci√≥n independiente puede

controlar m√∫ltiples segmentos de red con diferentes interfaces de red para la monitorizaci√≥n. Una instalaci√≥n independiente es el m√©todo m√°s f√°cil y m√°s conveniente para monitorizar una red o redes que son accesibles desde una misma ubicaci√≥n.

**Servidor-Sensor:** Una instalaci√≥n de servidor-sensor consta de una m√°quina que ejecuta el servidor y una o m√°s m√°quinas separadas que ejecutan la detecci√≥n y notifican de nuevo al servidor. Los sensores ejecutan todos los procesos de b√∫squeda y almacenan los paquetes asociados a la captura, alertas IDS y bases de datos para Sguil y ELSA.

El analista se conecta al servidor desde una m√°quina cliente independiente y todas las consultas enviadas al servidor se distribuyen a los sensores apropiados, la informaci√≥n solicitada se env√≠a al cliente. Este modelo reduce el tr√°fico de red, manteniendo la mayor parte de los datos recogidos en los sensores hasta que es solicitado por el cliente. Todo el tr√°fico entre el servidor, los sensores y el cliente est√°n protegidos con t√∫neles cifrados por SSH.

**H√≠brido:** Una instalaci√≥n h√≠brida consiste en una mezcla de las dos arquitecturas presentadas, es una instalaci√≥n independiente que tambi√©n tiene uno o m√°s sensores separados para informar al servidor de la m√°quina independiente.

### **Splunk ¬øPara qu√© se utiliza y c√≥mo funciona?**

Splunk, una plataforma de software de gesti√≥n de eventos e informaci√≥n de seguridad (SIEM) ampliamente reconocida, se ha convertido en una soluci√≥n poderosa en el campo de la seguridad cibern√©tica. Este art√≠culo explora exactamente lo que est√°s buscando. Esta gu√≠a completa puede ayudarle a comprender qu√© es Splunk y para qu√© se utiliza. Ilustraremos sus caracter√≠sticas principales, casos de uso principales y ventajas, y lo compararemos con otras herramientas SIEM. Sin m√°s, respondamos ‚Äúpara qu√© se utiliza Splunk‚Äù en el mundo de la ciberseguridad.

### **¬øQu√© es Splunk?**

En el panorama cibern√©tico actual basado en datos, las organizaciones de todo el mundo se enfrentan a un volumen cada vez mayor de datos procedentes de diversos activos e infraestructuras de red. Para aprovechar el poder de estos datos y permitir la resiliencia cibern√©tica, se necesitan herramientas y tecnolog√≠as que puedan ayudarlos a recopilar, analizar y visualizar los registros y eventos de manera efectiva para detectar y prevenir amenazas a la seguridad cibern√©tica.

Splunk es una potente herramienta SIEM (gesti√≥n de eventos e informaci√≥n de seguridad) que se utiliza ampliamente para resolver este prop√≥sito. Ofrece una plataforma integral para recopilar, analizar y visualizar datos generados por m√°quinas para obtener informaci√≥n valiosa y detectar posibles amenazas a la seguridad. Aunque Splunk generalmente se considera una herramienta SIEM, recientemente se le cambi√≥ el nombre a Plataforma unificada de seguridad y observabilidad y, actualmente, Splunk se ofrece como plataformas Splunk Cloud, Splunk Enterprise y Splunk Observability Cloud.

![Splunk2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk2.png?raw=true)

Descripci√≥n general de Splunk | Fuente de la figura: **[Productos Splunk | Splunk](https://www.splunk.com/en_us/products.html)**

Entonces, ¬øpara qu√© se utiliza Splunk? Splunk est√° dise√±ado para ingerir e indexar grandes vol√∫menes de datos de diversas fuentes, incluidos registros, sensores, dispositivos, aplicaciones y sistemas. Proporciona capacidades de monitoreo, an√°lisis, seguridad y observabilidad en tiempo real, lo que permite a las organizaciones identificar y responder a incidentes de seguridad de manera proactiva.

Una de las caracter√≠sticas clave de Splunk es su capacidad para correlacionar y agregar datos de diferentes fuentes como servidores, firewalls, balanceadores de carga, dispositivos de red, etc., lo que permite a los analistas de seguridad investigar e identificar patrones, anomal√≠as y amenazas potenciales. Sus funcionalidades avanzadas de b√∫squeda y consulta permiten a los usuarios realizar b√∫squedas complejas y crear informes y paneles personalizados.

![Splunk3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk3.png?raw=true)

Panel de control

Splunk tambi√©n ofrece una amplia gama de aplicaciones y complementos espec√≠ficos de seguridad que brindan funcionalidad adicional y ayudan a automatizar diversas tareas de seguridad. Estos incluyen inteligencia sobre amenazas, respuesta a incidentes, monitoreo de cumplimiento, observabilidad y an√°lisis del comportamiento del usuario, entre otros.

Al analizar y visualizar datos en tiempo real, Splunk ayuda a las organizaciones a mejorar su postura de seguridad al identificar y mitigar vulnerabilidades, detectar y responder a incidentes de seguridad y garantizar el cumplimiento de las regulaciones y mejores pr√°cticas de la industria.

Adem√°s de sus aplicaciones de seguridad, Splunk tambi√©n se utiliza ampliamente para otros fines, como la supervisi√≥n de operaciones de TI, la supervisi√≥n del rendimiento de las aplicaciones, el an√°lisis empresarial y la gesti√≥n de registros. Su versatilidad y escalabilidad lo convierten en una opci√≥n popular para organizaciones de todos los tama√±os y en diversas industrias.

### **¬øC√≥mo funciona Splunk?**

La arquitectura de Splunk consta de varios componentes que trabajan juntos para permitir la ingesta, indexaci√≥n, b√∫squeda y visualizaci√≥n de datos. A continuaci√≥n se muestra un diagrama t√≠pico de la arquitectura Splunk y los componentes clave correspondientes de la arquitectura Splunk:

![Splunk4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk4.png?raw=true)

## Arquitectura Splunk

**1. Transportistas:**

- **Universal Forwarder** : un componente liviano instalado en fuentes de datos para recopilar y reenviar datos al indexador de Splunk. Tiene requisitos m√≠nimos de recursos y es adecuado para fuentes de datos de gran volumen.
- **Heavy Forwarder** : una versi√≥n con m√°s funciones del reenviador universal que permite el preprocesamiento de datos antes de la indexaci√≥n. Es adecuado para entornos que requieren manipulaci√≥n de datos adicional.

**2. Equilibrador de carga (LB):**

Un equilibrador de carga en Splunk ayuda a distribuir el tr√°fico de red entrante de manera uniforme entre m√∫ltiples instancias o servidores de Splunk. Act√∫a como mediador entre los clientes y las instancias backend de Splunk, asegurando que la carga de trabajo se distribuya uniformemente y se administre de manera eficiente.

**3. Recopilador de eventos HTTP (HEC):**

Permite el env√≠o de eventos a Splunk a trav√©s de HTTP. Permite que fuentes externas env√≠en datos a Splunk para su indexaci√≥n y an√°lisis.

**4. Indexador:**

- **Cl√∫ster de indexadores** : se pueden configurar varios indexadores en un cl√∫ster para garantizar una alta disponibilidad y tolerancia a fallos. Los indexadores reciben datos de los reenviadores, los indexan y los hacen aptos para b√∫squedas.

**5. Cabezal de b√∫squeda:**

- **Grupo de cabezales de b√∫squeda** : el cabezal de b√∫squeda es responsable de manejar las solicitudes de b√∫squeda y presentar los resultados. Se puede configurar un grupo de cabezales de b√∫squeda para equilibrio de carga y redundancia.
- **Agrupaci√≥n de cabezales de b√∫squeda** : distribuye las solicitudes de b√∫squeda entre un grupo de cabezales de b√∫squeda, optimizando el rendimiento y proporcionando tolerancia a fallos.

**6. M√≥dulos de implementaci√≥n:**

- **Servidor de implementaci√≥n** : gestiona las configuraciones de los reenviadores, garantizando la coherencia en todo el entorno. Simplifica el proceso de implementaci√≥n y administraci√≥n de componentes de Splunk.
- **Administrador de implementaci√≥n** : facilita la gesti√≥n de configuraciones en m√∫ltiples instancias de Splunk. Garantiza la coherencia y simplifica el proceso de implementaci√≥n.

**7. Licencia Maestra:**

Gestiona licencias para todos los componentes de Splunk en el entorno. Garantiza que el uso cumpla con los acuerdos de licencia.

**8. Consola de monitoreo:**

Proporciona una interfaz centralizada para monitorear el estado y el rendimiento de la implementaci√≥n de Splunk. Ayuda a los administradores a rastrear el estado de los componentes y solucionar problemas.

**9. Entradas de datos:**

Varios mecanismos para ingerir datos en Splunk, incluida la supervisi√≥n de archivos, entradas con secuencias de comandos, entradas modulares con secuencias de comandos y varias entradas basadas en protocolos.

## **Caracter√≠sticas principales de Splunk**

Splunk es una potente plataforma de software SIEM que ofrece una amplia gama de funciones que ayudan a las empresas a obtener informaci√≥n valiosa de sus datos y garantizar la resiliencia cibern√©tica.

- **Enormes cantidades de recopilaci√≥n e ingesta de datos**

Splunk se destaca en la recopilaci√≥n e ingesta de diversas fuentes de datos cruciales para la seguridad cibern√©tica. Su versatilidad, desde registros hasta eventos y m√©tricas, garantiza una cobertura integral, lo que permite la detecci√≥n de amenazas en tiempo real.

- **Indexaci√≥n ultrarr√°pida en tiempo real**

El coraz√≥n de las capacidades SIEM de Splunk reside en la indexaci√≥n en tiempo real. La visibilidad inmediata de los eventos de seguridad permite respuestas r√°pidas, minimizando el impacto de los incidentes cibern√©ticos.

- **Potente b√∫squeda e investigaci√≥n anal√≠tica**

En el √°mbito de la ciberseguridad, las investigaciones r√°pidas y precisas son esenciales. Las funciones de b√∫squeda e investigaci√≥n de Splunk, impulsadas por Splunk Query Language (SPL), permiten a **los profesionales de la seguridad**¬† identificar y analizar amenazas de forma r√°pida y precisa.

- **Paneles y visualizaciones de datos atractivos**

Las intuitivas herramientas de visualizaci√≥n de datos de Splunk desempe√±an un papel fundamental en la seguridad cibern√©tica. Los paneles interactivos facilitan el monitoreo de m√©tricas de seguridad, panoramas de amenazas y tendencias de incidentes de un vistazo.

- **Alertas y notificaciones en tiempo real**

La proactividad es clave en la ciberseguridad. Splunk permite la creaci√≥n de alertas y notificaciones, lo que garantiza que los equipos de seguridad est√©n informados r√°pidamente sobre posibles amenazas o actividades an√≥malas.

- **Casos de uso principales de Splunk**

La aplicaci√≥n de Splunk abarca varias √°reas cr√≠ticas. A medida que nos embarcamos en esta exploraci√≥n, descubriremos c√≥mo la versatilidad de Splunk aborda desaf√≠os operativos cr√≠ticos en varios dominios, convirti√©ndolo en una piedra angular para las organizaciones que buscan soluciones integrales de TI, seguridad e inteligencia empresarial.

![Splunk5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk5.png?raw=true)

## **Gesti√≥n de Operaciones de TI**

En el √°mbito de la seguridad cibern√©tica, la gesti√≥n de operaciones de TI es sin√≥nimo de detecci√≥n de amenazas, **respuesta a incidentes** e integridad del sistema. El papel de Splunk se extiende m√°s all√° de las operaciones de TI, garantizando una postura de seguridad integral.

- **Seguridad y cumplimiento (SIEM)**

Como herramienta SIEM, Splunk destaca en el monitoreo de seguridad, detecci√≥n de amenazas y gesti√≥n de cumplimiento en tiempo real. Ayuda a las organizaciones a **adelantarse a las amenazas cibern√©ticas**¬† y a cumplir los requisitos reglamentarios.

- **Monitoreo del rendimiento de aplicaciones (APM)**

Las aplicaciones son objetivos principales de los ciberataques. Las capacidades de APM de Splunk mejoran la seguridad cibern√©tica al monitorear el rendimiento de las aplicaciones, detectar anomal√≠as y mitigar posibles riesgos de seguridad.

- **Inteligencia y an√°lisis de negocios**

La aplicaci√≥n de Splunk en ciberseguridad se extiende a la inteligencia empresarial. Al obtener informaci√≥n de los datos de seguridad, las organizaciones pueden tomar decisiones informadas, garantizando una estrategia proactiva de ciberseguridad.

## **Ventajas de usar Splunk**

Splunk se erige como la opci√≥n primordial en el √°mbito de la seguridad cibern√©tica y el an√°lisis de datos, y ofrece una soluci√≥n integral que eclipsa a sus competidores. A trav√©s de una exploraci√≥n meticulosa de sus caracter√≠sticas principales, casos de uso principales y ventajas, resulta evidente que las s√≥lidas capacidades de Splunk permiten a las organizaciones navegar por el intrincado panorama de la seguridad cibern√©tica y obtener informaci√≥n √∫til a partir de sus datos. La adopci√≥n de Splunk en ciberseguridad se basa en varias ventajas:

- **Escalabilidad y flexibilidad**

Los panoramas de seguridad cibern√©tica son din√°micos y diversos. La escalabilidad de Splunk garantiza que pueda adaptarse a las cambiantes necesidades de seguridad y datos de las organizaciones, desde nuevas empresas hasta grandes empresas.

- **Velocidad y eficiencia en la detecci√≥n de amenazas**

Las capacidades de b√∫squeda e indexaci√≥n en tiempo real posicionan a Splunk como un defensor de primera l√≠nea. Su velocidad y eficiencia en el procesamiento de datos permiten una r√°pida detecci√≥n y respuesta a amenazas, minimizando el tiempo de permanencia. Splunk Query Language (SPL) proporciona una forma potente y flexible de consultar y analizar datos, lo que permite b√∫squedas m√°s sofisticadas en comparaci√≥n con otras plataformas.

- **Capacidades de aprendizaje autom√°tico**

Splunk incorpora aprendizaje autom√°tico para an√°lisis avanzados y detecci√≥n de anomal√≠as, mejorando sus capacidades para la detecci√≥n proactiva de amenazas.

- **Interfaz de usuario intuitiva y capacidades de visualizaci√≥n**

En el entorno de alto riesgo de la ciberseguridad, la simplicidad es poderosa. La interfaz f√°cil de usar de Splunk y sus s√≥lidas capacidades de visualizaci√≥n brindan a los profesionales de la seguridad informaci√≥n √∫til.

- **Integraci√≥n perfecta en la nube**

Splunk se integra perfectamente con entornos de nube y ofrece soporte nativo en la nube, brindando flexibilidad y escalabilidad a las organizaciones que adoptan tecnolog√≠as de nube.

- **Comunidad y mercado: Splunkbase**

La comunidad Splunk y Splunkbase, su mercado de aplicaciones y complementos, amplifican sus capacidades de seguridad cibern√©tica. La innovaci√≥n colaborativa garantiza una amplia gama de herramientas y recursos para reforzar las defensas de seguridad cibern√©tica.

## **Comparaci√≥n de Splunk con otras herramientas de an√°lisis de datos**

La destreza en ciberseguridad y an√°lisis de datos de Splunk se destaca a√∫n m√°s a trav√©s de una comparaci√≥n integral con otras soluciones l√≠deres. Aqu√≠, comparamos Splunk con otras herramientas l√≠deres y brindamos informaci√≥n detallada sobre sus caracter√≠sticas, fortalezas y ofertas √∫nicas:

### **Splunk frente a ELK (Elasticsearch, Logstash, Kibana)**

- **Costo** : ELK es de c√≥digo abierto, lo que lo hace rentable. Splunk ofrece versiones gratuitas, pero las soluciones empresariales tienen tarifas de licencia.
- **Facilidad de uso** : Splunk tiene una interfaz y un lenguaje de b√∫squeda (SPL) m√°s f√°ciles de usar. ELK, al ser de c√≥digo abierto, puede requerir m√°s experiencia t√©cnica.
- **Escalabilidad** : Ambos son escalables, pero Splunk ofrece soporte comercial para necesidades exigentes de ciberseguridad.
- **Comunidad y ecosistema** : ELK obtiene la mayor parte de su apoyo de una gran comunidad de c√≥digo abierto. Splunk tiene su comunidad y su mercado Splunkbase.

### **Splunk contra Datadog**

- **Enfoque** : Datadog enfatiza el monitoreo de infraestructura y aplicaciones. La versatilidad de Splunk se extiende a casos de uso de ciberseguridad m√°s amplios.
- **Facilidad de uso** : Datadog ofrece una interfaz f√°cil de usar. Es posible que Splunk requiera m√°s configuraci√≥n para casos de uso de seguridad cibern√©tica espec√≠ficos.
- **Precios** : Datadog sigue un modelo basado en suscripci√≥n. El precio de Splunk var√≠a seg√∫n el volumen de datos y las necesidades de implementaci√≥n de seguridad cibern√©tica.

### **Splunk versus nueva reliquia**

- **Enfoque** : New Relic se especializa en APM. La versatilidad de Splunk lo hace adecuado para un espectro m√°s amplio de ciberseguridad y an√°lisis de datos.
- **Precios** : New Relic sigue un modelo de suscripci√≥n. El precio de Splunk var√≠a seg√∫n las necesidades de seguridad cibern√©tica y los vol√∫menes de datos.
- **Versatilidad** : la adaptabilidad de Splunk lo convierte en una mejor opci√≥n para organizaciones con diversos requisitos de seguridad cibern√©tica.

### **Splunk frente a IBM Qradar**

- **Enfoque** : Splunk ofrece un enfoque m√°s amplio en an√°lisis de datos y seguridad cibern√©tica. IBM QRadar se especializa en gesti√≥n de eventos e informaci√≥n de seguridad (SIEM).
- **Facilidad de uso** : Splunk es conocido por su interfaz intuitiva. IBM QRadar puede tener una curva de aprendizaje m√°s pronunciada.
- **Escalabilidad** : Ambos son escalables, pero el soporte comercial de Splunk mejora la escalabilidad para entornos de ciberseguridad exigentes.
- **Comunidad y ecosistema** : la comunidad activa de Splunk y Splunkbase Marketplace proporcionan un ecosistema s√≥lido. IBM QRadar tambi√©n tiene una comunidad, pero puede tener menos recursos impulsados ‚Äã‚Äãpor la comunidad.

### **Splunk frente a ArcSight**

- **Enfoque** : Splunk ofrece un enfoque m√°s amplio en an√°lisis de datos y seguridad cibern√©tica. ArcSight se especializa en gesti√≥n de eventos e informaci√≥n de seguridad (SIEM).
- **Facilidad de uso** : Splunk es conocido por su interfaz intuitiva. ArcSight puede tener una curva de aprendizaje m√°s pronunciada.
- **Escalabilidad** : Ambos son escalables, pero el soporte comercial de Splunk mejora la escalabilidad para entornos de ciberseguridad exigentes.
- **Comunidad y ecosistema** : la comunidad activa de Splunk y Splunkbase Marketplace proporcionan un ecosistema s√≥lido. ArcSight tambi√©n tiene una comunidad, pero es posible que tenga menos recursos impulsados ‚Äã‚Äãpor la comunidad.

<aside>
üëâ A pesar de la dura competencia en su industria, Splunk es un l√≠der indiscutible con una gran base de clientes e innovaciones de vanguardia. El compromiso de Splunk con la innovaci√≥n y la mejora continua le ha ayudado a mantener su posici√≥n de liderazgo. La empresa actualiza peri√≥dicamente su plataforma, introduciendo nuevas caracter√≠sticas y funcionalidades que satisfacen las necesidades cambiantes de sus clientes.
</aside>

### **Conclusi√≥n**

A medida que el panorama de las ciberamenazas contin√∫a evolucionando, la necesidad de una soluci√≥n SIEM potente y flexible se vuelve cada vez m√°s crucial. Las capacidades de aprendizaje autom√°tico, la indexaci√≥n en tiempo real y el ecosistema integral de Splunk contribuyen a su reputaci√≥n como l√≠der en el campo.

### **Preguntas frecuentes**

- **¬øPara qu√© se utiliza Splunk?**

Ya sea desentra√±ando incidentes de seguridad complejos o desbloqueando conocimientos a partir de datos generados por m√°quinas, Splunk permanece a la vanguardia, capacitando a las organizaciones para convertir los datos en acciones decisivas.

- **¬øQu√© detecta Splunk?**

Splunk se destaca en la detecci√≥n de una amplia gama de amenazas a la seguridad cibern√©tica, que incluyen, entre otras, **malware** , **ataques de phishing** , acceso no autorizado y comportamiento an√≥malo. Sus s√≥lidas capacidades **de detecci√≥n** , an√°lisis y alerta de amenazas permiten a los equipos de seguridad identificar y responder a las amenazas cibern√©ticas en tiempo real.

- **¬øPor qu√© es m√°s conocido Splunk?**

Aunque Splunk realiza una variedad de casos de uso y aplicaciones pr√°cticas, es mejor conocido por sus dos aplicaciones principales: una herramienta de an√°lisis de datos y una gesti√≥n de eventos e informaci√≥n de seguridad (SIEM).

- **¬øQui√©n es el mayor competidor de Splunk?**

ELK, Datadog e IBM Qradar.

# IDS

**IDS** (*Intrusion Detection System*) el sistema de detecci√≥n de intrusiones consiste en un conjunto de m√©todos y t√©cnicas para revelar actividad sospechosa sobre un recurso o recursos inform√°ticos. Es decir, eventos que sugieran un comportamiento an√≥malo, incorrecto o inapropiado sobre un sistema.

Un sistema de detecci√≥n de intrusiones¬† puede ser descrito como un proceso de detecci√≥n y monitorizaci√≥n de eventos que suceden en una red. Este sistema escucha y analiza toda la informaci√≥n que circula por una red, permite ayudar a entender los ataques, estimar los da√±os causados y tratar de prevenir otros ataques. Para detectar intrusiones en un sistema, los IDS utilizan tres tipos de informaci√≥n: un hist√≥rico de eventos, la configuraci√≥n actual del sistema y, finalmente, procesos activos del sistema o reglas.

![Splunk5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk5.png?raw=true)

### **¬øEn qu√© consiste un IDS y c√≥mo funciona?**

Hemos de partir de la base que aunque tengamos el cortafuegos habilitado, por normal general, tendremos muchos puertos abiertos, como por ejemplo el 80 y el 443 para las aplicaciones web. Por lo que debemos tener un sistema adicional que nos ayude a controlar estas puertas abiertas. Por lo que para llevar un mayor control debemos de utilizar un sistema IDS, esto es, un sistema de detecci√≥n de intrusos y tambi√©n de vulnerabilidades. Existen los IDS activos y los pasivos. Con los primeros se genera entradas en el registro y se generan alertas. Con los segundos en cambio, adem√°s de realizar las mismas funciones que con el pasivo, tambi√©n se generar√≠an acciones, como bloquear direcciones IP o cerrar el acceso a puertos restringidos.

Adem√°s desde el punto de vista del programaci√≥n (*software*) existen diferentes tipos de herramienta, los sistemas de detecci√≥n de intrusos (HIDS), sistemas de detecci√≥n de intrusos en red (IDPS), los sistemas de detecci√≥n de intrusos basados en firmas (SIDS) y por √∫ltimo los sistemas de detecci√≥n de intrusos basados en anomal√≠as.

![Splunk6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk6.png?raw=true)

Los sistemas IDS utilizan tres m√©todos para detectar el tr√°fico. Estos son la detecci√≥n de anomal√≠as, el an√°lisis de protocolos y el an√°lisis de firmas.

- Con la detecci√≥n de anomal√≠as tenemos como objetivo detectar un comportamiento anormal. Ejemplo de ello ser√≠a un volumen de tr√°fico ICMP (el que usa ping) inusual y muy elevado, que nos indicar√≠a que somos el blanco o el emisor de un ataque de DDoS (Denegaci√≥n de servicio)
- Respecto al an√°lisis de protocolos se busca un tr√°fico de aplicaci√≥n que no cumple el est√°ndar del protocolo habitual.
- Por √∫ltimo, el an√°lisis de firmas permite identificar ataques o comportamientos perjudiciales ya publicados. Suele ser la t√©cnica m√°s eficaz y la que no est√° sujeta a errores, ya que s√≥lo se generan ataques o intrusiones que ya han tenido √©xito en otro lugar, por lo que, pueden ser f√°cilmente identificados.

<aside>
‚ö†Ô∏è Es importante que nuestro IDS actualice la informaci√≥n de forma habitual,¬† para as√≠ tener actualizadas siempre sus t√©cnicas de an√°lisis as√≠ como de las bases de datos de firmas.
</aside>

Existen una serie de organizaciones, asociaciones y empresas que nos permiten estar al corriente de las evoluciones en materia de t√©cnicas de intrusi√≥n y ataques. Las principales son:

- Bugtraq: Es una lista de difusi√≥n dedicada a la publicaci√≥n de vulnerabilidades, su uso y correcci√≥n. ([https://www.securityfocus.com/](https://www.securityfocus.com/))
- CERT: *Computer Emergency Response Team*. Se trata de una organizaci√≥n que estudia las vulnerabilidades, investiga las evaluaciones en t√©rminos de redes y seguridad y ofrece servicios relacionados con la seguridad. ([Entrada de Wikipedia al respecto](https://es.wikipedia.org/wiki/Equipo_de_Respuesta_ante_Emergencias_Inform%C3%A1ticas))
- CIAC: Computer Incident Advisory Capability. Una organizaci√≥n de alerta e investigaci√≥n gestionado por el departament de energ√≠a de Estados Unidos. ( [https://www.energy.gov/cio/about-our-services/integrated-joint-cybersecurity-coordination-center](https://www.energy.gov/cio/about-our-services/integrated-joint-cybersecurity-coordination-center))

## **Tareas de un IDS**

Un IDS realiza dos tareas fundamentales:

- Prevenci√≥n: se realiza por medio de herramientas que escuchan el tr√°fico en la red o en un ordenador, denominados sensores, e identifican los ataques aplicando reglas, reconocimiento de patrones o t√©cnicas inteligentes.
- Reacci√≥n: trata de detectar patrones de intrusi√≥n en las trazas de los servicios de red o en el comportamiento del sistema.

Existen indicadores estad√≠sticos de sensibilidad, especificidad y precisi√≥n que permiten comprobar la efectividad del IDS, se basan en los siguientes conceptos:

- Verdaderos positivos (TP): Intrusi√≥n existente y correctamente detectada.
- Falsos positivos (FP): Intrusi√≥n no existente e incorrectamente detectada.
- Falsos negativos (FN): Intrusi√≥n existente y no detectada.
- Verdaderos negativos (TN): Intrusi√≥n no existente y no detectada.

### **Tipos de IDS**

Existen distintas clasificaciones de los IDS, seg√∫n sea su enfoque, origen de datos, estructura y comportamiento

![Splunk7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk7.png?raw=true)

## **En funci√≥n del enfoque**

Se presentan dos grupos: Los sistemas de detecci√≥n de usos indebidos, que comparan las firmas con la informaci√≥n recogida; y los de detecci√≥n de anomal√≠as, que usan t√©cnicas estad√≠sticas para distinguir el comportamiento usual del anormal.

1. **Detecci√≥n de anomal√≠as:** Es necesario definir cu√°l es el comportamiento normal de un sistema por medio de un aprendizaje de actividades, para clasificar los comportamientos que se desv√≠en de lo normal como sospechosos. Estos sistemas son propensos a dar falsos positivos, que son producidos cuando se dispara una alerta con actividad normal. Tienen la desventaja de que depende de la calidad del proceso de aprendizaje. Existen tres t√©cnicas diferentes para realizar la detecci√≥n de anomal√≠as en un sistema:
- **Sistemas basados en conocimiento:** Representa el inicio en los IDS, y se basa en las violaciones de seguridad detectadas mediante el uso de reglas. Resultan m√°s fiables y proporcionan mejores rendimientos frente a ataques conocidos, con el inconveniente de su baja capacidad para detectar nuevos ataques no incluidos en la base de datos de firmas.
- **Sistemas basados en m√©todos estad√≠sticos**: Basado en perfiles de actividad que vienen definidos por el comportamiento del usuario, con respecto a ficheros, programas, registros, etc. Se realiza mediante el establecimiento de m√©tricas y modelos estad√≠sticos.
- **Sistemas basados en aprendizaje autom√°tico:** Son los m√°s desarrollados para el modelado de comportamientos normales y buscan mejorar los resultados en cuanto a detecci√≥n, reducci√≥n de falsos positivos y tiempo de computaci√≥n. Una ventaja reside en recoger las caracter√≠sticas de un ataque y a√±adirlo a una base de datos como firmas nuevas, permitiendo actualizar la base de firmas en un breve lapso de tiempo.
1. **Detecci√≥n de usos incorrectos (detecci√≥n por firma/regla):** Los sistemas de detecci√≥n basados en uso indebido monitorizan las actividades que ocurren en un sistema y las compara con una base de datos de firmas de ataques. Cuando se encuentra una actividad que coincide con una de estas firmas, se genera una alarma. Presentan una facilidad de adaptaci√≥n ya que basta con actualizar la base de datos, ya sea, escribiendo la nueva regla u obteni√©ndose de un tercero.
- **Sistemas Expertos:** Conocimiento codificado mediante reglas de implicaci√≥n (condici√≥n-acci√≥n), si se cumplen todas las condiciones se aplica la acci√≥n o regla. Presenta la desventaja de que las reglas no son secuenciales, lo que dificulta aislar pasos de intrusiones en el tiempo.
- **Detecci√≥n de firmas:** Realiza comparaciones entre los eventos que ocurren en el sistema y las firmas almacenadas en la base de datos en busca de similitudes.
- **An√°lisis de transacci√≥n de estados:** Los ataques se representan como una secuencia de transiciones (m√°quina de estados finitos). Cuando se alcanza un estado considerado como intrusi√≥n se lanza una alarma.
1. **H√≠bridos:** Los IDS basados en firmas resultan m√°s fiables y proporcionan mejores rendimientos frente a ataques conocidos, pero presentan una deficiencia ante nuevos ataques. Los IDS basados en anomal√≠as presentan la capacidad de detectar ataques desconocidos, pero su rendimiento es inferior. Los sistemas h√≠bridos ser√°n una mezcla de ambos, y por lo tanto, pueden ajustarse para operar como ambos tipos de detectores, mejorando la funcionalidad, la detecci√≥n de ataques y la mejora de rendimiento.

## **En funci√≥n del origen de los datos**

Se encuentran tres tipos de IDS atendiendo a las fuentes de informaci√≥n que se utilicen:

**HIDS (*Host-based Intrusion Detection Systems*):** Los IDS basados en el host solo procesan informaci√≥n de las actividades de los usuarios y servicios en una m√°quina determinada. Permite monitorizar los datos generados por un usuario, mediante el uso de *syslog1*, e identificar amenazas e intrusiones a nivel de host. Una desventaja proviene del requerimiento de confianza en el sistema, que puede estar infectado anteriormente a la instalaci√≥n, y lo hace vulnerable ante ataques directos.

**NIDS (*Network Intrusion Detection Systems*):** Los NIDS son instalados en un dispositivo en modo promiscuo, realizan una escucha pasiva sobre la red de forma que no interfieren en su uso, analizando el tr√°fico en tiempo real, pero por contra, resultan in√∫tiles ante ataques locales. Los nuevos sistemas, basados en agentes inteligentes, permiten una detecci√≥n de nuevos ataques usando el concepto de centinelas, que supervisan el sistema para recoger toda la informaci√≥n necesaria para la detecci√≥n.

![Splunk8](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk8.png?raw=true)

**IDS H√≠bridos:** Los sistemas h√≠bridos recogen lo mejor de ambos tipos HIDS y NIDS. Permiten una detecci√≥n local de los sistemas y un sensor en cada segmento de red se encarga de la vigilancia. De esta forma se cubren las necesidades HIDS con las del NIDS, permitiendo el aprovechamiento de las ventajas de ambas arquitecturas.

### **En funci√≥n de su estructura**

**Clasificaci√≥n basada en las estrategias de control**

**Sistema de Detecci√≥n de Intrusi√≥n Distribuido (DIDS):** Se basa en la instalaci√≥n en un sistema distribuido, ubicando sensores repartidos por varios equipos de la red. Estos sensores se comunican con un nodo central donde se recibir√° toda la informaci√≥n y donde se cruzan los datos, lo que nos permitir√° detectar los ataques con fiabilidad y obtener una visi√≥n global mejorando la detecci√≥n de incidentes.

![dids](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/dids.png?raw=true)

**Sistema de Detecci√≥n de Intrusi√≥n Centralizado:** Emplea sensores que transmiten informaci√≥n a un sistema central que realiza el control, permitiendo ahorrar en equipamientos.

![sdi](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sdi.png?raw=true)

### **En funci√≥n de su comportamiento**

Encontramos dos tipos de IDS seg√∫n si realizan la prevenci√≥n escuchando el tr√°fico o si se elabora una respuesta defensiva cuando se detecta un ataque.

**IDS Pasivo:** S√≥lo notifican al administrador de la red pero no act√∫an sobre el ataque. √önicamente procesan la informaci√≥n en busca de intrusiones, y una vez detectada se genera una alerta.

**IDS Activos:** Es un tipo de IDS denominado Sistema de Prevenci√≥n de Intrusi√≥n (IPS). A diferencia de los IDS, esta tecnolog√≠a no se limita a escuchar el tr√°fico de la red y a mandar alertas, sino que permite establecer reglas, como se hace en los cortafuegos, para detener las intrusiones.

## **Suricata vs Snort: una comparaci√≥n y revisi√≥n completas**

Cuando se trata de sistemas de detecci√≥n de intrusiones en la red (NIDS), elegir entre Suricata y Snort es una discusi√≥n constante entre los profesionales de la seguridad cibern√©tica. Estas herramientas de c√≥digo abierto ofrecen funciones avanzadas para monitorear y proteger las redes de amenazas potenciales. Proporcionaremos una comparaci√≥n en profundidad de Suricata y Snort, evaluando sus caracter√≠sticas, funcionalidad, rendimiento, escalabilidad, facilidad de uso, configuraci√≥n y soporte de la comunidad.

Al explorar las distinciones y fortalezas clave de estos dos NIDS, obtendr√° el conocimiento necesario para tomar una decisi√≥n informada sobre qu√© herramienta se alinea mejor con sus necesidades y objetivos espec√≠ficos. Si es nuevo en el campo de la seguridad cibern√©tica o un profesional experimentado que busca ampliar su experiencia, ofrecemos informaci√≥n valiosa y orientaci√≥n pr√°ctica para implementar y administrar Suricata o Snort dentro de su entorno de red. Ahora, profundicemos en el mundo de NIDS y echemos un vistazo cr√≠tico a Suricata vs Snort.

### **¬øQu√© es un sistema de detecci√≥n de intrusiones en la red?**

Un sistema de detecci√≥n de intrusiones en la red (NIDS) es una herramienta de seguridad que monitorea el tr√°fico de la red en busca de actividades maliciosas o violaciones de pol√≠ticas, detectando y alertando a los administradores sobre amenazas potenciales. NIDS analiza el tr√°fico y aplica reglas predefinidas para identificar patrones o comportamientos sospechosos, lo que ayuda a proteger las redes de intentos de intrusi√≥n, malware y otras amenazas cibern√©ticas. Estos sistemas desempe√±an un papel crucial en la protecci√≥n de la infraestructura de red, los datos cr√≠ticos y los recursos de una organizaci√≥n contra los ciberataques.

Al implementar un NIDS, su posicionamiento dentro de la red es crucial para un monitoreo efectivo. Idealmente, el NIDS deber√≠a colocarse en los puntos de entrada y salida de la red, monitoreando todo el tr√°fico entrante y saliente. Esto permite que el sistema detecta y alerta sobre amenazas potenciales antes de que puedan infiltrarse en la red o filtrar datos confidenciales. Adem√°s, colocar dispositivos NIDS en puntos estrat√©gicos dentro de la red puede ayudar a detectar movimientos laterales o amenazas internas, mejorando a√∫n m√°s la postura de seguridad de la organizaci√≥n.

NIDS emplea una variedad de m√©todos para detectar y alertar sobre amenazas potenciales. La detecci√≥n basada en firmas (SIDS) utiliza patrones o firmas predefinidos de amenazas conocidas para identificar actividad maliciosa, mientras que la detecci√≥n basada en anomal√≠as (AIDS) identifica desviaciones del comportamiento normal de la red, que pueden indicar un ataque. Adem√°s, algunas soluciones NIDS ofrecen an√°lisis heur√≠stico, empleando aprendizaje autom√°tico e inteligencia artificial para predecir e identificar nuevas amenazas en funci√≥n de su comportamiento.

### **¬øQu√© son Suricata y Snort?**

Echemos un vistazo de las dos herramientas que comparamos antes de profundizar en sus atributos y funcionalidades √∫nicos.

- **Suricata**

![Suricata](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/suricata.png?raw=true)

Suricata es un sistema de detecci√≥n de intrusiones en la red (NIDS) de c√≥digo abierto desarrollado por la Open Information Security Foundation (OISF). Suricata se puede utilizar como sistema de prevenci√≥n de intrusiones (IPS) y motor de monitoreo de seguridad de red, aunque esto depende en gran medida de su implementaci√≥n dentro de su red. Si est√° basado en host o es pasivo, solo funciona como un IDS, mientras que si se implementa como una soluci√≥n activa en l√≠nea le permite agregar la utilidad IPS. Es conocido por su arquitectura multiproceso de alto rendimiento y su enfoque en proporcionar capacidades avanzadas de detecci√≥n y prevenci√≥n de intrusiones.

Suricata funciona analizando el tr√°fico de la red, aplicando reglas predefinidas para identificar actividades maliciosas y alertando a los administradores sobre posibles amenazas. Lo que distingue a Suricata de otros NIDS es su arquitectura multiproceso, que le permite procesar de manera eficiente m√∫ltiples tareas simult√°neamente. Esto da como resultado un procesamiento de paquetes m√°s r√°pido y un mayor rendimiento en comparaci√≥n con los sistemas de un solo subproceso.

**Descargar Suricata** **[https://suricata.io/download/](https://suricata.io/download/)**

- **Snort**

![Snort](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/snort.png?raw=true)

Snort es un popular sistema de detecci√≥n de intrusiones en la red (NIDS) de c√≥digo abierto, creado por Martin Roesch y mantenido por Cisco Systems. Snort lleva casi una d√©cada m√°s en el mercado y goza de una amplia compatibilidad con varios dispositivos, sistemas operativos y herramientas de terceros. Su enfoque principal es la detecci√≥n basada en reglas y el an√°lisis de protocolos.

Snort funciona monitoreando el tr√°fico de la red y aplicando reglas predefinidas para detectar actividad maliciosa, generando alertas para que los administradores tomen las medidas adecuadas. La fortaleza de Snort radica en su extenso conjunto de reglas, que se pueden personalizar para satisfacer las necesidades de seguridad espec√≠ficas de una organizaci√≥n. Esta adaptabilidad permite **a Snort sobresalir** en diversos entornos, brindando protecci√≥n personalizada contra una amplia gama de amenazas.

**Descargar Snort** **[https://www.snort.org/downloads#snort-downloads](https://www.snort.org/downloads#snort-downloads)**

### **Caracter√≠sticas y funcionalidad**

Al comparar Suricata y Snort, es importante examinar las caracter√≠sticas clave que debe tener un IDS para determinar su efectividad e idoneidad para diferentes entornos. Aqu√≠, profundizaremos en estas caracter√≠sticas principales de ambas herramientas, destacando sus similitudes y diferencias.

![ids2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ids2.png?raw=true)

Suricata sobre Elastic, de [https://elastic.co](https://elastic.co/)

![ids3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ids3.png?raw=true)

Snort con el√°stico (ELK) de [https://blog.snort.org](https://blog.snort.org/)

- **Captura de paquetes**

Tanto Suricata como Snort destacan en la captura de paquetes, lo que les permite monitorear y analizar el tr√°fico de la red en busca de actividad maliciosa. La arquitectura multiproceso de Suricata proporciona una ventaja en la captura de paquetes, permiti√©ndole procesar m√∫ltiples tareas simult√°neamente y ofreciendo un rendimiento mejorado en comparaci√≥n con Snort. Snort, por otro lado, se basa en una arquitectura de un solo subproceso, lo que puede limitar su rendimiento de captura de paquetes en entornos de mucho tr√°fico.

- **An√°lisis de protocolo**

Suricata y Snort proporcionan un an√°lisis de protocolo integral, lo que les permite decodificar y analizar varios protocolos de red para detectar amenazas. Si bien ambos sistemas ofrecen un amplio soporte de protocolo, Suricata tiene la ventaja adicional de **[admitir datos X-Forwarded-For (XFF)](https://redmine.openinfosecfoundation.org/issues/478)** .

- **X-reenviado-para (XFF)**

El encabezado X-Forwarded-For (XFF), **[estandarizado en RFC 7239](https://datatracker.ietf.org/doc/rfc7239/)**¬† como "Extensi√≥n HTTP reenviada", permite a los servidores proxy compartir informaci√≥n sobre el cliente original y otros servidores proxy en una cadena. En pocas palabras, los servidores proxy ubicados entre un host y el destino (como un sitio web) agregar√°n este encabezado para incluir no solo su direcci√≥n IP sino tambi√©n la direcci√≥n del host que inicialmente solicit√≥ la informaci√≥n. Esto puede ser importante a la hora de solucionar problemas o por motivos de seguridad al intentar determinar qui√©n est√° intentando acceder al sitio web. XFF tambi√©n se puede utilizar con otros protocolos de red, como el correo electr√≥nico.

- **Detecci√≥n basada en reglas**

La detecci√≥n basada en reglas es una caracter√≠stica central tanto de Suricata como de Snort, que utiliza reglas predefinidas para identificar actividad maliciosa dentro del tr√°fico de la red. La fortaleza de Snort radica en su extenso conjunto de reglas, que se pueden personalizar para satisfacer necesidades de seguridad espec√≠ficas. Suricata tambi√©n ofrece un conjunto de reglas s√≥lido, con el beneficio adicional de Suricata-Update, una herramienta para administrar y actualizar conjuntos de reglas de manera m√°s eficiente.

- **Arquitectura de subprocesos m√∫ltiples**

La arquitectura multiproceso de Suricata lo distingue de Snort en algunos aspectos, permiti√©ndole procesar m√∫ltiples tareas simult√°neamente y ofreciendo un rendimiento mejorado. Snort se basa en una arquitectura de un solo subproceso, lo que puede limitar su rendimiento en entornos de mucho tr√°fico o cuando se procesan tareas que consumen muchos recursos.

- **Integraci√≥n y compatibilidad**

Si bien tanto Suricata como Snort ofrecen integraci√≥n con herramientas populares de c√≥digo abierto, Snort tiene una trayectoria m√°s extensa en el mercado y disfruta de una amplia compatibilidad con una variedad de dispositivos, sistemas operativos y herramientas de terceros. Suricata, sin embargo, se beneficia de su integraci√≥n con ELK Stack, proporcionando visualizaci√≥n y an√°lisis mejorados del tr√°fico de la red.

### **Resumen**

En resumen, tanto Suricata como Snort ofrecen caracter√≠sticas y funcionalidades s√≥lidas que los convierten en soluciones IDS efectivas. La arquitectura multiproceso de Suricata, la compatibilidad con datos XFF y la gesti√≥n eficiente de reglas con Suricata-Update le otorgan una ventaja competitiva en ciertos aspectos.

Sin embargo, el extenso conjunto de reglas, las opciones de personalizaci√≥n y la amplia compatibilidad de Snort lo convierten en un fuerte contendiente. La elecci√≥n entre Suricata y Snort depende en √∫ltima instancia de sus necesidades espec√≠ficas, entorno de red y requisitos de rendimiento.

| SURICATA | SNORT |
| --- | --- |
| La arquitectura multiproceso permite el procesamiento eficiente de m√∫ltiples tareas simult√°neamente | Arquitectura de un solo subproceso |
| Suricata-Update para gestionar y actualizar conjuntos de reglas | Mayor compatibilidad con dispositivos, sistemas operativos y herramientas de terceros debido a su mayor presencia en el mercado. |
| Capacidades avanzadas de detecci√≥n y prevenci√≥n de intrusiones | Centrarse en la detecci√≥n basada en reglas y el an√°lisis de protocolos |
| Mejor rendimiento en entornos de mucho tr√°fico | Mejor rendimiento en entornos con recursos limitados |
| Admite modos en l√≠nea y pasivo | Admite modos en l√≠nea y pasivo |
- **Rendimiento y escalabilidad**

La pr√≥xima comparaci√≥n entre Suricata y Snort examinar√° su rendimiento y escalabilidad para determinar qu√© NIDS se adapta a diferentes entornos y limitaciones de recursos. Aqu√≠, discutiremos la velocidad, el uso de la memoria y la precisi√≥n tanto de Suricata como de Snort.

- **Velocidad**

Aqu√≠, la arquitectura multiproceso de Suricata le permite procesar m√∫ltiples tareas simult√°neamente, ofreciendo un rendimiento mejorado en comparaci√≥n con la arquitectura de un solo subproceso de Snort. Esta ventaja permite a Suricata manejar mayores vol√∫menes de tr√°fico y proporcionar un procesamiento de paquetes m√°s r√°pido, lo que la convierte en una opci√≥n m√°s adecuada para entornos de mucho tr√°fico. Snort, por otro lado, a√∫n puede ofrecer un rendimiento adecuado en situaciones de tr√°fico moderado. Sin embargo, su arquitectura de subproceso √∫nico puede limitar su velocidad en entornos de mucho tr√°fico o cuando se procesan tareas que consumen muchos recursos.

- **Uso de memoria**

En t√©rminos de uso de memoria, Snort generalmente consume menos recursos en comparaci√≥n con Suricata. Esto hace que Snort sea una mejor opci√≥n para entornos con recursos limitados, como dispositivos de bajo consumo o redes con recursos de hardware limitados. Suricata, aunque normalmente requiere m√°s memoria, a√∫n puede proporcionar un rendimiento razonablemente eficiente debido a su arquitectura multiproceso, que le permite manejar grandes vol√∫menes de tr√°fico de manera m√°s efectiva.

- **Exactitud**

Tanto Suricata como Snort ofrecen altos niveles de precisi√≥n en la detecci√≥n de actividades maliciosas dentro del tr√°fico de la red. Lo logran a trav√©s de conjuntos completos de reglas y capacidades de an√°lisis de protocolos. Sin embargo, el soporte de Suricata para datos X-Forwarded-For (XFF) y su capacidad para descifrar, analizar y luego volver a cifrar r√°pidamente datos de red cuando se colocan detr√°s de un proxy inverso pueden proporcionar una ligera ventaja en la detecci√≥n de amenazas avanzadas.

### **Resumen**

En resumen, la arquitectura multiproceso de Suricata y el uso eficiente de los recursos lo hacen m√°s escalable y adecuado para entornos de alto tr√°fico. Sin embargo, el menor uso de memoria de Snort lo convierte en una mejor opci√≥n para entornos con recursos limitados. La elecci√≥n entre Suricata y Snort depende de las necesidades espec√≠ficas, el entorno de red y las limitaciones de recursos de una organizaci√≥n.

| SURICATA | SNORT |
| --- | --- |
| El uso eficiente de los recursos permite un mejor manejo de grandes vol√∫menes de tr√°fico | El menor uso de recursos lo hace adecuado para entornos con recursos limitados |
| La arquitectura multiproceso proporciona un rendimiento mejorado | La arquitectura de un solo subproceso puede tener limitaciones de rendimiento en entornos de mucho tr√°fico |
| Escalable debido a su uso eficiente de recursos y capacidades de manejo de tr√°fico. | Puede ser menos escalable en comparaci√≥n, especialmente en entornos de mucho tr√°fico. |
- **Facilidad de uso y configuraci√≥n**

A continuaci√≥n, consideraremos la facilidad de uso y configuraci√≥n, ya que estos factores pueden afectar significativamente el tiempo y el esfuerzo necesarios para implementar y administrar una soluci√≥n NIDS. En esta secci√≥n, discutiremos los aspectos de instalaci√≥n, configuraci√≥n y administraci√≥n de reglas de Suricata y Snort, destacando sus diferencias y ventajas.

- **Instalaci√≥n**

Suricata y Snort se pueden instalar con relativa facilidad en varios sistemas operativos, **incluido Kali Linux** . Sin embargo, el proceso de instalaci√≥n de Suricata podr√≠a ser m√°s √°gil, ya que proporciona paquetes predise√±ados para diferentes plataformas, lo que simplifica su instalaci√≥n y configuraci√≥n. Snort, aunque sigue siendo sencillo de instalar, puede requerir pasos y dependencias adicionales para configurarlo, especialmente cuando se integra con herramientas de terceros.

- **Configuraci√≥n**

Configurar Suricata y Snort implica configurar sus respectivos ajustes y conjuntos de reglas. Suricata cuenta con una interfaz web y archivos de configuraci√≥n basados ‚Äã‚Äãen YAML, que pueden simplificar el proceso de configuraci√≥n para usuarios con experiencia limitada en seguridad de red. Este enfoque f√°cil de usar puede facilitar la gesti√≥n y el mantenimiento de Suricata en diversos entornos.

Por otro lado, la configuraci√≥n de Snort se basa en archivos de configuraci√≥n basados ‚Äã‚Äãen texto, lo que podr√≠a requerir m√°s intervenci√≥n manual y una curva de aprendizaje m√°s pronunciada para los reci√©n llegados. Sin embargo, la extensa documentaci√≥n de Snort y el apoyo activo de la comunidad pueden ayudar a los usuarios a superar estos desaf√≠os y configurar efectivamente el sistema para satisfacer sus necesidades.

- **Gesti√≥n de reglas**

La gesti√≥n de reglas es un aspecto crucial de cualquier soluci√≥n NIDS, ya que determina la capacidad del sistema para detectar y prevenir amenazas. Suricata y Snort ofrecen conjuntos de reglas completos, pero difieren en c√≥mo administran y actualizan estas reglas.

Suricata se beneficia de la herramienta Suricata-Update, que simplifica la gesti√≥n y actualizaci√≥n de conjuntos de reglas. Esta caracter√≠stica permite a los usuarios mantener f√°cilmente las √∫ltimas capacidades de detecci√≥n de amenazas, lo que reduce el tiempo y el esfuerzo necesarios para mantener el sistema actualizado.

![NIDS](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nids.png?raw=true)

Herramienta Suricata-Update, de [https://suricata.readthedocs.io](https://suricata.readthedocs.io/)

Por el contrario, Snort se basa en la gesti√≥n manual de reglas, lo que puede llevar m√°s tiempo y requerir m√°s experiencia. Sin embargo, los conjuntos de reglas espec√≠ficos de Snort para ciertos casos de uso, como la seguridad de aplicaciones web, pueden proporcionar mejores opciones de personalizaci√≥n para redes con requisitos de seguridad √∫nicos. Esta flexibilidad puede hacer que Snort sea m√°s adecuado para organizaciones con necesidades espec√≠ficas de detecci√≥n de amenazas.

### **Resumen**

Suricata ofrece un enfoque m√°s f√°cil de usar para la instalaci√≥n, configuraci√≥n y administraci√≥n de reglas, lo que puede beneficiar a los usuarios con experiencia limitada o limitaciones de tiempo. Snort, aunque potencialmente m√°s dif√≠cil de configurar, ofrece mayores opciones de personalizaci√≥n y est√° respaldado por una extensa documentaci√≥n y soporte de la comunidad. En √∫ltima instancia, la elecci√≥n entre Suricata y Snort depender√° de los requisitos √∫nicos de una organizaci√≥n, los recursos y el nivel de experiencia de sus administradores.

| SURICATA | SNORT |
| --- | --- |
| Sin interfaz web incorporada (de terceros disponibles) | Sin interfaz web incorporada (de terceros disponibles) |
| La configuraci√≥n basada en YAML simplifica la configuraci√≥n | M√©todos de configuraci√≥n tradicionales |
| Actualizaci√≥n de Suricata para una gesti√≥n de reglas optimizada | Gesti√≥n manual de reglas y actualizaciones. |
| Configuraci√≥n m√°s sencilla gracias a la interfaz web y la configuraci√≥n YAML | Puede requerir m√°s esfuerzos de personalizaci√≥n y configuraci√≥n. |
- **Comunidad y soporte**

Considerar el nivel de comunidad y soporte disponible para cada NIDS es crucial para cualquier herramienta de c√≥digo abierto, ya que puede afectar la facilidad de implementaci√≥n, configuraci√≥n y mantenimiento continuo. En esta secci√≥n, compararemos la documentaci√≥n, los foros, las integraciones de terceros y la frecuencia de actualizaci√≥n de Suricata y Snort.

- **Documentaci√≥n**

Suricata y Snort cuentan con documentaci√≥n completa y bien organizada, lo que brinda a los usuarios recursos valiosos para comprender, configurar y solucionar problemas de sus respectivos sistemas. **[La documentaci√≥n de Suricata](https://suricata.readthedocs.io/en/suricata-6.0.0/index.html)**¬† se actualiza con frecuencia para reflejar las √∫ltimas funciones y mejoras, lo que garantiza que los usuarios puedan mantenerse al d√≠a con el panorama de seguridad cibern√©tica en r√°pida evoluci√≥n.

**[La documentaci√≥n de Snort](https://www.snort.org/documents)** , aunque tambi√©n es extensa, puede requerir m√°s tiempo para navegar debido a su larga historia y la variedad de integraciones de terceros disponibles. Sin embargo, la documentaci√≥n de Snort cubre una amplia gama de temas, lo que la convierte en un recurso valioso para los usuarios que buscan personalizar y optimizar su implementaci√≥n NIDS.

- **Foros**

Suricata y Snort tienen comunidades activas y comprometidas, con foros que brindan una plataforma para que los usuarios hagan preguntas, compartan conocimientos y colaboren en diversos temas relacionados con sus implementaciones NIDS. Estos foros son invaluables para los usuarios que buscan asistencia, orientaci√≥n o consejo de profesionales y pares con experiencia en el campo de la seguridad cibern√©tica.

![Foros](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/foros.png?raw=true)

Foros de Suricata, desde [https://suricata.io](https://suricata.io/)

![Suricata2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/suricata2.png?raw=true)

Blog de Snort, de [https://blog.snort.org](https://blog.snort.org/)

- **Integraciones de terceros**

Dada la presencia m√°s prolongada de Snort en el mercado, ha acumulado una gama m√°s amplia de integraciones de terceros en comparaci√≥n con Suricata. Estas integraciones incluyen varias herramientas, plataformas y servicios que pueden mejorar las capacidades de Snort y agilizar su implementaci√≥n y administraci√≥n.

Suricata, si bien sigue ofreciendo una lista cada vez mayor de integraciones de terceros, es posible que a√∫n no coincida con el extenso ecosistema de Snort. Sin embargo, el desarrollo activo de Suricata y su enfoque en la compatibilidad con herramientas y plataformas existentes sugieren que su gama de integraciones de terceros continuar√° expandi√©ndose con el tiempo.

- **Frecuencia de actualizaci√≥n**

Suricata se beneficia de una comunidad de desarrollo activa que publica con frecuencia actualizaciones y mejoras de sus caracter√≠sticas y capacidades. Este compromiso con la mejora continua garantiza que los usuarios de Suricata puedan mantenerse a la vanguardia de las cambiantes amenazas a la seguridad cibern√©tica y aprovechar las √∫ltimas innovaciones en detecci√≥n y prevenci√≥n de intrusiones. Suricata publica actualizaciones importantes en promedio cada 3 meses.

Snort, aunque tambi√©n recibe actualizaciones peri√≥dicas, puede no tener la misma frecuencia de mejoras que Suricata debido a su madurez y posici√≥n establecida en el mercado. Sin embargo, las actualizaciones de Snort a√∫n brindan importantes mejoras de seguridad y correcciones de errores, lo que garantiza que el sistema siga siendo efectivo y confiable. Snort publica actualizaciones menores en promedio cada 2 o 3 semanas.

### **Resumen**

Tanto Suricata como Snort ofrecen un s√≥lido soporte comunitario, con documentaci√≥n extensa, foros activos y una variedad de integraciones de terceros. La historia m√°s larga de Snort proporciona un ecosistema de integraciones m√°s extenso, mientras que Suricata se beneficia de actualizaciones y mejoras frecuentes debido a su desarrollo activo. La elecci√≥n entre Suricata y Snort depender√° de las necesidades y preferencias espec√≠ficas de una organizaci√≥n y del valor que le dan al soporte comunitario, la documentaci√≥n y las integraciones de terceros.

| SURICATA | SNORT |
| --- | --- |
| Apoyo activo de la comunidad | Apoyo activo de la comunidad |
| Amplia documentaci√≥n | Amplia documentaci√≥n |
| Desarrollo activo, lo que resulta en actualizaciones y mejoras frecuentes. | Una gama m√°s amplia de integraciones de terceros debido a su mayor presencia en el mercado. |
| Open Information Security Foundation (OISF) como principal organizaci√≥n de desarrollo | Mantenido por sistemas Cisco |
- **Costo**

Al igual que con las otras medidas, el costo es un factor importante a considerar. Ambas herramientas son de c√≥digo abierto, lo que significa que est√°n disponibles gratuitamente. Sin embargo, puede haber costos adicionales asociados con el soporte, la capacitaci√≥n y otros recursos.

| FACTOR DE COSTO | SURICATA | SNORT |
| --- | --- | --- |
| Licencia | Fuente abierta | Fuente abierta |
| Opciones de soporte | Comunidad (Gratis) | Comunidad (Gratis)
Pagado-Personal $30/a√±o-Profesional desde $300/a√±o |
| Recursos de capacitaci√≥n | Gratis
Pagado (A partir de $2,000 desde Suricata) | Gratis |
| Herramientas de terceros | Gratis
Pagado (ejemplo: Elastic desde $95/mes) | Gratis
pagado (Reglas de Talos) -Personal $30/a√±o-Profesional desde $400/a√±o |
| Requisitos de hardware | Var√≠a seg√∫n la escala | Var√≠a seg√∫n la escala |

### **Conclusi√≥n**

En conclusi√≥n, tanto Suricata como Snort son potentes sistemas de detecci√≥n de intrusiones en la red que brindan una protecci√≥n s√≥lida para su entorno de red. Si bien comparten muchas similitudes, tambi√©n tienen caracter√≠sticas √∫nicas, caracter√≠sticas de rendimiento y apoyo de la comunidad, lo que hace que la elecci√≥n entre ellos dependa de las necesidades y recursos espec√≠ficos de su organizaci√≥n.

![Suricata3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/suricata3.png?raw=true)

Hemos comparado y contrastado los aspectos clave de Suricata y Snort, incluidas caracter√≠sticas, funcionalidad, rendimiento, escalabilidad, facilidad de uso, configuraci√≥n, soporte comunitario y costo. Al comprender estos factores, podr√° tomar una decisi√≥n informada sobre cu√°l es el mejor NIDS para su organizaci√≥n.

En √∫ltima instancia, la elecci√≥n entre Suricata y Snort depender√° de los requisitos √∫nicos de su red, los recursos disponibles y el nivel de personalizaci√≥n deseado. Cualquiera que sea la herramienta que elija, puede estar seguro de que est√° dando un paso proactivo para mejorar la seguridad de su red y proteger su organizaci√≥n de posibles amenazas cibern√©ticas. Puede continuar aprendiendo formas efectivas de proteger su red tomando uno de los cursos a continuaci√≥n.

### **Preguntas m√°s frecuentes**

- **¬øSuricata es una IPS o un IDS?**

Suricata funciona principalmente como un sistema de detecci√≥n de intrusiones en la red (NIDS). Sin embargo, tambi√©n se puede configurar como un sistema de prevenci√≥n de intrusiones (IPS) implement√°ndolo en l√≠nea. En este modo, Suricata puede bloquear activamente el tr√°fico malicioso adem√°s de detectar y alertar sobre amenazas potenciales. Esta versatilidad hace que Suricata sea adecuado para diversos casos de uso de seguridad de red, seg√∫n los requisitos espec√≠ficos de la organizaci√≥n.

- **¬øSnort sigue siendo relevante?**

S√≠, Snort sigue siendo relevante en el panorama de la seguridad cibern√©tica. A pesar de la aparici√≥n de herramientas m√°s nuevas como Suricata, la larga presencia de Snort en el mercado ha establecido su compatibilidad con una amplia gama de dispositivos, sistemas operativos y herramientas de terceros. La detecci√≥n basada en reglas y el an√°lisis de protocolos de Snort contin√∫an brindando una seguridad de red efectiva. Su amplio soporte comunitario garantiza que el software se mantenga actualizado y responda a las amenazas en evoluci√≥n.

- **¬øSuricata tiene GUI?**

No org√°nicamente al software. Sin embargo, Suricata ofrece una interfaz gr√°fica de usuario (GUI) a trav√©s de varias herramientas de gesti√≥n basadas en web. Una opci√≥n popular es la distribuci√≥n SELKS, que incluye Suricata y otras herramientas de seguridad, junto con un panel Kibana preconfigurado para visualizaci√≥n y gesti√≥n. Al utilizar estas herramientas basadas en web, los administradores pueden administrar f√°cilmente la configuraci√≥n de Suricata y monitorear la actividad de la red en un entorno f√°cil de usar.

Instalar y configurar el sistema de detecci√≥n de intrusos Snort 3 en Ubuntu

Requisitos previos

- Un servidor con Ubuntu
- Se configura una contrase√±a ra√≠z en el servidor.

## Instalar las dependencias requeridas

Antes de comenzar, deber√° instalar algunas dependencias en su servidor. Puede instalarlos todos ejecutando el siguiente comando:

> apt install build-essential libpcap-dev libpcre3-dev libnet1-dev zlib1g-dev luajit hwloc libdnet-dev libdumbnet-dev bison flex liblzma-dev openssl libssl-dev pkg-config libhwloc-dev cmake cpputest libsqlite3-dev uuid-dev libcmocka-dev libnetfilter-queue-dev libmnl-dev autotools-dev libluajit-5.1-dev libunwind-dev libfl-dev -y


Una vez que todas las dependencias est√©n instaladas, se puede continuar con el siguiente paso.

### Instalar Snort DAQ

A continuaci√≥n, deber√° instalar la biblioteca de adquisici√≥n de datos en su sistema. De forma predeterminada, no est√° disponible en el repositorio predeterminado de Ubuntu. Por lo tanto, deber√° compilarlo desde la fuente.

Primero, descargue Snort DAQ de Git con el siguiente comando:

> git clone https://github.com/snort3/libdaq.git

Una vez que se complete la descarga, navegue hasta el directorio descargado y config√∫relo con el siguiente comando:

> cd libdaq

> ./bootstrap

> ./configure

Deber√≠a ver el siguiente resultado:

> cc: ¬† ¬† ¬† ¬† gcc
> 
> 
> cppflags:
> 
> am_cppflags: -fvisibility=hidden -Wall -Wmissing-declarations -Wpointer-arith -Wcast-align -Wcast-qual -Wformat -Wformat-nonliteral -Wformat-security -Wundef -Wwrite-strings -Wextra -Wsign-compare -Wno-unused-parameter -fno-strict-aliasing -fdiagnostics-show-option
> 
> cflags: ¬† ¬† -g -O2
> 
> am_cflags: ¬† -Wstrict-prototypes -Wmissing-prototypes -Wold-style-definition -Wnested-externs
> 
> ldflags:
> 
> am_ldflags:
> 
> libs:
> 
> code_coverage_enabled:¬† no
> 
> code_coverage_cppflags:
> 
> code_coverage_cflags:
> 
> code_coverage_ldflags:
> 
> Build AFPacket DAQ module.. : yes
> 
> Build BPF DAQ module....... : yes
> 
> Build Divert DAQ module.... : no
> 
> Build Dump DAQ module...... : yes
> 
> Build FST DAQ module....... : yes
> 
> Build netmap DAQ module.... : no
> 
> Build NFQ DAQ module....... : yes
> 
> Build PCAP DAQ module...... : yes
> 
> Build Savefile DAQ module.. : yes
> 
> Build Trace DAQ module..... : yes
> 
> Build GWLB DAQ module...... : yes
> 

A continuaci√≥n, inst√°lelo con el siguiente comando:

> Make
> make install

## Instalar Gperftools

- Coloca el contenido de los datos del portapapeles dentro del evento para permitir la creaci√≥n de reglas sobre el contenido del portapapeles.
- Integrar eventos de ProcessTampering
    - Enriquecer el evento con una puntuaci√≥n diferente entre la secci√≥n .text en el disco y en la memoria
- Se implement√≥ la fijaci√≥n de certificados en el cliente para mejorar la seguridad del canal de comunicaci√≥n entre los puntos finales y el servidor de administraci√≥n.
- Capacidades de filtrado de registros, lo que permite recopilar eventos contextuales. El filtrado de registros se logra mediante la creaci√≥n de reglas de filtrado Gene (consulta [la documentaci√≥n de Gene](https://github.com/0xrawsec/gene) ).
- Archivos de configuraci√≥n en formato TOML para una mejor legibilidad
- Mejor protecci√≥n del directorio de instalaci√≥n.

### **Trabajo relacionado**

- EDR basado en Sysmon escrito en PowerShell: ¬†[https://github.com/ion-storm/sysmon-edr](https://github.com/ion-storm/sysmon-edr)
- Comodo Open Source EDR con componentes de usuario y kernel: ¬†[https://github.com/ComodoSecurity/openedr](https://github.com/ComodoSecurity/openedr)
- Sysmon X: ¬†[https://github.com/marcosd4h/sysmonx](https://github.com/marcosd4h/sysmonx)

Configuraci√≥n de Firewall

## **Firewall**

La seguridad en cada equipo individual sigue siendo esencial pero no se puede considerar de forma aislada.¬† Hay que considerar:

- El n√∫mero de equipos en muchas organizaciones.
- Entornos heterog√©neos con distintos sistemas operativos y versiones de cada sistema operativo
- usuarios con privilegios de administraci√≥n pueden ser un problema a la hora de organizarlos.

<aside>
üî• Un cortafuego es una herramienta que protege una red de sistemas y dispositivos interconectados mediante el control del tr√°fico de red. El cortafuego debe tener tres caracter√≠sticas clave:

</aside>

- Todo el tr√°fico de ‚Äúdentro a fuera‚Äù y de ‚Äúfuera a dentro‚Äù debe pasar por √©l.
- Solo el tr√°fico autorizado basado en la pol√≠tica de seguridad puede continuar.
- Debe ser completamente inatacable.

Aunque ning√∫n cortafuego actual cumple estos requisitos completamente, todos intentan acercarse a ellos lo m√°s posible.

![firewall1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/firewall1.png?raw=true)

Para proteger las redes, se puede optar por colocar uno o varios cortafuegos.

### **Ventajas**:

- capacidad para ser utilizados como un punto esencial de aplicaci√≥n de la pol√≠tica de seguridad.
- son capaces de soportar t√©cnicas avanzadas de autenticaci√≥n de manera m√°s eficaz y econ√≥mica que si se hiciera equipo por equipo.
- pueden centralizar alarmas y registros de tr√°fico
- Tienen menos configuraci√≥n en comparaci√≥n con un sistema de prop√≥sito general
- Necesitan pocos usuarios definidos para llevar a cabo su configuraci√≥n y mantenimiento.

<aside>
üëâ La pol√≠tica del tr√°fico en un cortafuego es **restrictiva y solo permite el tr√°fico que ha sido expl√≠citamente permitido**. Esta pol√≠tica es segura, pero cada utilidad que necesite tr√°fico debe ser analizada y permitida de manera individual.

</aside>

### **Desventajas:**

- pueden provocar una falsa sensaci√≥n de seguridad para los usuarios y administradores.
- Si son muy sofisticados, pueden requerir una configuraci√≥n compleja.
- Pueden representar un cuello de botella para el tr√°fico de red.

### **Tipos:**

- filtros de paquetes.
- *Gateways* de aplicaciones.
- *stateful inspection*. (el *Firewall-1* de *Checkpoint* o el *CiscoASA* (*Adaptative Security Appliance*), adem√°s de su tecnolog√≠a particular, pueden configurarse como servidores *proxy*.)
- h√≠bridos.

## **Arquitecturas de cortafuegos**: distintas formas de combinar cortafuegos

- **Filtros de paquetes**

Los filtros de paquetes operan en **el nivel de red y transporte** y filtran paquetes IP bas√°ndose en valores de algunos campos de las cabeceras de IP, TCP o UDP. tambi√©n permiten filtrar el tr√°fico en funci√≥n del enlace de red del que provenga. El m√°s b√°sico consiste en un encaminador que trabaja a nivel de red, aunque en muchos casos, una m√°quina con software dedicado realiza esta tarea.

**Cada filtro est√° compuesto por reglas** que se utilizar√°n de distintas formas y orden en busca de una coincidencia. Un filtro de paquetes examina cada paquete entrante por la interfaz en la que est√° aplicado el filtro y:

1. Obtiene los contenidos de las cabeceras citadas del paquete.
2. Contrasta los valores contra los configurados en las reglas del filtro, ordenadamente.
3. Si cumple lo enunciado en una regla, aplica una de las dos √∫nicas condiciones posibles: lo permite, en cuyo caso el paquete se encaminar√° a su destino o lo descarta.

- **Campos de la cabecera**

Los **campos de las cabeceras que se usan como criterios de filtrado** son:

- Las direcciones IP origen y destino del mensaje, que viajan en la cabecera de IP.
- Los n√∫meros de puerto origen y destino del mensaje, que son parte de la cabecera de TCP o de UDP.
- El tipo de protocolo o n√∫mero de protocolo, parte de la cabecera de IP, que indica, el tipo de mensaje IP: si es ICMP, OSPF, TCP, UDP, etc.
- Una serie de opciones de la cabecera TCP, como los bits de sincronizaci√≥n, de final, de ACK, etc.

Para ser efectivo, un filtro debe permitir la especificaci√≥n de puertos, ya que algunos servidores de aplicaciones IP utilizan n√∫meros de puerto normalizados, mientras que los clientes utilizan n√∫meros de puerto al azar por encima de 1023. Es necesario contar con operadores relacionales para implementar relaciones como ‚Äúmayor que‚Äù o ‚Äúigual a‚Äù y los filtros deben permitir el filtrado de paquetes seg√∫n la interfaz de origen o destino. Pueden ser un software con funcionalidades avanzadas como IPTables o ser parte de un encaminador. La tecnolog√≠a es simple y transparente para los usuarios.

![modelo osi](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/modelo-osi.png?raw=true)

### **Puntos d√©biles**:

- Si la configuraci√≥n llega a hacerse muy grande, puede hacerse dif√≠cil el mantenimiento de los filtros.
- Si se tiene que hacer una excepci√≥n ocasional, puede ser que haya que cambiar toda la configuraci√≥n, haciendo la situaci√≥n bastante insegura.
- No permiten realizar ning√∫n control a nivel de usuario ni a nivel de datos. No se puede filtrar por valores de campos de las cabeceras de aplicaci√≥n.
- No es f√°cil filtrar protocolos con m√°s de una conexi√≥n activa simult√°neamente, como ftp, ni protocolos basados en RPC.
- No suelen guardar registro de los accesos de los usuarios.

Aplicaciones dif√≠ciles de filtrar son aquellas basadas en el entorno RPC (*Remote Procedure Call*), para las que cada servidor RPC tiene asociado un n√∫mero de puerto que no es siempre el mismo. Aplicaciones como NFS (Network File System) o NIS (Network Information Services), env√≠an mensajes al *portmapper* con el n√∫mero de puerto 111 para conocer el n√∫mero de puerto actual del servidor que est√°n buscando. Estas aplicaciones est√°n compuestas por varios servidores que se registran con el *portmapper* al iniciar, lo que las hace dif√≠ciles de filtrar. No se debe permitir el tr√°fico de estas aplicaciones si el cortafuego es solo un filtro de paquetes. Las **reglas de filtrado** se expresan como una tabla de condiciones y acciones que se consultan en orden hasta encontrar una regla para decidir si se permite o se bloquea un paquete.

<aside>
‚ö†Ô∏è Es importante el orden de an√°lisis de las reglas para implementar correctamente la pol√≠tica de seguridad. Cuanto m√°s complejas sean las reglas y su orden de an√°lisis, m√°s dif√≠cil ser√° para el administrador gestionarlas. ¬øY si un paquete que no cumple ninguna regla especificada? Se debe a√±adir una regla por defecto al final de la lista que bloquee todo el tr√°fico que no cumpla con ninguna otra regla.
</aside>

![portmapper](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/portmapper.png?raw=true)

**Access Control Lists**

Muchas implementaciones de filtros de paquetes las incorporan directamente. los encaminadores Cisco incorporan dicho filtrado restrictivo por defecto en sus listas de control de acceso o ACLs (*Access Control Lists*).

> Las ACL de los encaminadores Cisco son de dos tipos: standard y extended.

> **Las ACLs de tipo *standard*** est√°n compuestas de una serie de reglas ordenadas (ACE o Access control entry), cada una de las cuales solo usan, como criterio, la direcci√≥n IP origen del mensaje, y tienen una sintaxis:

> router(config)# access-list N {permit|deny} direcci√≥n-IP-origen [m√°scara]

***Recordar estas reglas para standard y extended:***

1. Al final de todas las reglas existe una m√°s (que no pone el administrador) impl√≠cita, que deniega el resto del tr√°fico, que no coincide con alguna de las reglas de la ACL. Es la condici√≥n de ¬´todo lo dem√°s negado por defecto¬ª.
2. Hay una serie de ¬´palabras clave¬ª que se pueden utilizar para hacer las reglas m√°s legibles. Por ejemplo, en lugar de 144.21.13.12 0.0.0.0, se puede escribir host 144.21.13.12, o en lugar de escribir 0.0.0.0 0.0.0.0, se puede escribir any.
3. El comando access-list solo sirve para construir la ACL, pero no la aplica a ninguna interfaz. Para ello, existe otro comando diferente.

### **Aplicacion de control de acceso**

Para aplicar la ACL a una interfaz concreta, en el caso de los encaminadores de Cisco, se debe pasar a ¬´modo de configuraci√≥n de la interfaz¬ª y aplicar el comando ip access-group. La sintaxis es:

> router(config)# interface nombre-interface

> **router(config-if)#** ip access-group N {in|out}

nombre-interface es la sintaxis propia de Cisco. Ej: ¬´ethernet-0¬ª, N es el n√∫mero que identifica la ACL que se quiere asociar a la interfaz. IN indica tr√°fico entrante y OUT saliente. En la figura. Se quiere dejar pasar hacia dentro todo el tr√°fico de las redes externas (m√°s all√° de la interfaz ethernet-1) excepto el que venga de la red 144.21.0.0. La ACL ser√≠a:

![nombre-interface](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nombre-interface.png?raw=true)

> **router(config)#** access-list 1 deny 144.21.0.0 0.0.255.255

> **router(config)#** access-list 1 permit any La segunda l√≠nea es obligatoria. Si no se tiene en cuenta, funcionar√° la ¬´por defecto¬ª ya citada, que, aunque no se vea es:

> access-list 1 deny any

Para aplicar la ACL a la interfaz ethernet-1, los comandos ser√≠an:

> router(config)# interface ethernet-1

> router(config-if)# ip access-group 1 in

Filtrando as√≠, solamente, el tr√°fico entrante.

## **Las ACLs de tipo extended**

**Las ACLs de tipo extended,** comparten todas las dem√°s caracter√≠sticas del standa*rd*, pero tienen una sintaxis m√°s complicada, atendiendo a que permiten filtrar utilizando muchos otros criterios:

**router(config)#** access-list N {permit|deny} protocolo dir.IP-fuente [m√°scara-fuente] [op puerto-fuente] dir.IP-destino [m√°scara-destino] [op puerto-destino]

En este caso, N es un n√∫mero entre 100 y 199, para indicar que es una lista extended, protocolo es la referencia al campo de n√∫mero de protocolo de la cabecera IP y op puede ser:

- lt, indicando ¬´menor que¬ª.
- le, indicando ¬´menor o igual que¬ª.
- gt, indicando ¬´mayor que¬ª.
- ge, indicando ¬´mayor o igual que¬ª.
- eq, indicando ¬´igual a¬ª.
- ne, indicando ¬´distinto a¬ª.
- range, que permite expresar un rango de n√∫meros.

Si lo que se busca es en la misma topolog√≠a de la figura anterior, que se cumpla la siguiente pol√≠tica:

- No dejar entrar tr√°fico Telnet externo, salvo de la direcci√≥n 155.15.1.1.
- Permitir el tr√°fico, del tipo que sea, de la direcci√≥n 133.11.1.3.
- No dejar entrar tr√°fico general salvo de la red 144.21.0.0.

**La lista de acceso ser√≠a:**

> router(config)# access-list 101 permit ip host 133.11.1.3 any

> **router(config)#** access-list 101 permit tcp 155.15.11.1 any eq 23

> **router(config)#** access-list 101 permit ip 144.21.0.0 0.0.255.255 any

Al igual que antes, la condici√≥n impl√≠cita por defecto, no permite entrar m√°s tr√°fico.

**gateway (servidores proxy)**

Son una alternativa a los filtros de paquetes ya que soportan filtros a nivel de aplicaci√≥n en lugar de a nivel de red y transporte. Act√∫an para un protocolo de aplicaci√≥n y **hay un proceso *proxy* para cada protocolo que se quiere filtrar**. Un servidor *proxy* reside entre los clientes y el servidor real, intercepta las peticiones de los clientes de servicios particulares, las eval√∫a y decide qu√© tr√°fico se permite y qu√© tr√°fico se bloquea.

**Arquitectura de servidores *proxy***

![servidores-proxy](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/servidores-proxy.png?raw=true)

### Ventajas:

- Soluciona problemas que presentan los filtros de paquetes, ya que permite filtrar a nivel de aplicaci√≥n se puede filtrar por operaciones concretas de protocolo.
- Ej. en ftp se podr√≠a poner una regla de bloqueo de todos los comandos *put* y nadie podr√≠a subir archivos al servidor.
- los problemas relacionados con el esquema de ftp desaparecen ya que el *proxy* cambia el n√∫mero de puerto usado en las sesiones para mantener el estado de las dos sesiones.
- Pueden tener un proceso separado por protocolo, no tienen que tratar de hacerlo todo a la vez.
- Es sencillo restringir el acceso a un servicio: si no hay *proxy*, no hay servicio.
- Simplifica las reglas de filtrado en el encaminador. Solo se debe permitir el tr√°fico hacia la pasarela de aplicaci√≥n y bloquear el resto.
- Permite un grado de ocultaci√≥n de la estructura de la red protegida. El nombre del *proxy* ser√° el √∫nico que estar√° disponible hacia el exterior.

### Desventajas:

- Al funcionar un proceso *proxy* por servicio, se debe tener multitud de ellos, si se quiere atender al filtrado de muchos protocolos.
- Puede pasar que se tenga que usar distintos clientes, servidores o ambos.
- Pueden llegar a ser un cuello de botella para el tr√°fico.

### Tipos de servidores *proxy:*

- Un sistema gen√©rico, SOCKS, requiere clientes distintos a los t√≠picos, no es popular.
- Proxy Server, como el de Microsoft, es un paquete de *software* que permite hacer *proxy* de protocolos ftp, http y nntp.
- TIS FWTK, de *Trusted Information Systems*, que incluye distintos tipos de servidores *proxy*. Entre otros, incluye proxies para Telnet, FTP, Rlogin, Sendmail, HTTP, etc.

**¬øQu√© se puede mejorar?**

- Trabajar con tecnolog√≠a ¬´*stateful inspection*¬ª.
- Reunir varias de las tecnolog√≠as, junto con distintos tipos de sistemas de autenticaci√≥n, AAA, para crear cortafuegos mucho m√°s sofisticados.
- Con todas las tecnolog√≠as disponibles, crear distintas arquitecturas y topolog√≠as de seguridad, en torno al cortafuego.

## **Zona desmilitarizada (DMZ)**

Esta red a√≠sla los servicios que se quieren mantener disponibles por Internet y separa los servicios de la red interna.¬† Si estos servicios estuvieran en la red interna, cualquier ataque podr√≠a poner en peligro toda la red.

**Topolog√≠a de una DMZ t√≠pica**

![DMZ](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/dmz.png?raw=true)

La robustez depender√° de qu√© cortafuegos se seleccione y de lo bien configurado que est√©.

**Dos principios de seguridad:**

- **defensa en profundidad**, los ataques deben de ser capaces de atacar con √©xito primero el encaminador y, despu√©s, el cortafuego.
- **diversidad de defensa: El** cortafuego y el encaminador estan por separado.

**Topolog√≠a de doble DMZ:** consiste en dos DMZs, La externa con¬† elementos que son menos atacables y la DMZ interna.

![tipolog√≠a DMZ](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/tipologia-dmz.png?raw=true)

Es importante seleccionar cuidadosamente los dos cortafuegos y decidir qu√© servicios se colocar√°n en la DMZ externa e interna. Esta arquitectura puede presentar **dificultades de administraci√≥n**. En el caso de dispositivos m√≥viles, un cortafuego no garantiza la protecci√≥n de los datos ya que cuando estos dispositivos se conectan a redes externas no est√°n protegidos por el cortafuego y son susceptibles a ser comprometidos. Si un dispositivo m√≥vil comprometido se vuelve a conectar a la red de la organizaci√≥n, puede ser una puerta de entrada para el atacante y una fuente de infecci√≥n para el resto de equipos de la red.

### **¬øCu√°ndo necesitas un cortafuegos?**

Se requiere un cortafuegos para cualquier m√°quina que se conecte a Internet. No s√≥lo tu PC, sino tambi√©n tu servidor web, tel√©fono, dispositivos de IoT, o cualquier cosa que se te ocurra que tenga la capacidad de usar Internet. Un dispositivo desprotegido es una f√°cil elecci√≥n para las intrusiones e infecciones. Esto podr√≠a dar a los hackers la posibilidad de apoderarse de tus equipos, instalar lo que quieran, vigilar mientras introduces informaci√≥n sensible como credenciales bancarias, o incluso mirar a trav√©s de tu webcam/c√°mara y escuchar a trav√©s de tu micr√≥fono. En el caso de un servidor web, si un hacker consigue pasar, podr√≠a desconfigurar tu sitio web, incrustar un malware que infecte a tus visitantes, cambiar tu contrase√±a de administrador de WordPress, o derribar tu sitio por completo.

Sin un cortafuegos, tu sitio web e incluso tus dispositivos personales son vulnerables a los ataques DDoS, un vector de ataque que env√≠a miles o millones de paquetes falsos para sobrecargar tu servidor y hacer que tu sitio web o Internet se caiga.

El cortafuegos puede proteger tus equipos, servidores o tu sitio web frente a:

- Intrusiones: Los cortafuegos impiden a los usuarios no autorizados acceder a tu equipo o servidor de forma remota y hacer lo que quieran.
- Malware: Los atacantes que logran infiltrarse pueden enviar malware para infectarte a ti o a tu servidor. El malware puede robar informaci√≥n personal, propagarse a otros usuarios o da√±ar de alguna manera tu computadora.
- Ataques de fuerza bruta: Intentos de los hackers de probar cientos de combinaciones de nombres de usuario y contrase√±as para descubrir las credenciales de acceso de su administrador (o de otros usuarios).
- Ataques DDoS: Los cortafuegos (especialmente los de aplicaciones web) pueden intentar detectar la afluencia de tr√°fico falso que se produce durante un ataque DDoS.

### **Tipos de cortafuegos**

Hay muchos tipos diferentes de cortafuegos, cada uno est√° dise√±ado para una situaci√≥n diferente. Algunos son mejores para equipos individuales, mientras que otros est√°n hechos para filtrar toda la red. Todos funcionan de manera diferente y bloquean mejor diferentes tipos de tr√°fico. Si te preguntas qu√© deber√≠as buscar, vamos a analizar todos los principales tipos¬† de cortafuegos. A menos que tengas tu propia pila de servidores (proporcionando un sitio web con tu propia Internet), el tipo de cortafuegos del que debes preocuparte principalmente son los cortafuegos personales, los cortafuegos de software y los cortafuegos de las aplicaciones web. Estos tres son los m√°s importantes. Sin embargo, lee m√°s sobre el resto si quieres entender mejor c√≥mo funciona un cortafuegos y c√≥mo han evolucionado a lo largo de los a√±os.

1. **Cortafuegos personal**

Los cortafuegos funcionan de forma muy diferente dependiendo de si son utilizados por dispositivos individuales, redes enteras (como dentro de una oficina comercial) o servidores web. Un cortafuegos personal est√° pensado para ser usado en un solo dispositivo. Este es el firewall que viene preinstalado en las m√°quinas de Windows y Mac o con tu software antivirus. Aunque funciona de manera similar a un cortafuegos de servidor ‚Äì permitiendo o rechazando conexiones de otros dispositivos, aplicaciones e IPs basadas en un conjunto de reglas predefinidas ‚Äì act√∫a de una manera un poco diferente.

Los cortafuegos personales pueden proteger los puertos que utilizas para conectarte a sitios web y aplicaciones en l√≠nea (ocult√°ndolos para que los atacantes no puedan ver que est√°n abiertos), defenderse contra los ataques que se deslizan por la red, evitar que las personas accedan y se apoderen de tu equipo y analizar todo el tr√°fico entrante y saliente. Tambi√©n act√∫an como aplicaciones de cortafuegos, monitoreando la actividad de las aplicaciones en tu dispositivo y neg√°ndose a permitir que se establezca una conexi√≥n con software inseguro o desconocido. Hoy en d√≠a, obtener un cortafuegos personal es bastante f√°cil. Si usas cualquier versi√≥n moderna de Windows, ya deber√≠a haber uno por defecto.

**Windows Defender Firewall**

![firewall2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/firewall2.png?raw=true)

**Aplicaci√≥n de cortafuegos en macOS**

Los dispositivos Mac tambi√©n vienen con uno, aunque tienes que encenderlo t√∫ mismo. Para ello, navega a Preferencias del Sistema, haz clic en Seguridad y Privacidad y luego en Firewall:

![firewall3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/firewall3.png?raw=true)

El software antivirus a menudo viene con el suyo propio tambi√©n. Un ejemplo es el [antivirus Avast](https://www.avast.com/): su software de cortafuegos es compatible con Windows y sirve como una segunda capa de defensa. Tambi√©n existen cortafuegos personales de terceros, pero pueden causar un conflicto con la configuraci√≥n predeterminada.

1. **Hardware vs. Software Cortafuegos**

Los cortafuegos tienen dos formas distintas: cortafuegos de hardware y de software. Los cortafuegos de software son programas descargables para tu dispositivo, monitoreando todo desde un panel de control central. Los cortafuegos de hardware proporcionan una funcionalidad similar, pero est√°n f√≠sicamente instalados en el edificio. Puede que no lo sepas, pero probablemente tengas una forma de cortafuegos de hardware en tu casa: tu router, el dispositivo que te permite conectarte a Internet. Si bien no es exactamente lo mismo que un dispositivo de cortafuegos de hardware dedicado, proporciona funciones similares de monitoreo y de permitir o negar conexiones.

Tanto el software como el hardware de los cortafuegos se sit√∫an entre el dispositivo y el mundo exterior, analizando cuidadosamente cualquier conexi√≥n que intente colarse. Puedes tener uno o ambos funcionando en tu red. Sin embargo, los cortafuegos de hardware tienen algunas desventajas. Son dif√≠ciles de instalar y requieren un mantenimiento continuo, por lo que no suelen ser adecuados para dispositivos individuales o empresas muy peque√±as sin un departamento de inform√°tica. Pueden causar problemas de rendimiento, especialmente cuando se aplican junto con un cortafuegos de software. Y no son adecuados para bloquear aplicaciones en un dispositivo, o restricciones basadas en el usuario.

Por otro lado, un cortafuegos de hardware proteger√° toda su red de dispositivos f√°cilmente, mientras que la configuraci√≥n del software para ello es una tarea m√°s dif√≠cil. Y aunque un atacante puede deshabilitar el software si logra entrar, no puede manipular el dispositivo f√≠sico. Los cortafuegos de software son, como su nombre indica, mejores para trabajar con programas en un dispositivo. Bloquear aplicaciones, administrar usuarios, generar registros y monitorear usuarios en tu red son su especialidad. No son tan f√°ciles de configurar en toda la red, pero cuando se instalan en m√∫ltiples dispositivos, permiten un control m√°s fino.

1. **Cortafuegos de filtrado de paquetes**

El cortafuegos de filtrado de paquetes es el tipo m√°s simple de cortafuegos, y est√° entre los primeros desarrollados. Un paquete es la informaci√≥n que se intercambia entre tu dispositivo y un servidor. Cuando haces clic en un enlace, subes un archivo o env√≠as un correo electr√≥nico, env√≠as un paquete al servidor. Y cuando cargas una p√°gina web, te env√≠a paquetes a ti. Un cortafuegos con filtro de paquetes analiza estos paquetes y los bloquea bas√°ndose en un conjunto de reglas predefinidas. Por ejemplo, podr√≠a bloquear los paquetes que se originan en un determinado servidor o direcci√≥n IP, o los que intentan llegar a un determinado destino en tu servidor.

La desventaja: Estos tipos de cortafuegos son simples y f√°ciles de enga√±ar. No hay forma de aplicar reglas avanzadas. Si permites que el tr√°fico fluya a trav√©s de un determinado puerto, el cortafuegos de filtrado de paquetes dejar√° pasar cualquier cosa, incluso el tr√°fico que los cortafuegos modernos obviamente no dejar√≠an pasar. La √∫nica ventaja de estos es que son tan simples que casi no tienen impacto en el rendimiento. No inspeccionan el tr√°fico, no guardan registros ni ejecutan ninguna funci√≥n avanzada. Hoy en d√≠a, los cortafuegos de filtrado de paquetes deber√≠an evitarse o al menos usarse junto con algo m√°s avanzado, ya que hay soluciones mucho mejores.

1. **Cortafuegos de estado (stateful)**

Despu√©s de los ¬´sin estado¬ª, los filtros de paquetes simples lleg√≥ la tecnolog√≠a de los cortafuegos de estado. Esto fue revolucionario porque en lugar de analizar los paquetes a medida que pasan y rechazarlos bas√°ndose en par√°metros simples, los cortafuegos de estado manejan informaci√≥n din√°mica y contin√∫an monitoreando los paquetes a medida que pasan por la red. Un simple cortafuegos de filtrado de paquetes solo puede bloquear basado en informaci√≥n est√°tica como la direcci√≥n IP o el puerto. Los cortafuegos de estado son mejores para detectar y bloquear el tr√°fico ileg√≠timo porque reconocen patrones y otros conceptos avanzados.

Comparado con los cortafuegos sin estado, la desventaja es que son m√°s intensivos debido a que almacenan paquetes de datos en la memoria y los analizan m√°s rigurosamente, adem√°s de mantener registros de lo que se bloquea y lo que pasa a trav√©s de ellos. Pero son una soluci√≥n mucho mejor.

1. **Cortafuegos de nueva generaci√≥n**

Por √∫ltimo, los cortafuegos de nueva generaci√≥n (NGFW), son uno de los inventos m√°s recientes de esta generaci√≥n de tecnolog√≠a de seguridad. Estas herramientas de grado empresarial son como todas las anteriores combinadas en una sola. El filtrado profundo de paquetes, la prevenci√≥n de intrusos y el monitoreo de aplicaciones son solo algunas de sus enormes caracter√≠sticas de red. Los cortafuegos de √∫ltima generaci√≥n en la nube¬† existen como un servicio en l√≠nea, pero los WAF son mucho m√°s comunes y proporcionan una funcionalidad similar. Pero si quieres la tecnolog√≠a de cortafuegos m√°s avanzada disponible, con un paquete completo de protecci√≥n de seguridad en un programa, busca un NGFW.

### **¬øC√≥mo conseguir un cortafuegos?**

Para protegerse a s√≠ mismo y a tu sitio web, necesitas un cortafuegos de alta calidad que mantenga alejado a los intrusos. En lo que respecta a los cortafuegos personales, no suele ser necesario hacer un esfuerzo para conseguir uno. El cortafuegos incorporado de Windows funciona muy bien sin ninguna configuraci√≥n. Y entre el cortafuegos de aplicaciones que suele venir con el software antivirus y el filtro de paquetes del router, el equipo suele estar m√°s que protegido. Solo aseg√∫rate de que tu cortafuegos est√© activado, que tengas un buen antivirus instalado y que tu router est√© configurado correctamente. Lo mismo puede decirse de los usuarios de MacOS.

## **¬øC√≥mo configurar el Firewall de Windows para bloquear hackers y malware?**

La seguridad cibern√©tica es una preocupaci√≥n cada vez m√°s importante en el mundo que nos rodea. Proteger nuestros dispositivos y datos contra hackers y malware es esencial para salvaguardar nuestra privacidad y evitar ser v√≠ctimas de ciberataques. Una de las herramientas clave para fortalecer nuestra seguridad en Internet es el **Firewall de Windows**, que act√∫a como una barrera entre nuestra red y posibles amenazas externas. En este art√≠culo, te proporcionaremos informaci√≥n detallada y de utilidad sobre **c√≥mo configurar el Firewall de Windows para bloquear hackers y malware**, garantizando una protecci√≥n s√≥lida para tu sistema.

### **¬øQu√© es el Firewall de Windows?**

Este firewall es una **funci√≥n integrada en el sistema operativo Windows** que act√∫a como una **primera l√≠nea de defensa contra amenazas externas**. Funciona controlando el tr√°fico de red que entra y sale de tu PC o red, permitiendo o bloqueando el acceso a determinadas aplicaciones y puertos seg√∫n tus configuraciones.

**¬øC√≥mo configurar el Firewall de Windows?**

- **Accede a la configuraci√≥n del Firewall:** Para comenzar, ve al Panel de Control selecciona ¬´**Firewall de Windows Defender**¬´, entra en configuraci√≥n avanzada para realizar m√°s ajustes

![firewall4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/firewall4.png?raw=true)

- **Habilita el Firewall de Windows:** Aseg√∫rate de que el Firewall de Windows est√© activado. Si no lo est√°, selecciona la opci√≥n ¬´Activar o desactivar el Firewall de Windows¬ª.
- **Configura las reglas de entrada y salida:** Decide qu√© aplicaciones y servicios deben tener acceso a tu red. Puedes configurar reglas espec√≠ficas para permitir o bloquear el acceso de ciertas aplicaciones o puertos.
- **Personaliza la configuraci√≥n avanzada:** Haz clic en ¬´**Configuraci√≥n avanzada**¬ª para acceder a opciones m√°s detalladas. Aqu√≠, puedes establecer reglas m√°s espec√≠ficas para el tr√°fico de red entrante y saliente.

![firewall5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/firewall5.png?raw=true)

- **Restringe el acceso a la red p√∫blica:** Si est√°s conectado a una red p√∫blica, considera establecer el perfil de red como ¬´**P√∫blica**¬´. Esto restringir√° ciertas conexiones y ayudar√° a proteger tu dispositivo cuando est√©s en redes Wifi no seguras.
- **Actualiza regularmente:** Mant√©n actualizado el Firewall de Windows y el sistema operativo para asegurarte de tener las √∫ltimas protecciones y parches de seguridad.

**Si tienes algun antivirus instalado con firewall, este se antepondr√° el Firewall de Windows.**

### **¬øQu√© reglas puedo crear con el Firewall de Windows?**

Con el Firewall de Windows, **puedes crear diversas reglas para controlar el tr√°fico de red entrante y saliente**. Algunas de las reglas que puedes configurar incluyen:

- **Reglas de entrada para aplicaciones:** Puedes permitir o bloquear el acceso de aplicaciones espec√≠ficas a tu red. Esto te permite controlar qu√© programas pueden recibir datos desde Internet.
- **Reglas de salida para aplicaciones:** Similar a las reglas de entrada, puedes permitir o bloquear el acceso de aplicaciones a Internet. Esto controla qu√© programas pueden enviar datos hacia Internet.
- **Reglas de puerto:** Puedes configurar reglas para permitir o bloquear el acceso a puertos espec√≠ficos. Esto es √∫til para restringir ciertos servicios o conexiones a trav√©s de puertos espec√≠ficos.
- **Reglas de direcci√≥n IP:** Puedes permitir o bloquear el acceso de direcciones IP espec√≠ficas. Esto te permite controlar qu√© direcciones IP pueden acceder a tu red.
- **Reglas de perfil de red:** Puedes establecer reglas diferentes para perfiles de red espec√≠ficos, como redes privadas o p√∫blicas. Esto te permite ajustar la seguridad seg√∫n el tipo de red en la que te encuentres.
- **Reglas de seguridad personalizadas:** El Firewall de Windows te permite crear reglas personalizadas basadas en diversos criterios, como protocolos, interfaces de red y usuarios.

![firewall6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/firewall6.png?raw=true)

### **Conclusion**

Al configurar adecuadamente el Firewall de Windows y seguir buenas pr√°cticas de seguridad en l√≠nea, puedes fortalecer significativamente tu defensa contra hackers y malware. Recuerda que la ciberseguridad es un esfuerzo constante y estar informado sobre las √∫ltimas amenazas y vulnerabilidades te ayudar√° a mantener tu sistema seguro y protegido.

## **¬øC√≥mo configurar un firewall en servidores Linux?**

Para una correcta y segura instalaci√≥n de un servidor de Internet necesitamos disponer y configurar un firewall. El firewall **se encarga de regular el tr√°fico de entrada y de salida con nuestra m√°quina,** de modo que podamos comprobar que est√° relacionado con alguno de los servicios que el servidor ofrece, permitiendo o denegando las conexiones de manera selectiva.

Con nuestro firewall podremos decidir por ejemplo que se acepten conexiones para la consulta de una web por HTTP o para las conexiones por SSH, pero que deniegue todos los otros intentos de conexi√≥n a servicios distintos, que no se desean ofrecer. Generalmente, el **tr√°fico que nos interesar√° controlar es el entrante**, ya que ser√° desde donde nos lleguen posibles ataques al servidor. El tr√°fico desde el servidor hacia afuera generalmente no nos debe de preocupar, por lo que generalmente no se suele limitar.

- **Firewall UFW**

El firewall UFW (Uncomplicated Firewall) es uno de los m√°s populares de los sistemas Linux, debido a su sencillez de configuraci√≥n. Est√° disponible de manera predeterminada en muchas de las distribuciones de Linux. Si no fuera el caso, **podr√≠amos instalarlo por medio de los repositorios del sistema**, con el comando t√≠pico para cada distribuci√≥n. Por ejemplo en sistemas basados en Debian se har√≠a con el comando siguiente:

> sudo apt install ufw

Una vez instalado tenemos una suite de comandos para gestionar el propio firewall y las conexiones del servidor. UFW viene desactivado por defecto, para evitar posibles problemas de acceso al servidor antes de su configuraci√≥n, por lo que el primer paso consistir√° en definir qu√© tipos de conexi√≥n deseamos habilitar, para posteriormente activar el firewall. Podemos comprobar el estado del firewall con el comando ¬´ufw status¬ª. En un principio deber√≠amos ver que est√° inactivo.

> sudo ufw status

![firewall7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/firewall7.png?raw=true)

Es importante que, antes de activar el firewall, configuremos las conexiones permitidas, habilitando al menos el acceso por SSH, para que no perdamos el acceso al servidor. Para saber qu√© tipo de conexiones podemos activar o desactivar en el servidor, ejecutamos el comando.

> sudo ufw app list

La salida de ese comando nos indicar√° qu√© aplicaciones localiza el firewall susceptibles de configurar en nuestro sistema.

- **Habilitar SSH**

Para permitir el acceso al servidor por SSH debemos habilitar las conexiones con la aplicaci√≥n ¬´**OpenSSH**¬´. Esto lo conseguimos con el comando siguiente:

> sudo ufw allow "OpenSSH"

De manera predeterminada se permiten conexiones tanto para IPV4 como para IPV6. Los puertos de conexi√≥n habilitados ser√°n los predeterminados para estos tipos de conexi√≥n (en SSH el puerto 22).

- **Habilitar tr√°fico HTTP al servidor web**

De manera similar, podemos habilitar el tr√°fico de HTTP para el acceso al servidor web instalado. En nuestro caso, que tenemos Apache en el servidor, realizar√≠amos la configuraci√≥n habilitando la mencionada aplicaci√≥n.

> sudo ufw allow "Apache Full"

La aplicaci√≥n ¬´**Apache Full**¬ª nos permite el acceso por HTTP por los puertos comunes de HTTP (80) y HTTPS (443).

- **Activar el firewall**

Una vez realizada la configuraci√≥n, podemos activar ya el firewall, con el comando ¬´ufw enable¬ª.

> sudo ufw enable

Nos advertir√° que las conexiones por SSH pueden ser interrumpidas, pero podemos estar tranquilos porque las acabamos de habilitar con los comandos anteriores. Por √∫ltimo, podemos comprobar la configuraci√≥n de UFW con el comando ¬´ufw status¬ª. Ahora deber√≠amos ver que el firewall se encuentra activo y adem√°s podremos obtener un listado de aplicaciones habilitadas.

> sudo ufw status

![firewall8](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/firewall8.png?raw=true)

<aside>
ü§ì **Eso es todo. La configuraci√≥n del firewall se ha realizado correctamente y ya se encuentra activo en nuestro servidor para incrementar la seguridad.**

</aside>

## **Configuraci√≥n de pfSense en VMWare Workstation**

pfSense es un firewall de c√≥digo abierto y su distribuci√≥n FreeBSD. Es m√°s popular que otros firewalls y tambi√©n podemos instalarlo como m√°quina virtual. pfSense tambi√©n dispone de dispositivos f√≠sicos, y tambi√©n podemos instalar pfSense en la nube (AWS y Azure).

### **Instalaci√≥n**

Primero, necesitaba tener un software de virtualizaci√≥n como VMWare o Virtual Box, y ahora estoy usando VMWare para instalar pfSense. En segundo lugar, debe tener una m√°quina virtual Linux o Windows para la configuraci√≥n del servidor Ngnix; Estoy usando Ubuntu por ahora.

Abre tu navegador favorito y busque " descarga de pfSense " o abre¬†https://www.pfsense.org/download/

![pfSense1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense1.png?raw=true)

Ser√°s redirigido a la p√°gina de descarga de pfSense.

![pfSense2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense2.png?raw=true)

- Despu√©s de la descarga, **descomprima** este archivo. Ahora abra VMWare, luego haz clic en **Crear una nueva m√°quina virtual.**

![pfSense3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense3.png?raw=true)

Ahora hazclic en **t√≠pico,** luego haga clic en **Siguiente.**

![pfSense4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense4.png?raw=true)

Selecciona la ubicaci√≥n del archivo haciendo clic en **Examinar** . Aqu√≠, VMWare detect√≥ autom√°ticamente que era **FreeBSD.** Luego haz clic en **Siguiente** .

![pfSense5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense5.png?raw=true)

Puedes editar el nombre de la VM y elegir la ruta donde deseas almacenar la VM o mantener todo por defecto. Luego, haz clic en **Siguiente.**

![pfSense6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense6.png?raw=true)

Proporciona el **espacio m√°ximo en disco** que desea asignar para pfSense y haz clic en **Siguiente**.

![pfSense7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense7.png?raw=true)

Est√°s en el paso final, que es el paso clave que muchas personas enfrentan con este problema.

![pfSense8](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense8.png?raw=true)

Haz clic en **Adaptador de red** y configure este adaptador para WAN para comunicarse con Internet. Luego haz clic en **Agregar. Luego ver√°s una pantalla como la de la imagen de abajo.**

![pfSense9](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense9.png?raw=true)

Elije **Adaptador de red** , haz clic en **Finalizar** .

![pfSense10](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense10.png?raw=true)

Ahora utiliza este adaptador para la comunicaci√≥n **LAN** . Ahora Crate es una red de √°rea local haciendo clic en el **segmento LAN** .

![pfSense11](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense11.png?raw=true)

Haz clic en Agregar. y luego nombrarlo como desees.

![pfSense12](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense12.png?raw=true)

![pfSense13](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense13.png?raw=true)

Haz clic en **Encender la m√°quina**.¬†pfSense tardar√° un poco en iniciarse y luego **aceptar√°s** sus t√©rminos y condiciones haciendo clic **en Entrar**. Ver√°s tres opciones. Elija la primera opci√≥n, **Instalar** , luego presione Enter.

![pfSense14](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense14.png?raw=true)

Ve por defecto en este paso.

![pfSense15](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense15.png?raw=true)

Haz clic en todo lo predeterminado, presione Enter.

![pfSense16](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense16.png?raw=true)

![pfSense17](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense17.png?raw=true)

![pfSense18](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense18.png?raw=true)

Pulsa el espacio aqu√≠.

![pfSense19](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense19.png?raw=true)

Entonces elige **S√ç**

![pfSense20](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense20.png?raw=true)

Tomar√° un tiempo.

![pfSense21](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense21.png?raw=true)

![pfSense22](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense22.png?raw=true)

![pfSense23](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense23.png?raw=true)

<aside>
üòÅ Hemos instalado pfSense con √©xito.

</aside>

## **Configuraci√≥n de Ubuntu**

Encienda la m√°quina virtual Ubuntu.

![Ubuntu1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ubuntu1.png?raw=true)

Luego el adaptador LAN que elijas en pfSense.

![Ubuntu2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ubuntu2.png?raw=true)

En pfSense tambi√©n se utiliz√≥ el mismo adaptador de red.

![Ubuntu3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ubuntu3.png?raw=true)

Ahora enciende la m√°quina Ubuntu. Abre la terminal y actualice los repositorios escribiendo el comando **sudo apt update. I**nstala el servidor Nginx mediante **sudo apt install nginx** .

![Ubuntu4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ubuntu4.png?raw=true)

![Ubuntu5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ubuntu5.png?raw=true)

Abre Firefox o su navegador favorito en Ubuntu y verifica el host local si el servidor se est√° ejecutando o no.

![Ubuntu6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ubuntu6.png?raw=true)

Configura el firewall de ubuntu. De forma predeterminada, el firewall **ufw** est√° instalado en ubuntu. Primero, verifica las aplicaciones escribiendo el comando **sudo ufw app list** y el comando restante para permitir y denegar las reglas que se muestran en la siguiente imagen.

![Ubuntu7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ubuntu7.png?raw=true)

Hemos agregado con √©xito la regla de denegaci√≥n en el firewall ufw de Ubuntu.

**Configuraci√≥n de pfSense**

Despu√©s de iniciar pfSense, ver√° la pantalla de bienvenida.

![Ubuntu8](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ubuntu8.png?raw=true)

De forma predeterminada, DHCP est√° habilitado y IPV6 tambi√©n est√° habilitado para algunas personas, no te preocupes, lo solucionaremos. DHCP asignar√° autom√°ticamente la direcci√≥n IP; Podemos configurarlo usando IP est√°tica. Necesita tener una IP est√°tica para pfSense. En pfSense, seleccione **la opci√≥n 2** , luego elija la opci√≥n 1 (WAN). Si desea continuar con DHCP, presione **Y** , pero enfrentar√° muchos problemas en el futuro. Dependiendo del rango de sus subredes, seleccione subred. Para fines dom√©sticos, utilice una m√°scara de 24 subredes.

![pfSense24](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense24.png?raw=true)

![pfSense25](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense25.png?raw=true)

![pfSense26](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense26.png?raw=true)

Ahora abra ubuntu, luego abra el navegador y escriba la direcci√≥n IP de LAN. En mi caso es 192.168.1.1. De forma predeterminada, el usuario y la contrase√±a son **admin** y **pfsense,** respectivamente.

![pfSense27](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense27.png?raw=true)

![pfSense28](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense28.png?raw=true)

![pfSense29](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense29.png?raw=true)

Si tiene un nombre de host y un servidor DNS, complete esos detalles. Aqu√≠, voy todo por defecto.

![pfSense30](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense30.png?raw=true)

![pfSense31](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense31.png?raw=true)

![pfSense32](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense32.png?raw=true)

Baje y desmarque, bloquee la red privada y la red sin ruta de Internet.

![pfSense33](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense33.png?raw=true)

![pfSense34](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense34.png?raw=true)

![pfSense35](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense35.png?raw=true)

En este paso, cambie la contrase√±a de administrador. Si se est√° configurando el firewall en la oficina o en casa, no se recomienda utilizar una cuenta de administrador ni contrase√±as seguras tanto para los usuarios como para el administrador. Aqu√≠ lo estoy usando solo para fines de laboratorio, por lo que mantengo todo por defecto.

![pfSense36](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense36.png?raw=true)

![pfSense37](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense37.png?raw=true)

![pfSense38](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense38.png?raw=true)

Tambi√©n se realiza la configuraci√≥n de pfSense. Necesitamos agregar una regla NAT al firewall. Abra la p√°gina de inicio de pfSense y haga clic en **Firewall** y luego haga clic en **NAT** .

![pfSense39](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense39.png?raw=true)

Haz clic en **Agregar** . Esta es la primera regla, por lo que no debemos preocuparnos por esas flechas al agregar. Si tiene muchas reglas antes o en el futuro, desea agregar esa regla en la parte superior, luego haga clic en **la flecha hacia arriba Agregar** o agregue eso en la parte inferior y luego haga clic en la **flecha inferior agregar** .

![pfSense40](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense40.png?raw=true)

Aqu√≠, mantenga todos los valores predeterminados excepto la direcci√≥n IP de destino, la IP de origen y los puertos. En el destino, ingrese la direcci√≥n IP de pfSense seleccionando Host √∫nico o alias. En mi caso, es 192.168.0.100.

![pfSense41](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense41.png?raw=true)

![pfSense42](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense42.png?raw=true)

En el rango de puerto de destino, ingrese el puerto al que desea redirigir el tr√°fico. En mi caso son 9000.

![pfSense43](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense43.png?raw=true)

En la fuente, direcci√≥n IP, de donde proviene el tr√°fico, en nuestro caso, proviene de Ubuntu, as√≠ que ingrese la IP de Ubuntu (192.168.1.100).

![pfSense44](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense44.png?raw=true)

![pfSense45](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense45.png?raw=true)

Haz clic en **guardar**. Ahora haga clic en aplicar cambios.

![pfSense46](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense46.png?raw=true)

Ahora en su m√°quina host, abra el navegador y busque pfSense IP y el puerto que ha configurado.

![pfSense47](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/pfsense47.png?raw=true)

Eso es todo. Ha realizado correctamente el reenv√≠o de puertos con pfSense.

## **Configura el firewall de Linux con IPtables y protege tu servidor**

**iptables** es el firewall que se utiliza en sistemas operativos basados en Linux. Aunque en los √∫ltimos a√±os tenemos instalado de forma predeterminada nftables, a√∫n se puede utilizar la sintaxis de iptables para configurar el cortafuegos en nuestro sistema operativo, como Debian, Ubuntu e incluso el firewall del router si est√° basado en Linux. Conocer iptables es muy importante para mantener protegida nuestra red local de intrusiones, esto se debe a que iptables nos dar√° la posibilidad de permitir o denegar el tr√°fico que nosotros queramos. Vamos a explicar c√≥mo funciona iptables, y ejemplos de utilizaci√≥n avanzada.

### **Principales caracter√≠sticas de iptables**

iptables es un software que se encarga de **actuar como un firewall o cortafuegos en nuestra red**. Es una parte muy importante de los sistemas operativos, y es que est√° espec√≠ficamente dise√±ado para permitir el acceso autorizado y bloquear el acceso no autorizado. Un firewall establece un punto de control, tanto de entrada como salida de los paquetes, adem√°s, es muy importante indicar que un cortafuegos protege del tr√°fico que atraviesan diferentes redes, pero no protege la red local de ataques que se produzcan dentro de una misma subred.

iptables es el cortafuegos incluido en sistemas Linux desde la versi√≥n 2.4, por lo tanto, est√° incorporado de forma predeterminada en sistemas como Debian, Ubuntu, Linux Mint y muchos otros, aunque actualmente de forma interna se utiliza nftables, porque iptables se considera antiguo, aunque hoy en d√≠a todav√≠a se utiliza **iptables** ampliamente en el mundo de la administraci√≥n de sistemas Linux y tambi√©n en el mundo de la administraci√≥n de redes.

Este cortafuegos dispone de varias tablas creadas de forma predeterminada, con el objetivo de facilitar enormemente la posibilidad de a√±adir diferentes cadenas y reglas. Un detalle muy importante, es que de forma predeterminada tenemos todo en ¬´aceptar¬ª, es decir, todo el tr√°fico se permite, no hay ninguna regla para denegar el tr√°fico, por lo tanto, en un primer momento este firewall es permisivo, pero podemos cambiar la pol√≠tica predeterminada de forma muy f√°cil y r√°pida.

### **Mejoras de rendimiento**

Como puedes ver, Iptables son una soluci√≥n muy buena para realizar configuraciones y administraci√≥n del firewall del sistema. Pero m√°s all√° de las configuraciones que podamos llevar a cabo, Iptables es capaz de mejorar el rendimiento de nuestro sistema de una forma que puede ser bastante significativa. Una de las formas en las cuales lo hace, es a trav√©s de la configuraci√≥n de la tasa de paquetes. Si estos cuentan con actividad limitada de ancho de banda, se pueden establecer la cantidad de los mismos que se pueden enviar o recibir en un tiempo determinado. Esto evita las sobrecargas del sistema, y asegura que el tr√°fico tenga una distribuci√≥n uniforme.

Otra de las formas en las cuales nos puede ayudar, es con **las reglas de filtrado de paquetes**. Si conocemos el tr√°fico que es innecesario, se pueden establecer reglas para poder bloquearlo antes de que llegue a entrar al sistema. Esto nos va a ayudar a reducir de forma considerable en algunos casos, reducir la cantidad de tr√°fico que circula por la red, mejorando el rendimiento de una forma generalizada. A esto le podemos sumar las reglas de enrutamiento, las cuales son tremendamente √∫tiles en gran cantidad de casos diferentes.

Cuando disponemos de redes muy complejas, con m√∫ltiples segmentos de red o rutas diferentes, estas reglas de enrutamiento nos garantizan que los paquetes que circulan se env√≠an por la ruta m√°s eficiente y directa posible. Esto reduce los tiempos de latencia y de nuevo, mejora el rendimiento general de nuestra red. Por no hablar de todas las funciones avanzadas para los controles de calidad QoS. Esta cuando tienen la configuraci√≥n adecuada, puede establecer prioridades para garantizar que se cumplen todos los requisitos de ancho de banda. Por lo cual todas las aplicaciones de ver√°n directamente beneficiadas en su rendimiento.

### **¬øQu√© se puede hacer con iptables?**

Uno de sus usos principales es analizar el tr√°fico para **ver las caracter√≠sticas de los paquetes**. Para esto se implementa un cortafuegos que controla el tr√°fico.Por otro lado, tambi√©n permiten utilizar una tecnolog√≠a tan importante como es la NAT, que se basa en la traducci√≥n de redes. Se puede configurar un dispositivo para NAT con iptables, independientemente del Firewall.

Otra funci√≥n interesante es la de marcar los paquetes. Esto se suele hacer con el uso de iptables, para que esos paquetes pasen a otros programas, y estos en funci√≥n de las etiquetas, hacen una cosa u otra. Esto se realiza mediante mangle que, con el marcado, prepara los paquetes para un procesamiento futuro.

### **Combinar con otros servicios**

Las iptables resultan una herramienta muy potente y flexible, y nos ayudan mucho en cuanto al control del tr√°fico en sistemas basados en Linux. Lo cual es muy √∫til para proteger los servicios que dependen de estos servidores. Lo cuales podemos encontrar en una grand√≠sima cantidad de servicios actualmente. Uno de los problemas que nos podemos encontrar, es que, para poder implementarlas con otros servicios, es necesario llegar a utilizar c√≥digo para que todo salga a la perfecci√≥n. Ante esto, debemos tener en cuenta que cualquier cambio que se realice de forma incorrecta en las reglas, puede hacer que todo el tr√°fico de la red se quede bloqueado. Por lo cual siempre es recomendable dar uso de copias de seguridad, para tener siempre una v√≠a de recuperaci√≥n.

> Algunos de los ejemplos de uso m√°s b√°sicos son:
- **Servidores web HTTP/HTTPS**.
- **Servidores SSH**.
- **Servidores SMTP**.

Tambi√©n es posible implementarlas para disponer de algunas pol√≠ticas por defecto, como puede ser la denegaci√≥n de todo. Es com√∫n que muchos lugares utilicen estas pol√≠ticas predefinidas, en lugar de crear las suyas. En este caso, siempre tendremos una disponible que negar√° todo el tr√°fico, y luego abrir solo los puertos que sea expl√≠citamente necesarios para lo que vamos a necesitar. En todo caso, estos ejemplos son los m√°s b√°sicos. Iptables puede ser implementado en muchos m√°s sistemas y muy complejos. Como limitar la tasa de tr√°fico, bloquear direcciones IP, loguear tr√°fico y muchas m√°s opciones. Siempre se debe recordar, que las reglas no persisten despu√©s de los reinicios. Por lo cual ser√° necesario dar uso de scripts que programemos, y que se ejecuten al inicio de la sesi√≥n. De este modo estar√°n siempre disponibles. El problema de todo esto es que, para la programaci√≥n, es necesario tener conocimientos sobre el c√≥digo necesario para estas herramientas.

### **Calcular iptables**

El c√°lculo de iptables, implica que se deben definir las reglas en una tabla, y que sean aplicadas a la entrada y salida del tr√°fico. Para ello se debe seguir un conjunto de cadenas predefinidas, las cuales con INPUT, OUTPUT y FORWARD. Estas son las encargadas de determinar el tr√°fico que se debe analizar. Pero para poder calcularlas, se deben conocer las reglas de las mismas.

- **Criterios de procedencia:** Se deben establecer las condiciones para que los paquetes puedan aplicar las reglas. Esto incluye informaci√≥n como las direcciones IP de origen y destino, as√≠ como los puertos, protocolos y otras caracter√≠sticas que puede tener un paquete.
- **Acci√≥n:** Se tiene que definir la acci√≥n que se va a tomar cuando se cumplan ciertos criterios de coincidencia. Estas pueden ser ACCEPT, DROP y REJECT. Donde se acepta el paquete, se rechaza o incluso se llega a descartar por completo.
- **Orden de las reglas:** Debemos saber que las reglas se van a evaluar de forma secuencial. Esto hace que el orden en el cual se establecen, sea sumamente importante, ya que determinar√° la acci√≥n que se va a realizar primero. Lo m√°s recomendable es buscar un orden l√≥gico, y que sea coherente con todas las dem√°s reglas que se establecen.

Pero eso no es todo, sino que para poder calcular las iptables, debemos tener en cuenta algunos factores que son muy importantes.

- **Seguridad:** Al fin y al cabo, las iptables se utilizan para proteger a los sistemas de posibles amenazas externas. Por lo cual se debe pensar en la seguridad cuanto nos encontramos manipulando este tipo de par√°metros.
- **Rendimiento:** Se debe realizar un c√°lculo eficiente, el cual se encuentre totalmente optimizado. Esto minimizar√° la cantidad de reglas que vamos a necesitar, reduciendo tambi√©n todas las posibles redundancias que se pueden generar. Lo cual puede producir una sobreocupaci√≥n de reglas.
- **Flexibilidad:** Las iptables son una caracter√≠stica muy flexible a la hora de definir lo que pueden hacer. Es por ello que se pueden establecer condiciones muy espec√≠ficas para poder adaptarse a pr√°cticamente cualquier necesidad que tenga el sistema que estamos manejando.

Una vez que ya conocemos las principales caracter√≠sticas, vamos a ense√±ar el funcionamiento y la arquitectura de este cortafuegos.

**Funcionamiento y arquitectura**

Este cortafuegos se basa en reglas que iremos introduciendo una tras otra, su funcionamiento se basa en aplicar reglas que el propio firewall se encargue de ejecutar. Aunque en un primer momento **iptables** pueda parecer sencillo de usar, si quieres hacerlo de forma avanzada, es m√°s complicado. A continuaci√≥n, pod√©s ver un esquema resumido del funcionamiento de iptables.

![iptables1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/iptables1.png?raw=true)

**La estructura de iptables** se basa en tablas, muchas de ellas ya est√°n creadas de forma predeterminada. Dentro de las tablas tenemos las cadenas, que tambi√©n tenemos algunas creadas de forma predeterminada. Finalmente, dentro de las cadenas tenemos las diferentes reglas que podemos configurar. En la siguiente foto pod√©s ver un peque√±o esquema de c√≥mo quedar√≠a la arquitectura del firewall:

![iptables2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/iptables2.png?raw=true)

De forma predeterminada tenemos un total de cuatro tablas:

- **Tabla filter**: es la tabla por defecto, si no definimos una tabla para a√±adir una regla, siempre se ir√° a la tabla filter. En esta tabla tenemos un total de tres cadenas por defecto, dependiendo de lo que nos interese, tendremos que usar una cadena u otra: INPUT (son los paquetes en sentido entrante, al propio firewall), OUTPUT (son los paquetes en sentido saliente, desde el servidor hacia fuera), y FORWARD (sirve para filtrar los paquetes que van de una interfaz de red a otra).
- **Tabla nat**: esta tabla se encarga de hacer el NAT, transformar la IP privada en p√∫blica y al rev√©s. Dentro de NAT tenemos tres cadenas: PREROUTING (altera los paquetes antes de enrutarlos, aqu√≠ se hace el DNAT o reenv√≠o de puertos), POSTROUTING (altera los paquetes despu√©s de enrutarlos, aqu√≠ se hace el SNAT o MASQUERADE) y OUTPUT (paquetes generados por el firewall que atravesar√° el NAT configurado).
- **Tabla mangle**: esta tabla se encarga de hacer la alteraci√≥n de los paquetes, es donde se configura el QoS para la calidad del servicio, alterar cabeceras TCP etc. En esta tabla tenemos las cinco cadenas: PREROUTING, INPUT, FORWARD, OUTPUT, POSTROUTING.
- **Tabla raw**: esta tabla no se suele usar porque los paquetes viajan sin estado de conexi√≥n. Tenemos la cadena PREROUTING y OUTPUT.

Para hacer todo esto, utiliza algunas reglas de filtrado que nos indicar√°n que paquetes ser√°n aceptados y cuales rechazados o directamente, omitidos. Estas cadenas de datos la forman:

- **INPUT**: Se refiere a los paquetes que llegan al sistema.
- **OUTPUT**: Filtra los paquetes que salen de nuestra red.
- **FORWARD**: No indica el tr√°fico del router que es enviado a otros equipos.

En la siguiente imagen podes ver un peque√±o resumen de las cadenas que tenemos en las diferentes tablas:

![iptables3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/iptables3.png?raw=true)

El funcionamiento a la hora de **a√±adir una regla** es el siguiente:

- Las reglas que incorporamos a las cadenas siempre tienen un objetivo (-j en la regla).
- Cuando el firewall recibe un paquete, comprueba si el paquete concuerda con una regla que hayamos dado de alta. Si concuerda, se ejecuta el orden objetivo, si no, pasa a la siguiente regla hasta el final de la cadena.
- Las reglas se verifican en un orden secuencial, desde la primera regla hasta la √∫ltima. Es muy importante el orden, si bloqueamos todo primero y luego permitimos algo m√°s espec√≠fico, bloquearemos todo el tr√°fico y la regla m√°s espec√≠fica no se comprobar√°.
- En el caso de que ninguna regla satisfaga el paquete, entonces se utilizar√° la pol√≠tica de la cadena que tengamos (regla global).

Los objetivos que tienen las diferentes reglas son las siguientes:

- **ACCEPT**: acepta el paquete y lo pasa al siguiente nivel, un servidor web, SSH, FTP etc.
- **DROP**: bloquea el paquete y no lo pasa al siguiente nivel.
- **QUEUE**: es un objetivo especial, que pasa al paquete en una cola destinada al procesamiento en espacio de usuario. Esto se puede usar para utilizar otros programas externos.
- **RETURN**: tiene el mismo efecto que si hubi√©semos llegado al final de la cadena. Si la regla estaba en una cadena de las que hay por defecto, entonces se ejecuta la pol√≠tica de la cadena. Para una regla que est√© en una cadena definida por el usuario, se sale de ella, y se contin√∫a atravesando la cadena anterior al salto, justo despu√©s de la regla con la que se salt√≥.

Como hemos mencionado y con respecto a las tablas mangle, iptables puede dar uso de la NAT, que contar√° con sus propias tablas, mediante la que se indica las reglas para realizar el enmascaramiento del paquete, redirigir puertos o cambiar alguna direcci√≥n de origen y destino. Nos podemos encontrar:

- **PREROUTING**: Mediante esta, indicaremos a la m√°quina que realice determinadas acciones sobre los paquetes antes de que sean enrutados.
- **POSTROUTING**: Nos permite realizar determinadas acciones antes de que el paquete salga del cortafuegos.
- **OUTPUT**: Nos da la opci√≥n de modificar los paquetes generados en el cortafuegos antes de ser enrutados.

Una vez que ya conocemos el funcionamiento y su arquitectura, vamos a ver diferentes comandos para realizar diferentes acciones.

## **Comandos imprescindibles para usar iptables**

Lo primero que debemos tener en cuenta a la hora de configurar este firewall, es que necesitamos **permisos de superusuario** para realizar las diferentes √≥rdenes. Es totalmente necesario para que se ejecuten, de lo contrario no funcionar√°. Las siguientes √≥rdenes no llevan ¬´sudo¬ª porque suponemos que ya est√°s con el superusuario (sudo su).

En las √∫ltimas versiones de Linux no es posible parar el servicio de iptables, para poder permitir todo el tr√°fico de red y dejar el firewall con los par√°metros por defecto, tenemos que ejecutar las siguientes √≥rdenes:

- sudo iptables -F
- sudo iptables -X
- sudo iptables -t nat -F
- sudo iptables -t nat -X
- sudo iptables -t mangle -F
- sudo iptables -t mangle -X
- sudo iptables -P INPUT ACCEPT
- sudo iptables -P FORWARD ACCEPT
- sudo iptables -P OUTPUT ACCEPT

Una vez que hayamos hecho esto, ya tendremos el firewall ¬´reseteado¬ª y con el permitir todo. Ahora que ya sabemos c√≥mo resetearlo, vamos a ver las diferentes √≥rdenes.

## **Visualizar las tablas actuales**

**Si quieres ver el contenido de las diferentes cadenas** y reglas que tenemos en una determinada tabla, a continuaci√≥n, puedes ver c√≥mo se ver√≠an:

- iptables -t filter ‚Äìlist
- iptables -t mangle ‚Äìlist
- iptables -t nat ‚Äìlist
- iptables -t raw ‚Äìlist

### **Argumentos principales y para qu√© sirven**

- t, ‚Äìtable table Selecciona la tabla que queramos
- A, ‚Äìappend chain rule-specification A√±adimos una nueva regla en una determinada cadena
- C, ‚Äìcheck chain rule-specification Comprobamos que existe una determinada regla en una determinada cadena
- D, ‚Äìdelete chain rule-specification Borramos la regla que pongamos en una determinada cadena
- D, ‚Äìdelete chain rulenum Borramos la regla n√∫mero X en una determinada cadena
- I, ‚Äìinsert chain [rulenum] rule-specification Insertamos una nueva cadena con un n√∫mero en una determinada tabla
- R, ‚Äìreplace chain rulenum rule-specification Reemplaza una determinada cadena en una tabla, sirve para moverla de n√∫mero.
- L, ‚Äìlist [chain] Muestra el listado de reglas de una cadena
- F, ‚Äìflush [chain] Elimina todas las reglas de una determinada cadena.
- Z, ‚Äìzero [chain [rulenum]] Pone los contadores de una determinada regla a 0.
- N, ‚Äìnew-chain chain Creamos una nueva cadena en una determinada tabla
- X, ‚Äìdelete-chain [chain] Borramos una determinada cadena (vac√≠a) en una determinada tabla
- P, ‚Äìpolicy chain target Aplicamos la pol√≠tica por defecto, se cumple cuando ninguna regla de las cadenas se cumple.
- E, ‚Äìrename-chain old-chain new-chain Renombra una cadena a√±adida anteriormente
- h, muestra la ayuda
- v, ‚Äìverbose Salida que se usa en conjunto con ‚ÄìL, sirve para mostrar m√°s informaci√≥n que lo que proporciona el comando ‚ÄìL.
- n, ‚Äìnumeric Las direcciones IP y los n√∫meros de puertos aparecer√°n con n√∫meros. Por ejemplo, si filtramos el puerto 80, con el ‚ÄìL t√≠pico aparecer√° www, y no 80.
- x, ‚Äìexact Muestra el valor exacto del contador de paquetes y bytes, en lugar de usar K, M o G para los valores.
- ‚Äìline-numbers Al mostrar el listado de reglas, mostrar√° el n√∫mero exacto de la regla. Ideal para usar ‚ÄìD y el n√∫mero (eliminar) o ‚ÄìI para introducir delante o detr√°s de dicha regla.

### **Condiciones principales**

- **p**, ‚Äìprotocol protocol. Filtra el paquete por protocolo, el protocolo especificado puede ser: tcp, udp, Idplite, icmp, esp, ah, sctp.
- **s**, ‚Äìsource address[/mask][,‚Ä¶] Direcci√≥n IP de origen del paquete. Podemos tener una IP o una subred (indicando la m√°scara en formato CIDR). Tambi√©n podemos poner nombres de host (dominios, webs etc), pero es una mala idea porque no es eficiente. Se pueden especificar varias direcciones de origen, (192.168.1.1,192.168.1.2) pero crear√° diferentes reglas para satisfacerlas.
- **d**, ‚Äìdestination address[/mask][,‚Ä¶] Direcci√≥n IP de destino del paquete. Se comporta exactamente igual que -s.
- **m**, ‚Äìmatch match. Especifica si queremos llamar a los m√≥dulos extendidos de iptables, para realizar determinadas acciones como:
    - Poner m√∫ltiples puertos de origen y destino (m√≥dulo multiport).
    - Controlar conexiones (m√≥dulo conntrack).
    - Evitar fuerza bruta (m√≥dulo recent, ideal para SSH).
    - Limitar el n√∫mero de conexiones (m√≥dulo limit y connlimit).
    - Rango de direcciones IP (iprange).
- **j**, ‚Äìjump target. Especifica el objetivo de la regla, si queremos aceptar, denegar e incluso reenviar el paquete a otra cadena para su posterior tratamiento. Siempre en cualquier regla vamos a tener un ‚Äìj para decirle qu√© queremos hacer. Si no incorporamos un ‚Äìj se a√±adir√° la regla y contar√° los paquetes, pero no har√° nada. Si utilizamos ‚Äìj para reenviar a otra cadena, una vez que en la otra cadena haya terminado, volver√° a la original.
- **g**, ‚Äìgoto chain. Sirve para reenviar el tr√°fico a otra cadena, pero a diferencia de jump, no volver√° a la cadena original por donde entr√≥.
- **i**, ‚Äìin-interface name. Nombre de la interfaz por donde un paquete se recibe. Solo vale para las cadenas de entrada como INPUT, FORWARD y PREROUTING. Si ponemos ‚Äò!‚Äô Significa todas menos esa interfaz. Si ponemos un + al final del nombre, cualquier interfaz con el inicio del nombre la coger√° para comprobarla. Imaginemos eth0, eth1 y eth2. Si queremos poner las tres simplemente con poner eth+ es suficiente.
- **o**, ‚Äìout-interface name. Nombre de la interfaz por donde un paquete sale. Solo vale para las cadenas de salida como OUTPUT, FORWARD y POSTROUTING.

### **Condiciones solamente si usas TCP o UDP**

Si utilizas el protocolo TCP o UDP, es posible que quieras filtrar por n√∫mero de puerto origen y/o destino, a continuaci√≥n, ten√©is los dos argumentos que puedes usar:

- ‚Äìsport ‚Äìsource-port. Selecciona puertos de origen para permitir o denegar. Si usamos ! excluye.
- ‚Äìdport ‚Äìdestination-port. Selecciona puertos de destino para permitir o denegar. Si usamos ! excluye.

Existen muchas m√°s condiciones para una configuraci√≥n avanzada del firewall, pero las elementales ya las tenemos listadas.

### **Configurar la pol√≠tica por defecto**

Las pol√≠ticas sirven para que cuando no se encuentra una regla dentro de la cadena, se ejecute la pol√≠tica por defecto. La pol√≠tica por defecto de todas las cadenas es ACCEPT, pero hay dos opciones: ACCEPT o DROP

- **P, ‚Äìpolicy chain target**

Ejemplos:

- iptables -P INPUT DROP
- iptables -P FORWARD DROP
- iptables -P OUTPUT DROP

Con esto nos quedaremos sin internet, por lo que a continuaci√≥n debemos empezar a crear reglas permisivas.

A continuaci√≥n, pod√©s ver todas las pol√≠ticas que tenemos en las diferentes tablas:

- iptables -t filter -P (INPUT | OUTPUT | FORWARD) (ACCEPT | DROP)
- iptables -P (INPUT | OUTPUT | FORWARD) (ACCEPT | DROP)
- iptables -t mangle -P (INPUT | OUTPUT | FORWARD | PREROUTING | POSTROUTING) (ACCEPT | DROP)

**Ver el estado del firewall**

El par√°metro -L muestra las reglas que tenemos configuradas. V permite recibir m√°s informaci√≥n sobre las conexiones y N nos devuelve las direcciones IP y sus correspondientes puertos sin pasar por un servidor DNS.

- iptables -L -n -v

Este es uno de los comandos m√°s importantes para ver el estado del cortafuegos.

**M√≥dulos (-m match) de iptables**

### **Multiport**

Es una extensi√≥n de iptables que nos da la posibilidad de agrupar reglas similares con diferentes puertos TCP y UDP en una sola. Multiport permite poner varios puertos salteados, y tambi√©n varios puertos seguidos, el m√°ximo es de 15 argumentos de puertos. Ejemplo:

- iptables ‚ÄìA INPUT ‚Äìp tcp ‚Äìm multiport ‚Äìdports 80,81,1000:1200 ‚Äìj ACCEPT

Gracias a este m√≥dulo, tenemos la posibilidad de usar varios puertos en la misma regla.

### **Iprange**

iprange nos permite poner varias direcciones IP de origen o destino de una vez, sin necesidad de poner decenas de reglas. Tambi√©n permite poner tanto IP de origen como de destino, la sintaxis es la siguiente:

- [!]‚Äìsrc-range ip-ip
- [!]‚Äìdst-range ip-ip

El funcionamiento de esta regla es bastante sencillo, simplemente ponemos IP inicio e IP final.

### **Connlimit**

El m√≥dulo connlimit se encarga de restringir el n√∫mero de conexiones simult√°neas realizadas por una direcci√≥n IP, es ideal para limitar el n√∫mero de conexiones para evitar DoS.

- ‚Äìconnlimit-upto n . Marcamos si el n√∫mero de conexiones es igual o menor que N (luego podemos permitir o denegar).
- ‚Äìconnlimit-above n . Marcamos si el n√∫mero de conexiones es mayor que N (luego podemos permitir o denegar).
- ‚Äìconnlimit-mask prefix_length . Marcamos por rango de subred (es igual que un host haga 2 conexiones, que dos host de la misma subred hagan 1 conexi√≥n cada uno).
- ‚Äìconnlimit-saddr . Aplicar la limitaci√≥n al grupo de origen, es la de por defecto si no se especifica nada.
- ‚Äìconnlimit-daddr . Aplica la limitaci√≥n al grupo de destino.

Por ejemplo, imaginemos que queremos permitir dos conexiones SSH por cliente √∫nicamente:

- iptables -A INPUT -p tcp ‚Äìdport 22 -m connlimit ‚Äìconnlimit-above 2 -j DROP

No obstante, podemos hacer la regla complementaria, poniendo un accept hasta 2 conexiones.

### **Conntrack**

Este m√≥dulo sirve para realizar un tracking de las conexiones, sirve para gestionar la entrada y salida de paquetes antes y despu√©s del establecimiento de la conexi√≥n. Dentro de este m√≥dulo hay varias opciones, pero la m√°s importante es -ctstate que nos permite aceptar o denegar diferentes tipos de paquetes. Dentro de ctstate tenemos varios estados, destacan los siguientes:

- INVALID: El paquete recibido es inv√°lido y no pertenece a ninguna conexi√≥n.
- NEW: Conexiones nuevas que se realizan, o que est√° asociado a una conexi√≥n que a√∫n no es bidireccional.
- ESTABLISHED: Conexiones establecidas, pasan primero por NEW ya que han tenido respuesta
- RELATED: Paquete que est√° relacionado a una conexi√≥n existente, pero que no es parte de ella, como FTP pasivo.

Imaginemos que queremos acceder a cualquier sitio, sin embargo, no queremos que absolutamente nadie acceda a nosotros.

- iptables ‚ÄìP INPUT DROP
- iptables -A INPUT -m conntrack ‚Äìctstate ESTABLISHED,RELATED -j ACCEPT

### **Limit**

El m√≥dulo limit nos permite limitar, tanto tr√°fico, como n√∫mero de logs a escribir en el syslog como intentos de conexi√≥n. Tiene dos argumentos principalmente:

- ‚Äìlimit N . Este argumento especifica el n√∫mero m√°ximo de coincidencias de media por segundo (N/s), minuto (N/m), hora (N/h) o d√≠a (N/d) a permitir. N especifica el n√∫mero
- ‚Äìlimit-burst N . Indica la r√°faga m√°s larga que se puede producir antes de comprobar el l√≠mite ‚Äìlimit.

El valor por defecto si no se especifica nada es 3 coincidencias por hora, a r√°fagas de 5. Imaginemos la siguiente regla: ¬´iptables -A INPUT -m limit -j LOG¬ª, el funcionamiento es el siguiente:

- La primera vez que se alcanza esta regla, se registran los primeros cinco paquetes.
- Despu√©s, pasar√°n veinte minutos antes de que vuelva a registrarse un paquete con esta regla (3 coincidencias entre 60 minutos igual a 20 minutos, ya que es MEDIA).
- Adem√°s, cada veinte minutos que pasen sin que un paquete alcance la regla, la r√°faga recuperar√° un paquete.
- Si no sucede nada durante 100 minutos, la r√°faga quedar√° completamente recargada; de vuelta entonces a la situaci√≥n inicial.

### **Recent**

El m√≥dulo recent sirve para limitar el n√∫mero de conexiones por segundo a nivel de IP, esto es ideal para protegernos de ataques al puerto SSH porque un atacante probar√° m√∫ltiples contrase√±as. Por ejemplo, si queremos proteger nuestro SSH, podr√≠amos ejecutar la siguiente regla:

- iptables -A INPUT -p tcp ‚Äìdport 22 -m conntrack ‚Äìctstate NEW -m recent ‚Äìset ‚Äìname ssh ‚Äìrsource
- iptables -A INPUT -p tcp ‚Äìdport 22 -m state ‚Äìstate NEW -m recent ‚Äìrcheck ‚Äìseconds 60 ‚Äìhitcount 4 ‚Äìname ssh ‚Äìrsource -j DROP

Esta regla permite solamente hacer cuatro intentos de conexi√≥n al cabo de 60 segundos, es una ventana ¬´deslizante¬ª.

### **NAT**

Este firewall tambi√©n se encarga de hacer NAT de nuestra conexi√≥n. Para hacer el NAT de nuestra IP p√∫blica (o interfaz que tenga esta IP p√∫blica), debemos poner:

- SNAT Est√°tico: iptables -t nat -A POSTROUTING -s 192.168.1.0/24 ‚Äìo eth1 -j SNAT ‚Äìto IP_eth1
- SNAT Din√°mico: iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth1 -j MASQUERADE

Lo normal es usar MASQUERADE para hacer NAT independientemente de la direcci√≥n IP que tenga la interfaz f√≠sica o l√≥gica.

Para abrir puertos tenemos que a√±adir una regla en la cadena PREROUTING de la tabla NAT.

- iptables -t nat -A PREROUTING -i eth1 -p tcp ‚Äìdport 22 -j DNAT ‚Äìto-destination 192.168.1.1

La tabla PREROUTING tambi√©n nos permite modificar los puertos al vuelo, de tal forma que, si recibimos paquetes en el puerto 2121, lo podemos transformar al 21.

- iptables -t nat -A PREROUTING -i eth1 -p tcp ‚Äìdport 2121 -j DNAT ‚Äìto-destination 192.168.1.1:21

Una vez que ya conocemos en detalle este cortafuegos, vamos a ver los ejemplos b√°sicos de utilizaci√≥n y tambi√©n los m√°s avanzados.

## Ejemplos b√°sicos de utilizaci√≥n

Este firewall es muy completo y tenemos cientos de comandos que podemos ejecutar para realizar diferentes acciones. vamos a poner unos ejemplos f√°ciles de entender para un primer acercamiento a este cortafuegos.

**Primero, bloquear la direcci√≥n IP 192.168.1.10 para que no realice ninguna comunicaci√≥n a nuestro servidor:**

- iptables -A INPUT ‚Äìs 192.168.1.10 ‚Äìj DROP

Luego, si quieres bloquear las direcciones IP 192.168.1.20, 192.168.1.30, 192.168.1.40, 192.168.1.50 para que no realicen ninguna comunicaci√≥n a nuestro servidor:

- iptables -A INPUT ‚Äìs 192.168.1.20,192.168.1.30,192.168.1.40,192.168.1.50 ‚Äìj DROP

Y para bloquear toda la subred 192.168.2.0/24 para que no realicen ninguna comunicaci√≥n a nuestro servidor, excepto la direcci√≥n IP 192.168.2.20 que s√≠ se permitir√≠a:

- iptables ‚ÄìA INPUT ‚Äìs 192.168.2.20 ‚Äìj ACCEPT
- iptables ‚ÄìA INPUT ‚Äìs 192.168.2.0/24 ‚Äìj DROP

Si buscas bloquear la direcci√≥n IP de 192.168.4.50 para que no puedas hacer ninguna comunicaci√≥n:

- iptables ‚ÄìA OUTPUT ‚Äìd 192.168.4.50 ‚Äìj DROP

Tambi√©n est√° la opci√≥n de bloquear las direcciones IP 192.168.4.51 y 192.168.4.52 para que nosotros no podamos hacer ninguna comunicaci√≥n:

- iptables ‚ÄìA OUTPUT ‚Äìd 192.168.4.51,192.168.4.52 ‚Äìj DROP

Y bloquear el acceso a [www.google.es](http://www.google.es/) desde iptables:

- iptables ‚ÄìA OUTPUT ‚Äìd [www.google.es](http://www.google.es/) ‚Äìj DROP

Queremos bloquear el acceso a nuestro servidor de la MAC 00:01:02:03:04:05, y el resto permitir todo:

- iptables -A INPUT -m mac ‚Äìmac-source 00:01:02:03:04:05 -j DROP

Queremos permitir el acceso a nuestro servidor a la direcci√≥n MAC MAC 00:01:02:03:04:06, y el resto denegar todo:

- iptables -A INPUT -m mac ‚Äìmac-source 00:01:02:03:04:05 -j ACCEPT
    
    iptables -A INPUT -j DROP
    

Tambi√©n est√° la opci√≥n de bloquear la direcci√≥n IP 192.168.1.10 para realizar ping desde nuestro nuestro servidor:

- iptables -A INPUT -s 192.168.1.10 -p icmp -j DROP

Despu√©s, bloquear las direcciones IP 192.168.1.20, 192.168.1.30, 192.168.1.40, 192.168.1.50 para que no realicen PING a nuestro servidor (en una sola regla):

- iptables -A INPUT -s 192.168.1.20,192.168.1.30,192.168.1.40,192.168.1.50 -p icmp -j DROP

Bloquear toda la subred 192.168.2.0/24 para que no realicen PING a nuestro servidor, excepto la direcci√≥n IP 192.168.2.20 que s√≠ se permitir√≠a:

- iptables -A INPUT -s 192.168.2.20 -p icmp -j ACCEPT
    
    iptables -A INPUT -s 192.168.2.0/24 -p icmp -j DROP

Tambi√©n para bloquear la direcci√≥n IP de 192.168.4.50 para que nosotros no podamos hacer ping.

- iptables -A OUTPUT -d 192.168.4.50 -p icmp -j DROP

Y bloquear las direcciones IP 192.168.4.51 y 192.168.4.52 para que nosotros no podamos hacer ping.

- iptables -A OUTPUT -d 192.168.4.51,192.168.4.52 -p icmp -j DROP

Bloquear el acceso a [www.google.es](http://www.google.es/) desde iptables.

- iptables -A OUTPUT -d [www.google.es](http://www.google.es/) -p icmp -j DROP

Tal y como podes ver, el funcionamiento es bastante sencillo con las reglas basadas en IP con origen y destino. Tambi√©n podr√≠amos usar el m√≥dulo iprange para configurar un rango de IPs:

Bloquear un rango de direcciones IP que van desde 192.168.5.1 hasta la direcci√≥n 192.168.5.50 para que no puedan hacer ping desde nuestro servidor.

- iptables -A OUTPUT -m iprange ‚Äìdst-range 192.168.5.1-192.168.5.50 -p icmp -j DROP

Tambi√©n podemos filtrar de forma m√°s avanzada el protocolo ICMP. Imaginemos que tenemos un usuario que quiere poder hacer ping a cualquier host, pero, sin embargo, no quiere que NADIE le pueda hacer ping a √©l. ¬øC√≥mo lo podemos hacer con iptables si el propio PING tiene comunicaci√≥n bidireccional?

- iptables -A INPUT -s IP -p icmp ‚Äìicmp-type echo-request -j DROP

Bloquear cualquier acceso entrante por la interfaz eth0 (√∫nicamente), por lo tanto, permitir el acceso eth1.

- iptables -A INPUT -i eth0 -j DROP
- iptables -A INPUT -i eth1 -j ACCEPT

Bloquear el tr√°fico saliente por la interfaz eth0 (√∫nicamente), por lo tanto, permitir el acceso eth1.

- iptables -A OUTPUT -o eth0 -j DROP
- iptables -A OUTPUT -o eth1 -j ACCEPT

Permitir cualquier tipo de tr√°fico entrante y saliente por eth0, y denegar cualquier tr√°fico entrante o saliente por eth1.

- iptables -A INPUT -i eth0 -j ACCEPT
- iptables -A OUTPUT -o eth0 -j ACCEPT
- iptables -A INPUT -i eth1 -j DROP
- iptables -A OUTPUT -o eth1 -j DROP

### Si quieres empezar a ver c√≥mo funciona el protocolo TCP y UDP, a continuaci√≥n, ten√©is algunos ejemplos:

Bloquear el acceso web a [www.google.es](http://www.google.es/) y permitir todo lo dem√°s (ping) por ejemplo.

- iptables -A OUTPUT -d [www.google.es](http://www.google.es/) -p tcp ‚Äìdport 80 -j DROP

Por otro lado, para bloquear el acceso FTP a cualquier IP o dominio, y permitir todo lo dem√°s.

- iptables -A OUTPUT -p tcp ‚Äìdport 21 -j DROP

Si lo que buscas es bloquear el acceso SSH a la IP 192.168.1.50, y permitir todo lo dem√°s.

- iptables -A OUTPUT -d 192.168.1.50 -p tcp ‚Äìdport 22 -j DROP

Para bloquear el acceso Telnet a la subred 192.168.2.0, y permitir todo lo dem√°s.

- iptables -A OUTPUT -d 192.168.2.0/24 -p tcp ‚Äìdport 23 -j DROP

Bloquear el acceso de 192.168.1.50 a nuestro servidor web.

- iptables -A INPUT -s 192.168.1.50 -p tcp ‚Äìdport 80 -j DROP

Bloquear el acceso de 192.168.1.150 y 192.168.1.151 a nuestro servidor SSH.

- iptables -A INPUT -s 192.168.1.150,192.168.1.151 -p tcp ‚Äìdport 22 -j DROP

Si quieres bloquear el acceso de toda la subred 192.168.2.0/24 a nuestro servicio telnet

- iptables -A INPUT -s 192.168.2.0/24 -p tcp ‚Äìdport 23 -j DROP

Bloquear el acceso de todo el mundo al servidor OpenVPN, excepto la direcci√≥n IP 77.77.77.77 que s√≠ se permite.

- iptables -A INPUT -s 77.77.77.77 -p tcp ‚Äìdport 1194 -j ACCEPT
- iptables -A INPUT -p tcp ‚Äìdport 1194 -j DROP

En cambio, para bloquear el acceso DNS a 8.8.8.8 y permitir todo lo dem√°s (ping) por ejemplo.

- iptables -A OUTPUT -d 8.8.8.8 -p tcp ‚Äìdport 53 -j DROP
- iptables -A OUTPUT -d 8.8.8.8 -p udp ‚Äìdport 53 -j DROP

Para bloquear el acceso al puerto 1194 a cualquier IP o dominio, y permitir todo lo dem√°s.

- iptables -A INPUT -p udp ‚Äìdport 1194 -j DROP

Tenemos un servidor DNS en nuestro servidor. Queremos que solo los equipos de la subred 192.168.1.0/24 se puedan comunicar con √©l, y bloquear todos los dem√°s accesos.

- iptables -A INPUT -s 192.168.1.0/24 -p tcp ‚Äìdport 53 -j ACCEPT
- iptables -A INPUT -s 192.168.1.0/24 -p udp ‚Äìdport 53 -j ACCEPT
- iptables -A INPUT -p tcp ‚Äìdport 53 -j DROP
- iptables -A INPUT -p udp ‚Äìdport 53 -j DROP

Bloquear el acceso a nuestro servidor web, del rango de IP 192.168.100.0/24, que proviene de la interfaz eth0.

- iptables -A INPUT -s 192.168.100.0/24 -i eth0 -p tcp ‚Äìdport 80 -j DROP

Bloquear el acceso a nuestro servidor ssh, del rango de IP 192.168.100.0/24, que proviene de la interfaz eth1.

- iptables -A INPUT -s 192.168.100.0/24 -i eth1 -p tcp ‚Äìdport 22 -j DROP

## Ejemplos avanzados de uso

Si quieres aprender m√°s sobre iptables, a continuaci√≥n, ten√©is algunos ejemplos donde hacemos uso del m√≥dulo connlimit.

Permitir √∫nicamente 10 conexiones Telnet por cliente.

- iptables -A INPUT -p tcp ‚Äìdport 23 -m connlimit ‚Äìconnlimit-above 10 ‚Äìconnlimit-mask 32 -j DROP

Denegar hasta la conexi√≥n n√∫mero 5 en web que realice un cliente (no tiene mucho sentido, pero es un ejemplo).

- iptables -A INPUT -p tcp ‚Äìdport 80 -m connlimit ‚Äìconnlimit-upto 5 ‚Äìconnlimit-mask 32 -j DROP

Si quieres permitir √∫nicamente 10 conexiones Telnet por cliente (hacerlo de otra manera al anterior).

- iptables -A INPUT -p tcp ‚Äìdport 23 -m connlimit ‚Äìconnlimit-upto 10 ‚Äìconnlimit-mask 32 -j ACCEPT
- iptables -A INPUT -p tcp ‚Äìdport 23 -j DROP

Permitir √∫nicamente 10 conexiones web en el rango de IP 10.0.0.0/8, y denegar si supera este n√∫mero.

- iptables -A INPUT -s 10.0.0.0/8 -p tcp ‚Äìdport 80 -m connlimit ‚Äìconnlimit-above 10 ‚Äìconnlimit-mask 8 -j DROP

Pero, si buscas permitir √∫nicamente 20 conexiones HTTP por cada cliente, en cuanto se supere mandamos un TCP Reset.

- iptables -A INPUT -p tcp ‚Äìdport 80 -m connlimit ‚Äìconnlimit-above 20 ‚Äìconnlimit-mask 32 -j REJECT ‚Äìreject-with tcp-reset

O esta forma:

- iptables -A INPUT -p tcp ‚Äìsyn ‚Äìdport 80 -m connlimit ‚Äìconnlimit-above 20 ‚Äìconnlimit-mask 32 -j REJECT ‚Äìreject-with tcp-reset

Tal y como podes ver, este firewall es realmente completo y podremos hacer una gran cantidad de configuraci√≥n muy avanzadas, para controlar en detalle todas las conexiones entrantes y salientes.

Tambi√©n cabe recordar que los cambios que podamos realizar en la configuraci√≥n de iptables, son ef√≠meros, por lo cual debemos guardarlos para que estos persistan tras posibles reinicios que se puedan producir en el servidor.

## ¬øQu√© es el firewall Ferm y para qu√© sirve?

**Ferm** (For Easy Rule Making) es un frontend de iptables, esto significa que, por debajo, realmente est√° utilizando iptables para permitir o denegar el tr√°fico, pero nos permite configurar de forma muy avanzada el firewall sin necesidad de aprendernos la sintaxis de iptables ni realizar diferentes scripts haciendo uso de iptables, sino que lo haremos directamente con Ferm. Esta herramienta es capaz de leer las reglas de un archivo de configuraci√≥n que nosotros vamos a definir, y posteriormente ¬´llamar√°¬ª a **iptables** para ir a√±adiendo las diferentes reglas una a una, insert√°ndose en tiempo real en el kernel.

El **objetivo de Ferm** es proporcionar a los administradores de sistemas y redes una forma f√°cil de leer y escribir todas las reglas del cortafuegos, reduciendo la tarea de tener que escribir una regla tras otra, por lo que podremos dedicar m√°s tiempo al desarrollo y optimizaci√≥n de las reglas, para que sean lo m√°s eficientes posible. Ferm utiliza un lenguaje de configuraci√≥n muy simple pero bastante avanzado, podremos utilizar variables, funciones, arrays e incluso bloques. Otras opciones muy interesantes de Ferm es que nos permitir√° incluir otros archivos de configuraci√≥n en un directorio, y se encargar√° de importar y aplicar todas esas reglas de forma autom√°tica.

**Ferm no deja de ser un frontend de iptables**, por tanto, cuando utilicemos esta herramienta, siempre vamos a poder editar y configurar directamente el firewall haciendo uso de los comandos de iptables. De hecho, Ferm es capaz de importar las reglas actuales de iptables y ponerlas autom√°ticamente en el archivo de configuraci√≥n, para posteriormente editarlas o ampliarlas.

## Alternativas a iptables

El mercado de firewalls est√° lleno de opciones, las cuales var√≠an mucho en caracter√≠sticas. Por lo cual, si no te acaba de convencer, o necesitas algo que este no te ofrece, vamos a ver algunas alternativas.

### **pfSense**

Es una aplicaci√≥n de firewall de c√≥digo abierto y basada en el sistema operativo FreeBSD. Se utiliza para crear reglas de firewall dedicadas, siendo muy fiable y ofreciendo diferentes caracter√≠sticas que hacen de √©l uno de los m√°s famosos y comerciales. Entre sus principales caracter√≠sticas podemos destacar:

- Es altamente configurable y se puede actualizar desde la interfaz web.
- Se puede utilizar como firewall perimetral, enrutador, servidor DHCP y DNS.
- Cuenta con balanceo de carga entrante y saliente.
- Se puede utilizar como punto de acceso y punto final de VPN.

### **IPCop Firewall**

Se trata de una distribuci√≥n de Linux, y est√° muy enfocado a sistemas dom√©sticos y peque√±as empresas u oficinas. Es muy sencillo de utilizar por lo cual es accesible, y se puede utilizar como una VPN, por lo cual se pueden reducir costes en este sentido. Entre sus caracter√≠sticas m√°s destacadas podemos ver:

- La interfaz gr√°fica es sencilla.
- Se pueden visualizar y rotar los registros autom√°ticamente.
- Da soporte a muchos idiomas.
- Es sencillo de implementar, y se encuentra con actualizaciones constantes.

### **Shorewall**

Se trata de una herramienta donde poder **configurar un firewall o un Gateway para Linux**. Es una herramienta de alto nivel, por lo cual se necesitan ciertos conocimientos para poder configurar filtros de red y establecer los requisitos del firewall. Este puede realizar lecturas de archivos de configuraci√≥n gracias a la ayuda de iptables. Entre sus principales caracter√≠sticas se pueden destacar:

- Permite configurar Netfliter para que coincida con los requisitos establecidos.
- Se puede utilizar en sistemas de firewall dedicado.
- Puede hacer la funci√≥n de enrutador.
- Puede instalarse como servidor multi-funci√≥n.

# ¬øQu√© es un firewall de aplicaciones web (WAF)?

Los firewalls de aplicaciones web (web application firewalls, WAF) ayudan a proteger las aplicaciones web contra ataques maliciosos y tr√°fico de Internet no deseado, como bots, inyecci√≥n y denegaci√≥n de servicio (denial of service, DoS) de capa de aplicaci√≥n.

WAF le ayudar√° a establecer y gestionar reglas para evitar amenazas de Internet, incluidas direcciones de protocolo de internet (Internet Protocol, IP), encabezados de protocolo de transferencia de hipertexto (hypertext transfer protocol, HTTP), cuerpo HTTP, cadenas de identificador uniforme de recursos (uniform resource identifier, URI), scripts de sitios (cross-site scripting, XSS), inyecci√≥n SQL y otras vulnerabilidades definidas por el Open Web Application Security Project (OWASP). El firewall de aplicaciones web se implementa para proteger las aplicaciones orientadas a la web y recopilar los registros de acceso a fin de garantizar la conformidad y los an√°lisis.

Un firewall de aplicaciones web (WAF) ayuda a proteger las aplicaciones web al filtrar y monitorear el tr√°fico HTTP entre una aplicaci√≥n web e Internet. Normalmente, protege las aplicaciones web de ataques tales como falsificaciones entre sitios, scripts entre sitios (XSS), inclusiones de archivos e inyecciones de c√≥digo SQL, entre otros.

El WAF es una defensa del protocolo de capa 7 (en el modelo OSI) y no est√° dise√±ado para defender de todos los tipos de ataques. Este m√©todo de mitigaci√≥n de ataques suele formar parte de un paquete de herramientas que, en conjunto, crean una defensa integral contra una amplia gama de vectores de ataque.

Al desplegar un WAF en una aplicaci√≥n web, se coloca un escudo entre la aplicaci√≥n web e Internet. Si bien un servidor proxy protege la identidad del equipo del cliente por medio de un intermediario, un WAF es un tipo de proxy inverso que protege al servidor de los riesgos al hacer que los clientes atraviesen el WAF antes de llegar al servidor.

El WAF opera por medio de un conjunto de reglas, normalmente denominadas directivas. Estas directivas tienen el fin de proteger contra vulnerabilidades en la aplicaci√≥n al filtrar el tr√°fico malicioso. El valor de un WAF procede, en parte, de la velocidad y facilidad con que se pueden aplicar modificaciones en las directivas que permiten una respuesta m√°s r√°pida ante diversos vectores de ataque; durante un ataque DDoS, se puede implementar r√°pidamente la limitaci√≥n de velocidad modificando las directivas del WAF.

![waf1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/waf1.png?raw=true)

## ¬øPor qu√© es importante la seguridad WAF?

Los firewalls de aplicaciones web ayudan a proteger las aplicaciones implementadas en la nube p√∫blica, en entornos locales y en entornos con controles de acceso basados en datos de geolocalizaci√≥n, direcciones IP en la lista blanca y en la lista negra, el localizador uniforme de recursos de protocolo de transferencia de hipertexto (URL de HTTP) y el encabezado HTTP.

Los WAF pueden identificar y bloquear el tr√°fico de bots maliciosos con un conjunto avanzado de m√©todos de verificaci√≥n, incluido JavaScript, una prueba de Turing p√∫blica completamente automatizada para diferenciar computadoras de seres humanos (Completely Automated Public Turing Test to tell Computers and Humans Apart, CAPTCHA), interpretaci√≥n de dispositivos y algoritmos de interacci√≥n humana.

Los WAF protegen las aplicaciones orientadas a Internet contra ataques como resultado de la inteligencia de amenazas integrada que se agrega desde varios or√≠genes y las reglas de detecci√≥n del Open Web Application Security Project (OWASP). No hay tantas herramientas incorporadas para protegerte, y a menudo depende de ti asegurar tu sitio web. Por ejemplo, si est√°s ejecutando WordPress, no hay un firewall ni nada que proteja tu servidor y los plugins de seguridad son una de las opciones m√°s comunes.

Los desarrolladores de WordPress hacen todo lo posible para mantener el c√≥digo optimizado, pero cuando surgen vulnerabilidades, no tienes nada para evitar las intrusiones. Todos los sitios pueden beneficiarse de una WAF. Servicios en l√≠nea como Sucuri, Wordfence, Cloudflare pueden tener uno instalado en tu servidor en minutos.

Muchas organizaciones se enfrentan a mayores riesgos de seguridad en el nivel de las aplicaciones debido a las metodolog√≠as de desarrollo √°gil, el cambio a la nube, el aumento del uso de software basado en la Web o aplicaciones SaaS y las fuerzas laborales remotas. La incorporaci√≥n de un WAF permite a las organizaciones hacer frente a los ataques dirigidos a las aplicaciones web y a las interfaces de programaci√≥n de aplicaciones (API).

Si bien los WAF no protegen a las organizaciones de todas las amenazas digitales, s√≠ abordan las que se dirigen al nivel de las aplicaciones, incluidas las vulnerabilidades de las aplicaciones de OWASP Top 10. Estas pueden incluir:

- **Secuencia de comandos en sitios cruzados (XSS, por sus siglas en ingl√©s):** Un ataque de inyecci√≥n de c√≥digo en el que un adversario inserta c√≥digo malicioso dentro de un sitio web leg√≠timo. El c√≥digo se lanza entonces como un comando script infectado en el navegador web del usuario, permitiendo al atacante robar informaci√≥n sensible o hacerse pasar por el usuario.
- **Ataques DDoS en la capa de las aplicaciones:** Un ataque DoS o DDoS volum√©trico centrado en la capa de las aplicaciones. Entre los ejemplos m√°s comunes se encuentran las inundaciones HTTP/S, los ataques SSL, los ataques de lentitud y los ataques de fuerza bruta.
- **Inyecci√≥n SQL:** un ataque de inyecci√≥n SQL es similar al XSS ya que los adversarios aprovechan una vulnerabilidad conocida para inyectar sentencias SQL maliciosas en una aplicaci√≥n. Esto, a su vez, permite al hacker extraer, alterar o borrar informaci√≥n.
- **Ataques de d√≠a cero:** un ataque de d√≠a cero se produce cuando un hacker explota una vulnerabilidad de seguridad desconocida o un fallo de software antes de que el desarrollador del mismo haya publicado un parche.

# C√≥mo funcionan los WAF

Si bien la tecnolog√≠a de estado se sigue utilizando hoy en d√≠a, ya no es suficiente por s√≠ sola para mantener una red segura de manera efectiva. Los cortafuegos de aplicaciones y los cortafuegos de aplicaciones web fueron el siguiente gran paso. Los cortafuegos tradicionales solo monitorean el tr√°fico general en una red. Luchan o fallan completamente en la detecci√≥n del tr√°fico que entra o sale de una aplicaci√≥n, servicio u otro software.

Los cortafuegos de aplicaciones fueron dise√±ados para trabajar con estos programas, capturando los intentos de intrusi√≥n que se aprovechan de las vulnerabilidades del software para pasar por encima de los cortafuegos m√°s antiguos.

Tambi√©n podr√≠an funcionar como un sistema de control parental para un negocio, bloqueando el acceso a ciertas aplicaciones y sitios web por completo. Los cortafuegos de aplicaciones web funcionan de manera similar, pero supervisan las aplicaciones web en lugar de los programas de un dispositivo. Algunos ejemplos de aplicaciones web son los plugins de formularios o carritos de compras de terceros, que a veces pueden ser secuestrados para enviar malware a su servidor.

Sin un WAF, eres vulnerable a estos ataques. Muchos WAF est√°n basados en la nube, lo que significa que no necesitas hacer ning√∫n cambio radical en tu servidor para configurarlos. Pero tambi√©n pueden existir en el hardware o en el software del servidor. Si necesitas un servicio de cortafuegos para proteger tu sitio web, busca un WAF basado en la nube como Cloudflare o Sucuri. Estos pueden ser instalados sin tener que jugar con configuraciones sensibles del host de la web o configurar hardware costoso.

Cuando se implementa un WAF frente a una aplicaci√≥n web, se coloca un escudo protector entre la aplicaci√≥n web e Internet que supervisa todo el tr√°fico entre la aplicaci√≥n y el usuario final. Un WAF protege las aplicaciones web filtrando, monitorizando y bloqueando cualquier tr√°fico HTTP/S malicioso que se dirija a la aplicaci√≥n web y tambi√©n evita que cualquier dato no autorizado salga de la aplicaci√≥n, adhiri√©ndose a un conjunto de pol√≠ticas que ayudan a determinar qu√© tr√°fico es malicioso y qu√© tr√°fico es seguro.

Al igual que un servidor proxy act√∫a como intermediario para proteger la identidad de un cliente, en una implementaci√≥n tradicional, un WAF funciona de forma similar pero a la inversa (llamado proxy inverso), actuando como intermediario que protege al servidor de la aplicaci√≥n web de un cliente potencialmente malicioso.

![waf2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/waf2.png?raw=true)

# Componentes del servicio de firewall de aplicaciones web

Hay una serie de componentes del WAF, entre los que se distinguen los siguientes:

- **Pol√≠tica de firewall de aplicaciones web**Las pol√≠ticas de WAF abarcan la configuraci√≥n general del servicio WAF, incluidas las funciones de gesti√≥n de origen, configuraci√≥n de reglas de protecci√≥n y detecci√≥n de bots.
- **Origen**El servidor host de origen de la aplicaci√≥n web, dise√±ado para configurar reglas de protecci√≥n u otras funciones, seg√∫n se define en la pol√≠tica de WAF.
- **Reglas de protecci√≥n**Las reglas de protecci√≥n se pueden configurar para permitir, bloquear o registrar solicitudes de red cuando cumplen los criterios especificados de una regla de protecci√≥n. El WAF observar√° el tr√°fico de su aplicaci√≥n web a lo largo del tiempo y sugerir√° nuevas reglas que aplicar.
- **Gesti√≥n de bots**El servicio WAF incluye varias funciones que permiten detectar y bloquear o permitir el tr√°fico de bots identificado en sus aplicaciones web. Las funciones de gesti√≥n de bots incluyen la verificaci√≥n de JavaScript, la verificaci√≥n de CAPTCHA y las listas blancas de GoodBot. Las soluciones de gesti√≥n de bots pueden utilizar t√©cnicas de detecci√≥n, como el l√≠mite de velocidad de IP, CAPTCHA, la huella de dispositivos y los desaf√≠os de interacci√≥n humana, para identificar la actividad de bots sospechosos en sus aplicaciones web y bloquearla. Al mismo tiempo, WAF puede permitir que el tr√°fico de bots leg√≠timos de los proveedores de bots publicados omitan estos controles.

![waf3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/waf3.png?raw=true)

# Funciones de los firewalls de aplicaciones web

Algunas de las capacidades y las funciones clave de los WAF son las siguientes:

- Enrutamiento din√°mico del tr√°fico a trav√©s del sistema de nombres de dominio (domain name system, DNS): aprovecha los algoritmos de enrutamiento del tr√°fico basados en el DNS que tienen en cuenta la latencia de los usuarios de miles de ubicaciones globales para determinar las rutas con menor latencia.
- Alta disponibilidad de los servicios de WAF: al configurar la entrega de aplicaciones web, los WAF pueden ofrecer varias opciones de configuraci√≥n de alta disponibilidad con la capacidad de agregar varios servidores de origen. Estas configuraciones se pueden utilizar cuando los servidores de origen principales est√©n fuera de l√≠nea o no respondan correctamente a las comprobaciones del sistema.
- M√©todos flexibles para gestionar pol√≠ticas: las configuraciones de WAF permiten configurar y gestionar funciones y funcionalidades para satisfacer las necesidades de su organizaci√≥n.
- Supervisi√≥n e informes: los WAF proporcionan a los usuarios la capacidad de acceder a informes relacionados con su biblioteca de contenidos con fines de conformidad y an√°lisis.
- Escalaci√≥n: la informaci√≥n de los WAF proporciona a los equipos de soporte la capacidad de emitir y escalar un ticket seg√∫n la urgencia.

# Implementaci√≥n de un firewall de aplicaciones web basado en la nube

Un WAF basado en la nube debe soportar varios entornos de alojamiento de aplicaciones web, incluidos entornos locales, en la nube, h√≠bridos y multinube. Esto significa que un WAF puede proteger el per√≠metro de una red frente al tr√°fico malicioso, independientemente del n√∫mero de proveedores de infraestructura que se utilicen. El WAF basado en la nube adecuado proporcionar√° una plataforma independiente para proteger todas las aplicaciones y API orientadas a Internet, sin importar d√≥nde residan.

A los mejores WAF basados en la nube los gestiona continuamente un equipo de expertos en seguridad de Internet con experiencia, que controla un entorno y recomienda pasos de mitigaci√≥n de amenazas comprobados cuando surgen problemas. Los beneficios de un servicio WAF gestionado incluyen una reducci√≥n significativa del riesgo. La carga de la gesti√≥n tambi√©n se reduce debido a la configuraci√≥n, la supervisi√≥n, el ajuste y la respuesta a incidentes de WAF como responsabilidad del proveedor en la nube.

La supervisi√≥n continua protege a las organizaciones contra tiempos de inactividad no planificados y da√±os resultantes a la reputaci√≥n de las marcas. Adem√°s, los servicios gestionados permiten dedicar m√°s tiempo a las tareas b√°sicas de la empresa y mejorar el resultado final.

Los WAF basados en la nube ofrecen el m√°ximo nivel de seguridad de las aplicaciones web sin realizar una inversi√≥n inicial importante en recursos ni en costos continuos relacionados con el mantenimiento, la sustituci√≥n del hardware ni las actualizaciones de software. Los WAF basados en la nube ofrecen facilidad de implementaci√≥n y precios de suscripci√≥n predecibles, lo que facilita la planificaci√≥n presupuestaria.

# Beneficios de los firewalls de aplicaciones web

El firewall de aplicaciones web (WAF) filtra las solicitudes maliciosas a una API o aplicaci√≥n web. Tambi√©n proporciona m√°s visibilidad sobre el lugar del cual proviene el tr√°fico y se mitigan los ataques de denegaci√≥n de servicio distribuidos (distributed denial of service, DDos) de capa 7, lo que ayuda a aumentar la disponibilidad de las aplicaciones y a cumplir mejor los mandatos de conformidad.

La soluci√≥n de gesti√≥n de bots utiliza t√©cnicas de detecci√≥n como la limitaci√≥n de direcciones IP, el CAPTCHA, la huella digital de dispositivos y los desaf√≠os de interacci√≥n humana para identificar e impedir que las actividades de los bots maliciosas o sospechosas atraviesen su sitio web para obtener datos que supongan una ventaja competitiva.

Al mismo tiempo, el servicio WAF puede permitir que el tr√°fico leg√≠timo de bots de Google, Facebook y otros contin√∫en accediendo a las aplicaciones web seg√∫n lo previsto. WAF utiliza un sistema de nombres de dominio (DNS) inteligente mediante un algoritmo controlado por datos que determina el mejor punto de presencia (point of presence, POP) global para prestar servicios a un determinado usuario en tiempo real.

Como resultado, se redirige a los usuarios para evitar problemas de la red mundial y posibles latencias, adem√°s de ofrecer los mejores tiempos de actividad y niveles de servicio posibles.

# Modelos de seguridad WAF

Los WAF aplican por lo general tres enfoques a la seguridad:

- **Lista blanca**: una "lista de permitidos" que utiliza algoritmos de aprendizaje autom√°tico y modelos de comportamiento para definir qu√© tr√°fico deja pasar el WAF. Despu√©s, bloquea el resto.
- **Lista negra**: una "lista de bloqueados" basada en firmas actualizadas contra vulnerabilidades conocidas que define qu√© tipo de tr√°fico rechaza el WAF. El resto se acepta.
- **Enfoque h√≠brido**: el WAF se basa en una combinaci√≥n de modelos de seguridad positivos y negativos: una combinaci√≥n de listas de permitidos y bloqueados que determina lo que pasa.

Un WAF que opera bas√°ndose en una lista negra (modelo de seguridad negativa) protege de ataques conocidos. Un WAF de lista negra es como el guardia de seguridad de una discoteca al que se le indica que impida la entrada a invitados que no cumplan con el c√≥digo de vestimenta. Por el contrario, un WAF basado en lista blanca (modelo de seguridad positiva) solo admite tr√°fico que haya sido aprobado previamente. Ser√≠a como el guardia de seguridad de una fiesta exclusiva que solo admite a las personas que se encuentran en la lista.

Tanto la lista negra como la lista blanca tienen sus ventajas y desventajas, por lo que muchos WAF ofrecen un modelo de seguridad h√≠brido que implementa ambas.

### **¬øQu√© son los WAF basados en la red, basados en host y basados en la nube?**

Un WAF puede implementarse de tres maneras, cada una con sus propias ventajas y desventajas:

- **Un WAF basado en la red** suele estar basado en un hardware. Al instalarse de forma local, reducen la latencia. Sin embargo, los WAF basados en la red son la opci√≥n m√°s costosa y tambi√©n requieren el almacenamiento y mantenimiento de equipos f√≠sicos.
- **Un WAF basado en host** puede estar totalmente integrado en el software de una aplicaci√≥n. Esta soluci√≥n es m√°s barata que un WAF basado en la red y se puede personalizar con m√°s facilidad. Pero un WAF basado en host tambi√©n tiene desventajas, como el consumo de recursos del servidor local, la complejidad de la implementaci√≥n y los costes de mantenimiento. Estos componentes suelen necesitar tiempo de ingenier√≠a, y esto puede ser caro.
- **Los WAF basados en la nube** ofrecen una opci√≥n accesible que es muy f√°cil de implementar; suelen ofrecer una instalaci√≥n lista para usar que es tan simple como aplicar un cambio en el DNS para redireccionar el tr√°fico. Los WAF basados en la nube tambi√©n tienen un costo inicial m√≠nimo, ya que los usuarios pagan mensual o anualmente por la seguridad como servicio. Los WAF basados en la nube tambi√©n pueden ofrecer una soluci√≥n que se actualiza constantemente para proteger de las amenazas m√°s nuevas sin trabajo o costes adicionales para el usuario. La desventaja de un WAF basado en la nube es que los usuarios derivan la responsabilidad a un tercero, por lo que algunas funciones del WAF pueden representar un misterio para ellos. (Un WAF basado en la nube es un tipo de firewall en la nube; m√°s informaci√≥n sobre los firewalls en la nube.)
- **WAF h√≠brido:** se puede utilizar una combinaci√≥n de soluciones WAF locales y basadas en la nube para proteger las aplicaciones web. Las organizaciones que utilizan una combinaci√≥n de aplicaciones locales y basadas en la nube suelen utilizar soluciones WAF h√≠bridas.
- **WAF integrado:** esta soluci√≥n WAF se combina con soluciones de seguridad adicionales , como una red de entrega de contenido (CDN) o un equilibrador de carga. Las soluciones WAF integradas pueden agregar capas de seguridad y tienen m√°s √©xito en la prevenci√≥n de amenazas cibern√©ticas complicadas.

### **¬øCu√°les son las capacidades clave de un WAF?**

Lo ideal es que un WAF combine modelos de seguridad positivos y negativos para proporcionar una protecci√≥n integral, que incluya poder mitigar los ataques conocidos a las aplicaciones web, como las violaciones de acceso, los ataques camuflados detr√°s de las CDN, las manipulaciones y ataques a las API, las mencionadas inundaciones HTTP/S y los asaltos de fuerza bruta, entre otros. Adem√°s, esta combinaci√≥n tambi√©n proporciona protecci√≥n contra ataques y vulnerabilidades desconocidas, como los ataques de d√≠a cero.

Un firewall de aplicaciones web tambi√©n debe aprovechar los algoritmos de aprendizaje autom√°tico basados en el comportamiento para crear y optimizar las pol√≠ticas de seguridad en tiempo real para lograr una protecci√≥n integral, a la vez que se producen m√≠nimos o ning√∫n falso positivo. Esta capacidad tambi√©n debe proporcionar la detecci√≥n y protecci√≥n autom√°tica de nuevas aplicaciones, a medida que se a√±aden a una red.

**Otras capacidades clave que debe incluir un WAF:**

- **Las funciones principales deben incluir:** el filtrado del tr√°fico de red basado en el geobloqueo, los grupos de IP, la lista de bloqueo, la lista de permitidos, la lista blanca y la lista negra
- **Hallazgo y protecci√≥n de API,** que proporciona visibilidad, cumplimiento y mitigaci√≥n de todas las formas de abuso y manipulaci√≥n de API, ya sea para entornos locales o alojados en la nube. las soluciones WAF protegen las API contra el acceso no autorizado y amenazas espec√≠ficas de API, como la inyecci√≥n de API y el raspado de API.
- **Protecci√≥n DDoS integrada** para detener los mencionados ataques DDoS en la capa de las aplicaciones
- **Mecanismos de prevenci√≥n de fuga de datos** para ocultar autom√°ticamente informaci√≥n confidencial del usuario, como informaci√≥n personal identificable (PII, por sus siglas en ingl√©s)
- **Actualizaciones autom√°ticas:** los proveedores de WAF actualizan sus reglas y firmas autom√°ticamente para ofrecer protecci√≥n contra amenazas nuevas y emergentes.
- **Protecci√≥n contra bots:** los sistemas WAF detectan y bloquean el tr√°fico de bots que intenta explotar aplicaciones web mediante aprendizaje autom√°tico y an√°lisis de comportamiento. La capacidad de integrarse con soluciones de gesti√≥n de bots para detectar e integrar bots sofisticados que parecen humanos
- **Consola de administraci√≥n centralizada:** los productos WAF proporcionan una consola de administraci√≥n centralizada a trav√©s de la cual los administradores pueden configurar, monitorear y administrar muchas instancias WAF desde un solo lugar.
- **Pol√≠ticas de firewall personalizables:** las soluciones WAF permiten a los administradores establecer y aplicar pol√≠ticas de firewall personalizadas para evitar el acceso no deseado a las aplicaciones web.
- **Creaci√≥n de reglas personalizadas:** los WAF permiten a los administradores crear reglas personalizadas para protegerse contra riesgos espec√≠ficos o garantizar el cumplimiento de las leyes de la industria.
- **Detecci√≥n y prevenci√≥n de intrusiones:** las soluciones WAF detectan y previenen ataques a aplicaciones web combinando metodolog√≠as basadas en firmas y basadas en comportamiento.
- **Monitoreo y advertencias en tiempo real:** los sistemas WAF monitorean el tr√°fico web en tiempo real y env√≠an alertas a los administradores cuando se descubre un comportamiento sospechoso.
- **Escalabilidad:** los WAF pueden gestionar niveles masivos de tr√°fico en l√≠nea y al mismo tiempo proteger contra ataques DDoS a gran escala.
- **Cifrado SSL/TLS:** las soluciones WAF incluyen cifrado SSL/TLS para proteger el tr√°fico en l√≠nea contra escuchas e interceptaciones.

### **Din√°mica y tendencias del mercado de WAF**

Seg√∫n la investigaci√≥n de Quadrant Knowledge Solutions, los siguientes son los principales factores que impulsan el mercado de WAF:

- Los proveedores de WAF que desean mejorar su oferta est√°n integrando sus productos con sistemas de gesti√≥n de eventos e informaci√≥n de seguridad (SIEM, por sus siglas en ingl√©s), pruebas de seguridad de aplicaciones (AST, por sus siglas en ingl√©s) y gesti√≥n de acceso web (WAM, por sus siglas en ingl√©s).
- Los proveedores proporcionan soluciones de WAF que se basan en un modelo de seguridad positiva y utilizan un algoritmo de aprendizaje autom√°tico para analizar las solicitudes HTTP.
- Gracias al aumento de equipos de IoT, es probable que las organizaciones inviertan en soluciones WAF para cumplir las normas de privacidad de datos, que incluyen funciones espec√≠ficas de IoT como la toma de huella digital en el equipo y la validaci√≥n de protocolos.
- Las empresas buscan una inteligencia contra amenazas mejorada, una protecci√≥n WAF ampliada y una variedad de integraciones inmediatas.
- Existe un inter√©s por nuevos m√©todos de detecci√≥n para prevenir los ataques web y minimizar los falsos positivos.

### **Las 12 mejores soluciones de firewall de aplicaciones web**

Los firewalls de aplicaciones web monitorean y filtran el tr√°fico de aplicaciones web y protegen las aplicaciones web contra ataques que explotan las debilidades en el c√≥digo de la aplicaci√≥n y la estructura del servidor. Un firewall de aplicaciones web (WAF) puede identificar y prevenir amenazas t√≠picas basadas en la web, como inyecci√≥n SQL, secuencias de comandos entre sitios (XSS) y vulnerabilidades de inclusi√≥n de archivos.

Un WAF es un componente cr√≠tico de una s√≥lida estrategia de seguridad de aplicaciones en l√≠nea. Los WAF pueden identificar y prevenir ataques a las vulnerabilidades de las aplicaciones web, lo que ayuda a prevenir el robo de datos, la interrupci√≥n del servicio y el da√±o a la reputaci√≥n.

### **Comparaci√≥n de las mejores soluciones WAF**

Esta tabla compara las principales herramientas WAF seg√∫n el m√©todo de implementaci√≥n, la compatibilidad con el protocolo, la protecci√≥n DDoS, las capacidades de AI/ML, las capacidades de integraci√≥n y el precio.

| Soluci√≥n WAF | M√©todo de implementaci√≥n | Soporte de protocolo | Protecci√≥n DDoS | Capacidades de IA/ML | Integraci√≥n | Precios |
| --- | --- | --- | --- | --- | --- | --- |
| Akamai App and
API Protector | Basado en la nube | Admite HTTP, HTTPS y HTTP/2 | S√≠ | S√≠ | SIEM, SOAR, herramientas DevOps | Akamai no ha proporcionado informaci√≥n sobre los precios de este servicio. |
| AppTrana | Basado en la nube | Admite HTTP, HTTPS y otros protocolos web | S√≠ | No | SIEM | Desde $99 por mes |
| WAF de AWS | Basado en la nube | Admite HTTP, HTTPS y otros protocolos web | S√≠ | S√≠ | servicios de AWS | El precio inicial por ACL web es de $5 por mes, m√°s $1 por regla WAF y solicitud. |
| Barracuda WAF | Local y basado en la nube | Admite HTTP, HTTPS y otros protocolos web | S√≠ | S√≠ | SIEM, SOAR, herramientas DevOps | WAF-as-a-Service (50Mbps) comienza en $1,02 por unidad. |
| Cloudflare | Basado en la nube | Admite HTTP, HTTPS y otros protocolos web | S√≠ | S√≠ | Herramientas de desarrollo y operaciones | El plan Pro comienza en $20/mes |
| F5 Advanced WAF | Local y basado en la nube | Admite HTTP, HTTPS y otros protocolos web | S√≠ | S√≠ | SIEM, SOAR, herramientas DevOps | F5 no ha proporcionado informaci√≥n sobre precios para este servicio. |
| Fastly | Basado en la nube | Admite HTTP, HTTPS y otros protocolos web | S√≠ | S√≠ | Herramientas de desarrollo y operaciones | El plan de conexi√≥n segura TLS/SSL comienza en $20.00 por mes, mientras que el plan de ancho de banda y solicitudes comienza en $50.00 por mes |
| Fortinet
FortiWeb | Local y basado en la nube | Admite HTTP, HTTPS y otros protocolos web | S√≠ | S√≠ | SIEM, SOAR, herramientas DevOps | El paquete est√°ndar de 1 a√±o comienza en $2321 |
| Imperva WAF | Local y basado en la nube | Admite HTTP, HTTPS y otros protocolos web, as√≠ como API y microservicios | S√≠ | S√≠ | SIEM, SOAR, herramientas DevOps | El plan Pro comienza en $59 por sitio por mes |
| Microsoft Azure App Gateway | Basado en la nube | Admite HTTP, HTTPS y otros protocolos web | S√≠ | S√≠ | Servicios de Azure | Precios de pago por uso |
| Radioware | Local y basado en la nube | Admite HTTP, HTTPS y otros protocolos web | S√≠ | S√≠ | SIEM, SOAR, herramientas DevOps | Radware no ha proporcionado informaci√≥n sobre precios para este servicio. |
| Wallarm WAF | Basado en la nube | Admite HTTP, HTTPS y otros protocolos web, as√≠ como API y microservicios | S√≠ | S√≠ | SIEM, SOAR, herramientas DevOps | Wallarm no ha proporcionado informaci√≥n sobre precios para este producto o servicio. |

**Akamai App and API Protector**

## **Lo mejor para grandes empresas con aplicaciones web de alto tr√°fico**

[Akamai App and API Protector](https://www.akamai.com/products/app-and-api-protector?gclid=EAIaIQobChMIutW2w7fc_gIVRJJmAh0b6gFFEAAYASABEgJ_XPD_BwE&utm_source=google&utm_medium=cpc&utm_campaign=F-MC-52611&utm_term=App%20API%20Protector&utm_content=ASEAN&ef_id=EAIaIQobChMIutW2w7fc_gIVRJJmAh0b6gFFEAAYASABEgJ_XPD_BwE:G:s&s_kwcid=AL!5241!3!620199055858!e!!g!!akamai%20app%20and%20api%20protector!15086065916!128574502466) es un firewall de aplicaciones web (WAF) basado en la nube que protege los activos web y m√≥viles de una organizaci√≥n contra amenazas sofisticadas de denegaci√≥n de servicio (DoS), aplicaciones web y aplicaciones basadas en API. Hace uso de la visibilidad en toda Akamai Intelligent Edge Platform para proteger los sitios web y las API contra interrupciones y robo de datos. Akamai ha sido calificado como l√≠der en el Cuadrante M√°gico de Gartner para aplicaciones web en la nube y protecci√≥n de API en 2022.

**Caracter√≠sticas Clave**

- Visibilidad de la API
- M√©todos de IA y aprendizaje autom√°tico
- Opciones de implementaci√≥n h√≠brida
- Informaci√≥n sobre el tr√°fico en vivo
- Automatizaci√≥n

### **Ventajas**

- Proporciona defensas adaptables que env√≠an inmediatamente las actualizaciones de seguridad m√°s recientes a sus aplicaciones y API.
- El autoajuste preventivo reduce la necesidad de un mantenimiento manual que requiere mucho tiempo
- Los recursos t√©cnicos y de desarrollo proporcionan una innovaci√≥n r√°pida
- Descubrimiento avanzado de API, que permite a los usuarios gestionar el riesgo asociado con API nuevas o no divulgadas anteriormente.
- Integraci√≥n de DevOps a trav√©s de una interfaz gr√°fica de usuario simple o mediante el proveedor Terraform, API o la CLI de Akamai
- La detecci√≥n de bots integrada mejora la seguridad y el rendimiento
- Inicio r√°pido con instrucciones en el portal, procedimientos de configuraci√≥n y ajustes del asistente
- Paneles de control personalizados, notificaciones en tiempo real e integraci√≥n SIEM para examinar fallas de seguridad y ataques de clasificaci√≥n
- Los controles de gesti√≥n avanzados de AppSec, los servicios gestionados y los servicios profesionales son opcionales.
- Prevenci√≥n DDoS que responde en segundos a ataques a la capa de aplicaci√≥n

### **Contras**

- La configuraci√≥n y el mantenimiento pueden ser complejos y, en un entorno API grande y sofisticado, la interfaz de administraci√≥n puede ser m√°s dif√≠cil de usar.
- Posibilidad de falsos positivos

### **Precios**

- Akamai no ha proporcionado precios, pero [Azure Marketplace](https://azuremarketplace.microsoft.com/en-ca/marketplace/apps/akamai-technologies.akamai_wap_public?tab=PlansAndPrice) ofrece informaci√≥n sobre precios. Los compradores deben ponerse en contacto con el departamento de ventas de Akamai para obtener un presupuesto personalizado.

## **AppTrana**

**La mejor soluci√≥n WAF asequible para PYMES**

[AppTrana](https://www.indusface.com/web-application-firewall.php) brinda protecci√≥n en tiempo real contra ataques a aplicaciones web mediante la combinaci√≥n de algoritmos de aprendizaje autom√°tico, especialistas en seguridad y un centro de operaciones de seguridad 24 horas al d√≠a, 7 d√≠as a la semana. A diferencia de las soluciones WAF t√≠picas, AppTrana proporciona una soluci√≥n totalmente administrada en la que los profesionales de seguridad de AppTrana administran el WAF en nombre del cliente, lo que permite que el equipo de TI del cliente se centre en otras prioridades. Estos servicios lo distinguen como una opci√≥n distinta y atractiva para las empresas que buscan una forma m√°s sencilla de proteger sus aplicaciones en l√≠nea de los ataques cibern√©ticos.

### **Caracter√≠sticas Clave**

- Capacidad para parchear vulnerabilidades cr√≠ticas en 24 horas
- Mitigaci√≥n ilimitada de DDoS y protecci√≥n contra bots
- Seguridad API
- Cero falsos positivos
- Red de entrega de contenidos

### **Ventajas**

- Ofrece operaciones de seguridad 24 horas al d√≠a, 7 d√≠as a la semana.
- Proporciona cobertura integral contra los 10 principales ataques OWASP, de d√≠a cero , DDoS, bot y API.
- Supervisa sitios web y aplicaciones de forma continua.
- Proporciona detecci√≥n y mitigaci√≥n de ataques web en tiempo real.
- Proporciona un panel f√°cil de usar con informaci√≥n y an√°lisis completos.
- Ofrece una configuraci√≥n sencilla sin instalaci√≥n de hardware ni software.
- Proporciona escalamiento autom√°tico para gestionar picos de tr√°fico inesperados
- Ofrece planes de precios asequibles para empresas de todos los tama√±os.

### **Contras**

- Los usuarios avanzados tienen menos posibilidades de personalizaci√≥n
- Las medidas de seguridad avanzadas pueden necesitar cargos adicionales
- Hay posibilidades limitadas de integraci√≥n con otros programas de seguridad.

### **Precios**

- El plan avanzado comienza en $99/mes. Alternativamente, puede explorar otras opciones de precios en G2 .

## **AWS WAF**

**Lo mejor para la integraci√≥n con otros servicios web de Amazon**

[AWS WAF](https://aws.amazon.com/waf/) es un servicio de firewall de aplicaciones web de Amazon Web Services (AWS) que ayuda a proteger las aplicaciones en l√≠nea de ataques web t√≠picos que podr√≠an alterar la disponibilidad de las aplicaciones, comprometer la seguridad o consumir recursos excesivos. AWS se puede utilizar para definir reglas de seguridad que regulan el tr√°fico de bots y previenen patrones de ataque t√≠picos como la inyecci√≥n SQL y secuencias de comandos entre sitios (XSS) .

### **Caracter√≠sticas Clave**

- Creaci√≥n de reglas personalizadas
- Integraci√≥n con otros servicios de AWS
- Actualizaci√≥n de m√©tricas en vivo
- F√°cil configuraci√≥n de reglas preconfiguradas mediante la consola de administraci√≥n de AWS

### **Ventajas**

- Permite al usuario dise√±ar sus propias reglas que determinan qu√© tr√°fico aceptar o prohibir en las aplicaciones web.
- Compatible con otros servicios de AWS como Amazon CloudFront, Amazon API Gateway y AWS AppSync
- AWS WAF admite listas de control de acceso (ACL) basadas en IP y en recursos
- Se expande de acuerdo con el tama√±o de su aplicaci√≥n y tr√°fico
- Proporciona una colecci√≥n de reglas preconfiguradas, lo que permite una f√°cil implementaci√≥n y configuraci√≥n.

### **Contras**

- Si bien AWS WAF proporciona reglas personalizables, es posible que no proporcione el nivel de personalizaci√≥n necesario para entornos de aplicaciones web m√°s complejos.
- AWS WAF es un cargo adicional adem√°s de los otros servicios de AWS utilizados
- Puede resultar dif√≠cil instalarlo y configurarlo, especialmente para las personas que son nuevas en los servicios de AWS.

### **Precios**

- El precio inicial por ACL web es de $5/mes, m√°s $1/regla WAF y solicitud. AWS proporciona un c√°lculo personalizado [aqu√≠](https://calculator.aws/#/addService/WAF) .

## **Barracuda Web Application Firewall**

### **Lo mejor por su facilidad de uso y configuraci√≥n sencilla.**

[Barracuda Web Application Firewall](https://www.barracuda.com/products/application-protection/web-application-firewall) es un hardware o dispositivo virtual que protege contra numerosos ataques a aplicaciones web y garantiza la entrega segura de aplicaciones. Esto es ideal para empresas que exigen una soluci√≥n WAF integral y f√°cil de usar con capacidades de seguridad avanzadas, como protecci√≥n contra bots y prevenci√≥n de DDoS.

### **Caracter√≠sticas Clave**

- Protecci√≥n contra amenazas en l√≠nea y DDoS
- Capacidad para detener bots maliciosos en seco
- Protecci√≥n de API y aplicaciones m√≥viles
- Restricci√≥n de acceso granular y distribuci√≥n segura de aplicaciones
- Seguridad automatizada
- Informaci√≥n detallada sobre ataques y patrones de tr√°fico.

### **Ventajas**

- F√°cil de implementar y administrar, lo que lo convierte en una excelente opci√≥n para empresas con recursos de TI limitados.
- Proporciona descarga e inspecci√≥n de SSL, lo que ayuda a detectar y prevenir ataques ocultos dentro del tr√°fico cifrado.
- Utiliza el aprendizaje autom√°tico para mejorar la detecci√≥n y respuesta a amenazas, lo que le permite identificar y responder a ataques en tiempo real.
- Proporciona seguridad API completa, que se vuelve cada vez m√°s crucial a medida que m√°s aplicaciones se comunican a trav√©s de API.
- Proporciona protecci√≥n contra las diez amenazas principales de OWASP, incluidas la inyecci√≥n SQL, secuencias de comandos entre sitios y otras.
- Proporciona gesti√≥n e informes centralizados para m√∫ltiples aplicaciones.
- Hay varias opciones de implementaci√≥n disponibles, incluidas las locales, virtuales y en la nube.

### **Contras**

- El costo puede ser m√°s caro que otras soluciones
- La atenci√≥n al cliente no est√° disponible las 24 horas, los 7 d√≠as de la semana
- Algunas funciones pueden requerir la compra de licencias adicionales

### **Precios**

- WAF-as-a-Service para un plan de 50 Mbps comienza en $1,02 por unidad.

**Cloudflare**

**La mejor soluci√≥n WAF basada en la nube con integraci√≥n CDN y an√°lisis en vivo.**

[Cloudflare WAF](https://www.cloudflare.com/waf/) es un firewall de aplicaciones web basado en la nube destinado a proteger sitios web y API de muchas formas de ataques. Ofrece una variedad de medidas de seguridad para ayudar a evitar ataques, as√≠ como beneficios de rendimiento y confiabilidad. Cloudflare WAF ofrece una combinaci√≥n √∫nica de red global, aprendizaje autom√°tico, mitigaci√≥n de bots, interfaz de usuario f√°cil de usar y seguridad DNS .

**Caracter√≠sticas Clave**

- Proporciona una seguridad integral de las aplicaciones, con un motor de reglas √∫nico e integrado para una seguridad efectiva y uniforme.
- Los an√°lisis de seguridad ofrecen informaci√≥n sobre ataques en tiempo real
- Implementaci√≥n r√°pida de protecciones de d√≠a cero para permitir la aplicaci√≥n de parches virtuales instant√°neos . Estas reglas controladas se implementan globalmente en segundos.
- Las salvaguardas del aprendizaje autom√°tico detectan evasiones y ataques
- Conjuntos de reglas administrados para protecci√≥n automatizada contra peligros reconocidos, como OWASP Top 10
- Creaci√≥n de reglas personalizadas

### **Ventajas**

- Implementaciones m√°s r√°pidas y sencillas de instalaciones de seguridad, lo que resulta en mitigaciones m√°s r√°pidas y tiempo de obtenci√≥n de valor.
- Permite crear pol√≠ticas de seguridad propias y prohibir tipos particulares de tr√°fico mediante reglas personalizadas.
- Existen reglas de firewall para evitar el tr√°fico malicioso, como la inyecci√≥n SQL, secuencias de comandos entre sitios (XSS) y otros ataques a aplicaciones web.
- No es necesario comprar ni mantener hardware con la implementaci√≥n basada en la nube
- Un panel de control basado en web simplifica la configuraci√≥n y el mantenimiento.
- Se incluye un nivel gratuito con medidas de seguridad b√°sicas.
- Proporciona beneficios en t√©rminos de rendimiento y confiabilidad, como servicios CDN y equilibrio de carga.

### **Contras**

- Se requiere una membres√≠a de nivel superior para funciones avanzadas como la protecci√≥n de API
- En comparaci√≥n con otras herramientas WAF, tiene menos opciones de personalizaci√≥n.
- En comparaci√≥n con otras herramientas WAF, es posible que no proporcione tanto control granular sobre las pol√≠ticas de seguridad.
- Algunos usuarios se han quejado de falsos positivos y dificultades para configurar conjuntos de reglas.

### **Precios**

- El plan profesional de Cloudflare comienza en $20 al mes. Explore otras opciones de precios en los planes Cloudflare

**F5 Advanced WAF**

**La mejor opci√≥n para capacidades de seguridad avanzadas.**

[F5 Advanced WAF](https://www.f5.com/pt_br/products/security/advanced-waf) (anteriormente conocido como F5 BIG-IP Application Security Manager) es un producto WAF que protege las aplicaciones en l√≠nea combinando filtrado de tr√°fico, protecci√≥n proactiva contra bots, cifrado de capa de aplicaci√≥n y an√°lisis de comportamiento.

F5 Advanced WAF se basa en la tecnolog√≠a probada de F5 y va m√°s all√° de las funciones de seguridad reactiva, como firmas est√°ticas y reputaci√≥n, para identificar y neutralizar bots, salvaguardar contrase√±as y datos confidenciales, y luchar contra la denegaci√≥n de servicio (DoS) de aplicaciones. F5 Advanced WAF es una buena opci√≥n para organizaciones con aplicaciones sofisticadas basadas en web que requieren capacidades de seguridad avanzadas como detecci√≥n automatizada de amenazas y protecci√≥n API.

### **Caracter√≠sticas Clave**

- Capacidades para el aprendizaje autom√°tico avanzado
- Verificaci√≥n SSL/TLS
- Gesti√≥n del tr√°fico y equilibrio de carga.
- Cifrado en la capa de aplicaci√≥n
- An√°lisis de comportamiento

### **Ventajas**

- Ofrece monitoreo de seguridad continuo y an√°lisis de amenazas para descubrir y protegerse contra las amenazas de seguridad m√°s recientes.
- Ofrece reglas personalizadas y control detallado para proteger las aplicaciones y la infraestructura contra amenazas conocidas y en desarrollo.
- Incluye paneles e informes simples para monitorear la situaci√≥n de seguridad de las aplicaciones y brindar informaci√≥n sobre los incidentes de seguridad.
- Se puede integrar f√°cilmente con otros productos F5, como BIG-IP y Silverline, prevenci√≥n DDoS
- Proporciona una variedad de opciones de implementaci√≥n, incluidas configuraciones locales, en la nube e h√≠bridas.

### **Contras**

- F5 Advanced WAF es una soluci√≥n complicada que requiere el uso de expertos y recursos para configurar y mantener
- Los gastos de licencia pueden ser prohibitivamente caros, especialmente para las grandes empresas.
- La implementaci√≥n incorrecta crea problemas de rendimiento
- Carece de interacci√≥n nativa con sistemas en la nube como AWS y Azure, por lo que requiere configuraci√≥n y mantenimiento adicionales.

### **Precios**

- F5 no ha proporcionado informaci√≥n sobre precios para este servicio, pero puede comunicarse con F5 Sales para obtener cotizaciones personalizadas. [Azure Marketplace](https://azuremarketplace.microsoft.com/en-ca/marketplace/apps/f5-networks.f5-big-ip-advanced-waf?tab=PlansAndPrice) tambi√©n ofrece informaci√≥n sobre precios.

## **Fastly**

**La mejor opci√≥n para una soluci√≥n WAF flexible basada en la nube y atenci√≥n al cliente.**

[Fastly Next-gen WAF](https://www.fastly.com/products/web-application-api-protection) es un WAF basado en la nube que proporciona capacidades de seguridad mejoradas para protegerse contra amenazas basadas en la web. Emplea una t√©cnica innovadora creada por Signal Sciences que identifica y bloquea el tr√°fico malicioso sin la necesidad de refinar las reglas, lo que permite a los equipos de AppSec centrarse en problemas m√°s urgentes. Fastly recibi√≥ el premio Gartner Peer Insights Customers' Choice por cinco a√±os consecutivos.

Fastly es la mejor opci√≥n de WAF basado en la nube para empresas que buscan opciones de implementaci√≥n flexibles, disponibilidad de atenci√≥n al cliente y capacidades de respuesta a ataques en tiempo real.

### **Caracter√≠sticas Clave**

- Seguridad de aplicaciones web en tiempo real
- Firewall de aplicaciones web integrado
- Seguridad de robots
- Protecci√≥n DDoS avanzada
- Reglas y pol√≠ticas personalizables
- P√°ginas de respuesta personalizables
- Gesti√≥n e informes centralizados
- seguridad API

### **Ventajas**

- El WAF de pr√≥xima generaci√≥n de Fastly utiliza aprendizaje autom√°tico y an√°lisis de comportamiento para detectar y mitigar amenazas sofisticadas
- Excelente atenci√≥n al cliente
- El sistema de Fastly es capaz de manejar grandes cantidades de tr√°fico y puede escalarse f√°cilmente para adaptarse a la demanda futura.
- La soluci√≥n presenta API integrales para la integraci√≥n del sistema.
- El WAF de Fastly minimiza los falsos positivos y ayuda a las empresas a reducir la necesidad de intervenci√≥n manual
- Proporciona una interfaz de usuario f√°cil de usar y una amplia personalizaci√≥n de reglas.

### **Contras**

- Los informes y la consulta de eventos deben mejorarse en la interfaz.
- El WAF de Fastly puede no ser tan configurable como otras alternativas del mercado
- Dado que la soluci√≥n de Fastly est√° basada principalmente en la nube, puede que no sea la mejor opci√≥n para las organizaciones que necesitan una soluci√≥n local.
- Algunos clientes informan que el sistema puede ser dif√≠cil de instalar y configurar, especialmente para empresas con infraestructuras sofisticadas o requisitos de seguridad.

### **Precios**

- El plan de conexi√≥n segura TLS/SSL comienza en $20,00 por mes, mientras que el plan de ancho de banda y solicitudes comienza en $50,00 por mes. Puedes explorar otras opciones de precios en [Fastly](https://www.fastly.com/pricing?utm_source=saasworthy.com&utm_medium=cpc) .

## **Fortinet FortiWeb**

**Lo mejor para una protecci√≥n integral contra amenazas.**

[Fortinet FortiWeb](https://www.fortinet.com/products/web-application-firewall/fortiweb) protege las aplicaciones en l√≠nea y las API de las 10 principales amenazas de OWASP, ataques distribuidos de denegaci√≥n de servicio y ataques de bots maliciosos. Las funciones avanzadas basadas en ML aumentan la seguridad y al mismo tiempo reducen los costos administrativos. Proporciona detecci√≥n de anomal√≠as, descubrimiento y protecci√≥n de API, mitigaci√≥n de bots y an√°lisis de amenazas avanzado para identificar las amenazas m√°s graves en todas las aplicaciones protegidas.

### **Caracter√≠sticas Clave**

- Protecci√≥n de aplicaciones web
- Detecci√≥n de amenazas basada en ML
- Integraci√≥n del tejido de seguridad
- An√°lisis avanzado
- Mitigaci√≥n de falsos positivos
- Aceleraci√≥n basada en hardware

### **Ventajas**

- Incorpora actualizaciones autom√°ticas para garantizar que est√© continuamente actualizado con la informaci√≥n sobre amenazas y caracter√≠sticas de seguridad m√°s recientes.
- Extremadamente escalable y se puede implementar en una amplia gama de contextos, incluidos los locales, los basados ‚Äã‚Äãen la nube y los h√≠bridos.
- Se integra con otros productos Fortinet como FortiGate, FortiSandbox y FortiSIEM
- Ofrece una amplia seguridad en la capa de aplicaciones, incluidas capacidades como URL y endurecimiento de formularios, seguimiento de sesiones e inspecci√≥n de contenido.
- Emplea potentes algoritmos de detecci√≥n de amenazas para detectar y detener amenazas como ataques de inyecci√≥n SQL, secuencias de comandos entre sitios (XSS) y otras. Tambi√©n proporciona inteligencia sobre amenazas en tiempo real para ayudar en la detecci√≥n de amenazas en desarrollo.

### **Contras**

- Algunos usuarios han informado problemas con la consola de administraci√≥n siendo algo compleja y dif√≠cil de usar.
- Para maximizar la velocidad y reducir los falsos positivos, es posible que sea necesario realizar algunos ajustes y afinaciones.

### **Precios**

- Un paquete est√°ndar de 1 a√±o comienza en $2321. Puede explorar otros paquetes y opciones de precios en [Azure Marketplace](https://azuremarketplace.microsoft.com/en-ca/marketplace/apps/fortinet.fortinet_fortiweb-vm_v5?tab=PlansAndPrice) .

## **Imperva WAF**

**La mejor soluci√≥n WAF de nivel empresarial para protecci√≥n avanzada y soporte al cliente 24 horas al d√≠a, 7 d√≠as a la semana.**

[Imperva](https://www.imperva.com/products/web-application-firewall-waf/) es l√≠der del mercado de protecci√≥n DoS/DDoS y es uno de varios proveedores en esta lista que fue nombrado Elecci√≥n de los Clientes de Gartner Peer Insights en 2023. Imperva es una soluci√≥n de seguridad basada en la nube que defiende las aplicaciones en l√≠nea contra ataques como la inyecci√≥n SQL. , secuencias de comandos entre sitios (XSS) e inclusi√≥n remota de archivos (RFI).

Imperva WAF proporciona capacidades integrales que permiten la prevenci√≥n de amenazas en m√∫ltiples capas, garantizando la seguridad y disponibilidad de las aplicaciones en l√≠nea.

### **Caracter√≠sticas Clave**

- Protecci√≥n sin falsos positivos WAF
- Creaci√≥n de pol√≠ticas automatizada
- Ofrece seguridad para aplicaciones activas y heredadas, aplicaciones de terceros, API y microservicios, y aplicaciones en la nube, contenedores, m√°quinas virtuales y m√°s.
- Detecci√≥n de amenazas en tiempo real
- Detecci√≥n de comportamiento para detectar y prevenir ataques de d√≠a cero

### **Ventajas**

- Implementaci√≥n perfecta y no requiere hardware local
- Proporciona soporte al cliente 24 horas al d√≠a, 7 d√≠as a la semana
- El costo es menor en comparaci√≥n con otras herramientas WAF
- Las reglas y pol√≠ticas se pueden personalizar para un control granular sobre la configuraci√≥n de seguridad.
- La soluci√≥n protege contra ataques y vulnerabilidades en tiempo real, lo que reduce el riesgo de filtraciones de datos y tiempo de inactividad que otras soluciones WAF pueden pasar por alto.
- Capaz de detectar ataques de d√≠a cero gracias a la funci√≥n de detecci√≥n basada en el comportamiento.
- La tecnolog√≠a es extremadamente flexible, lo que permite a las empresas crear reglas y pol√≠ticas que se adaptan a sus requisitos de seguridad espec√≠ficos.
- Imperva WAF trabaja con las principales soluciones SIEM para proporcionar inteligencia sobre amenazas mejorada y mejorar las capacidades de respuesta a incidentes.

### **Contras**

- Los usuarios informan cambios frecuentes en la interfaz de usuario, lo que requiere una nueva curva de aprendizaje para los cambios.
- Los informes, la complejidad de la interfaz de usuario y las reglas de protecci√≥n avanzada de BOT no son intuitivas, seg√∫n algunos usuarios
- Aunque Imperva ofrece costos de planes m√°s bajos, algunos planes a√∫n pueden ser m√°s caros, especialmente para las grandes empresas.
- Para aprovechar al m√°ximo todas las caracter√≠sticas y capacidades de la soluci√≥n, es posible que se requiera algo de capacitaci√≥n.
- Debido al grado de personalizaci√≥n ofrecido, el proceso de implementaci√≥n puede tardar m√°s que con soluciones WAF comparables.

### **Precios**

- El plan Pro comienza en $59 por sitio por mes

## **Microsoft Azure Application Gateway**

**Lo mejor para escalabilidad e integraci√≥n con servicios de Azure.**

[Microsoft Azure Application Gateway WAF](https://learn.microsoft.com/en-us/azure/web-application-firewall/ag/ag-overview) es un servicio de firewall de aplicaciones web que est√° integrado con Azure Application Gateway. Proporciona seguridad centralizada para aplicaciones en l√≠nea contra vulnerabilidades y exploits comunes. Entre los ataques m√°s frecuentes protegidos por Azure se encuentran la inyecci√≥n SQL, las secuencias de comandos entre sitios y la falsificaci√≥n de solicitudes entre sitios.

### **Caracter√≠sticas Clave**

- Protecci√≥n de inyecci√≥n SQL
- Protecci√≥n de secuencias de comandos entre sitios
- Protecci√≥n contra otros ataques web comunes, como inyecci√≥n de comandos, contrabando de solicitudes HTTP, divisi√≥n de respuestas HTTP e inclusi√≥n remota de archivos.
- Protecci√≥n contra violaciones y anomal√≠as del protocolo HTTP, como falta de agente de usuario del host y encabezados de aceptaci√≥n
- Protecci√≥n contra rastreadores y esc√°neres
- Detecci√≥n de configuraciones err√≥neas comunes de aplicaciones (por ejemplo, Apache e IIS)
- L√≠mites de tama√±o de solicitud configurables con l√≠mites superior e inferior
- Listas de exclusi√≥n para omitir ciertos atributos de solicitud de una evaluaci√≥n WAF
- Cree reglas personalizadas para satisfacer las necesidades espec√≠ficas de sus aplicaciones.
- Filtre geogr√°ficamente el tr√°fico para permitir o bloquear el acceso de ciertos pa√≠ses/regiones a sus aplicaciones.
- Protecci√≥n contra bots con el conjunto de reglas de mitigaci√≥n de bots
- Inspecci√≥n de JSON y XML en el cuerpo de la solicitud.

### **Ventajas**

- Ofrece integraci√≥n de servicios de Azure.
- F√°cil de configurar y administrar
- Admite equilibrio de carga en las capas 4 y 7
- Mejora el rendimiento y la disponibilidad con el escalado autom√°tico
- Supervisa y alerta sobre la detecci√≥n de amenazas y la informaci√≥n en tiempo real.

### **Contras**

- Las posibilidades de personalizaci√≥n son limitadas en comparaci√≥n con otros sistemas WAF.
- Mayor costo en comparaci√≥n con otras herramientas WAF
- La capacidad de integraci√≥n con entornos que no son de Azure es limitada

### **Precios**

- Azure ofrece precios de pago por uso. Explore las opciones de precios [aqu√≠](https://azure.microsoft.com/en-us/pricing/details/web-application-firewall/) .

## **Radioware**

**Lo mejor para capacidades avanzadas de detecci√≥n y mitigaci√≥n de amenazas basadas en aprendizaje autom√°tico.**

[El servicio Radware Cloud WAF](https://www.radware.com/products/cloud-waf-service/) protege las aplicaciones en l√≠nea con seguridad de nivel empresarial y continuamente adaptable. Se basa en el firewall de aplicaciones web certificado por ICSA Labs de Radware y proporciona una cobertura integral de las 10 amenazas principales de OWASP mientras adapta din√°micamente las defensas a las amenazas emergentes y los activos protegidos.

### **Caracter√≠sticas Clave**

- Cobertura completa de los 10 ataques principales de OWASP
- Proporciona protecci√≥n contra ataques web de d√≠a cero
- Genera autom√°ticamente pol√≠ticas para nuevas aplicaciones.
- "Panel de cristal" √∫nico con portal unificado totalmente administrado por el equipo de respuesta a emergencias de Radware
- Monitoreo y generaci√≥n de informes en tiempo real de insights
- Protecci√≥n DDoS
- Enfoque de seguridad multicapa

### **Ventajas**

- Proporciona protecci√≥n de seguridad web integral, incluida la cobertura OWASP Top 10, prevenci√≥n de ataques avanzada y protecci√≥n contra ataques de d√≠a cero.
- A trav√©s de la tecnolog√≠a de generaci√≥n autom√°tica de pol√≠ticas, detecta y protege nuevas aplicaciones web a medida que se agregan a la [red .](https://www.esecurityplanet.com/networks/network-security/)
- Una estrategia de seguridad de m√∫ltiples capas garantiza una protecci√≥n completa
- Formulaci√≥n y mantenimiento automatizados de pol√≠ticas de seguridad.
- La integraci√≥n de diferentes tecnolog√≠as de seguridad mejora la postura general de seguridad.
- La defensa DDoS a√±ade un grado extra de seguridad
- Flexibilidad de implementaci√≥n opcional

### **Contras**

- La interfaz de usuario y el procedimiento de configuraci√≥n de pol√≠ticas son complejos
- No hay suficiente documentaci√≥n ni recursos para solucionar problemas

### **Precios**

- El precio depende de su plan personalizado. Puede explorar las diferentes opciones de precios de Radware [aqu√≠](https://www.radware.com/cyberpedia/application-security/web-application-firewall-waf-pricing/#WAFPricingModelsComparison) .

## **Wallarm WAF**

**La mejor soluci√≥n WAF basada en IA para la detecci√≥n de amenazas en tiempo real en contenedores y microservicios.**

[Wallarm WAF](https://www.wallarm.com/product/cloud-waf) es un firewall de aplicaciones web impulsado por IA que protege las API y las aplicaciones en tiempo real con Cloud Web Application y API Protection (WAAP) con soporte API integral para REST, SOAP, WebSocket, graphQL y gRPC. Con una √∫nica actualizaci√≥n de DNS, Wallarm Cloud WAF protege sus aplicaciones, API y cargas de trabajo sin servidor.

### **Caracter√≠sticas Clave**

- Identificaci√≥n y mitigaci√≥n de amenazas impulsadas por IA
- Seguridad API en tiempo real
- Informes y an√°lisis completos
- Integraci√≥n con herramientas CI/CD conocidas
- Detecci√≥n y parcheo de vulnerabilidades automatizados
- Pol√≠ticas y regulaciones de WAF personalizables

### **Ventajas**

- Seguridad basada en inteligencia artificial
- Altamente adaptable
- Minimiza el riesgo de falsos positivos.
- Ofrece una interfaz que es r√°pida y sencilla de utilizar.
- Genera monitoreo e informes en tiempo real.
- Proporciona protecci√≥n API avanzada
- Permite una integraci√≥n sencilla con los procedimientos de DevOps.

### **Contras**

- No hay soporte para la implementaci√≥n local
- Algunos usuarios informan problemas con la precisi√≥n de la detecci√≥n de amenazas
- La configuraci√≥n y el mantenimiento pueden requerir algunos conocimientos t√©cnicos complejos.
- Soporte limitado para algunos lenguajes de programaci√≥n.

### **Precios**

- Wallarm no ha proporcionado informaci√≥n sobre precios para este servicio, pero puede comunicarse con Wallarm Sales para conocer sus planes de suscripci√≥n. [Azure Marketplace](https://azuremarketplace.microsoft.com/en-ca/marketplace/apps/wallarm.wallarm-ng-waf-offer-1?tab=PlansAndPrice) tambi√©n ofrece informaci√≥n sobre los precios y planes de Wallarm.

## **C√≥mo elegir un proveedor de WAF**

Adem√°s de las funciones y opciones de implementaci√≥n, los compradores de WAF deben buscar una soluci√≥n que ofrezca las capacidades de seguridad y administraci√≥n que necesitan. Algunos importantes a considerar:

- Descubre y corrige las vulnerabilidades de las aplicaciones de manera efectiva y exhaustiva de manera oportuna.
- Detecta constantemente nuevas amenazas y ataques DDoS
- Se ajusta al presupuesto de la organizaci√≥n y es asequible. En comparaci√≥n con los WAF locales, los WAF basados ‚Äã‚Äãen la nube suelen tener tarifas de suscripci√≥n mensuales m√°s bajas y actualizaciones m√°s r√°pidas.
- Permite una adaptaci√≥n de reglas simple para superar fallas en la l√≥gica empresarial.
- Permite al equipo de seguridad elegir el curso de acci√≥n adecuado para las solicitudes (bloqueo, se√±alizaci√≥n, desaf√≠o)
- Proporciona una s√≥lida defensa contra una amplia gama de amenazas cibern√©ticas, incluidas la inyecci√≥n SQL, secuencias de comandos entre sitios y otras formas de ataques.
- Es sencillo de implementar, configurar y administrar, especialmente en organizaciones que no cuentan con profesionales de seguridad especializados.
- Puede gestionar altos niveles de tr√°fico web y al mismo tiempo proteger contra ataques DDoS a gran escala.
- Permite la personalizaci√≥n de reglas para cumplir con los requisitos de la industria y proteger contra peligros √∫nicos.
- Se integra con otras soluciones de seguridad, como redes de entrega de contenido (CDN) o balanceadores de carga, sin esfuerzo
- Proporciona amplia documentaci√≥n y soporte para ayudar a las empresas a aprovechar al m√°ximo sus soluciones WAF.

### **Conclusi√≥n: firewalls de aplicaciones web**

Al seleccionar los productos WAF para esta lista, buscamos aquellos que ofrecieran una combinaci√≥n √≥ptima de protecci√≥n, escalabilidad, facilidad de uso, personalizaci√≥n, integraci√≥n y soporte, junto con factores como precio, reputaci√≥n y comentarios de los clientes. Analizamos a los proveedores de WAF utilizando m√∫ltiples puntos de datos y caracter√≠sticas del producto, incluidas fuentes como documentaci√≥n de proveedores, informes de analistas, datos de seguridad y rese√±as de usuarios.

Cada organizaci√≥n deber√° equilibrar sus necesidades de aspectos como la facilidad de uso y la alta seguridad con los recursos y la experiencia disponibles.

Las soluciones de firewall de aplicaciones web (WAF) son una herramienta fundamental para proteger las aplicaciones web de una variedad de amenazas cibern√©ticas, incluidas la inyecci√≥n SQL, secuencias de comandos entre sitios, ataques DDoS y m√°s. Cada herramienta WAF tiene su propio conjunto de capacidades, fortalezas y debilidades.

Los WAF basados ‚Äã‚Äãen la nube suelen ser menos costosos y proporcionan actualizaciones m√°s r√°pidas que los WAF locales. Las soluciones WAF que incluyen inteligencia artificial y aprendizaje autom√°tico pueden ofrecer una protecci√≥n m√°s avanzada y proactiva contra amenazas emergentes.

Los compradores deben analizar varios proveedores y productos de WAF para encontrar la mejor opci√≥n para sus necesidades. En √∫ltima instancia, la mejor soluci√≥n WAF est√° determinada por las necesidades y requisitos espec√≠ficos de la empresa.

## **El mejor firewall de aplicaciones web de c√≥digo abierto**

Miles de sitios web son hackeados todos los d√≠as debido a una mala configuraci√≥n o a un c√≥digo vulnerable. Web Application Firewall (WAF) es una de las mejores formas de proteger su sitio web de las amenazas en l√≠nea. Si su sitio web est√° disponible en Internet, puede utilizar herramientas en l√≠nea para escanear un sitio web en busca de vulnerabilidades y tener una idea de qu√© tan seguro es su sitio web. No te preocupes si se trata de un sitio web de intranet; puede utilizar el esc√°ner de servidor web Nikto de c√≥digo abierto.

El WAF comercial puede ser costoso y, si est√° buscando una soluci√≥n gratuita para proteger su sitio web mediante WAF, el siguiente firewall de aplicaciones web de c√≥digo abierto puede resultarle √∫til.

### **ModSeguridad**

[ModSecurity](https://github.com/SpiderLabs/ModSecurity) de TrustWave es uno de los firewalls de aplicaciones web m√°s populares y es compatible con Apache HTTP, Microsoft IIS y Nginx.

Las reglas gratuitas de ModSecurity ser√°n √∫tiles si busca la siguiente protecci√≥n.

- secuencias de comandos entre sitios
- troyano
- Fuga de informaci√≥n
- inyecci√≥n SQL
- Ataques web comunes
- Actividad maliciosa

ModSecurity no tiene una interfaz gr√°fica y, si est√° buscando una, puede considerar usar [WAF-FLE](https://github.com/klaubert/waf-fle) . Le permite almacenar, buscar y ver el evento en una consola.

![WAF-FLE](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/waf-fle.png?raw=true)

**NAXSI**

[NAXSI](https://github.com/nbs-system/naxsi) es Nginx Anti-XSS e inyecci√≥n SQL. Entonces, como puede adivinar, esto es solo para el servidor web Nginx y su objetivo principal es proteger contra ataques de inyecci√≥n SQL y secuencias de comandos entre sitios. NAXSI filtra solo las solicitudes GET y PUT, y la configuraci√≥n predeterminada actuar√° como un firewall DROP por defecto, por lo que debes agregar la regla ACCEPT para que funcione correctamente.

![NAXSI](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/naxsi.png?raw=true)

**[WebKnight](https://www.iis.net/downloads/community/2016/04/aqtronix-webknight)**

[WebKnight](https://www.iis.net/downloads/community/2016/04/aqtronix-webknight) WAF es para Microsoft IIS. Es un filtro ISAPI que protege su servidor web bloqueando solicitudes incorrectas. WebKnight es √∫til para proteger lo siguiente.

- Desbordamiento del b√∫fer
- Directorio transversal
- Codificaci√≥n de caracteres
- inyecci√≥n SQL
- Bloquear robots malos
- Enlace directo
- Fuerza bruta
- Y mucho m√°s‚Ä¶

![webKnight](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/webKnight.png?raw=true)

En una configuraci√≥n predeterminada, todas las solicitudes bloqueadas se registran y usted puede personalizarlas seg√∫n sus necesidades. WebKnight 3.0 tiene una interfaz web de administraci√≥n donde puede personalizar las reglas y realizar tareas de administraci√≥n, incluidas estad√≠sticas.

**[Shadow Daemon](https://github.com/zecure/shadowd)**

[Shadow Daemon](https://github.com/zecure/shadowd) detecta, registra y previene ataques web filtrando solicitudes de par√°metros maliciosos. Viene con una interfaz propia donde puedes realizar la administraci√≥n y gestionar este WAF. Es compatible con el marco de lenguaje PHP, Perl y Python.

Puede detectar los siguientes ataques.

- inyecci√≥n SQL
- Inyecci√≥n XML
- inyecci√≥n de c√≥digo
- inyecci√≥n de comando
- XSS
- Acceso por puerta trasera
- Inclusi√≥n de archivos locales/remotos

![shadow-daemon](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/shadow-daemon.png?raw=true)

### **¬øQu√© es modSecurity?**

**modSecurity** es un firewall de aplicaciones Web embebible bajo licencia GNU que se ejecuta como m√≥dulo del servidor web Apache, provee protecci√≥n contra diversos ataques hacia aplicaciones Web y permite monitorizar tr√°fico HTTP, as√≠ como realizar an√°lisis en tiempo real sin necesidad de hacer cambios a la infraestructura existente. **modSecurity** filtra ataques por XSS, SQL Injection, comportamientos an√≥malos en protocolos, robots, troyanos, LFI... incorporando adem√°s reglas espec√≠ficas para algunos de los gestores de contenido m√°s populares como Joomla o Wordpress.

Soporta integraci√≥n con ModProxy por lo que podemos proteger aplicaciones desplegadas en otros servidores gracias a esta integraci√≥n. Adem√°s **modSecurity** cuenta con una consola de administraci√≥n que permite recopilar registros de monitorizaci√≥n y alertas en tiempo real as√≠ como de opciones automatizadas de mantenimiento, entre otras caracter√≠sticas.

![modsecurity](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/modsecurity.png?raw=true)

### **Instalaci√≥n de modSecurity**

A continuaci√≥n vamos a describir el proceso de instalaci√≥n de modSecurity 2.7 en Debian, en Ubuntu est√° disponible en los repositorios. Las descargas necesarias podemos realizar desde la web oficial del proyecto [http://www.modsecurity.org/](http://www.modsecurity.org/)

**1.- Descargamos las fuentes y descomprimimos:**

> wget [https://www.modsecurity.org/tarball/2.7.5/modsecurity-apache_2.7.5.tar.gz](https://www.modsecurity.org/tarball/2.7.5/modsecurity-apache_2.7.5.tar.gz) 

> tar -zxvf modsecurity-apache_2.7.5.tar.gz

**2.- Instalamos algunas dependencias necesarias:**

> apt-getinstall apache2-threaded-dev libxml2-dev libcurl4-gnutls-dev -y

**3- Compilamos e instalamos:**

> cd modsecurity-apache_2.7.5
> 
> 
> ./configure
> 
> make
> 
> make install

**4.- Cargamos el m√≥dulo:** Creamos el siguiente fichero

> vim /etc/apache2/mods-available/mod-security2.load
> 
> con el siguiente contenido:
> 
> LoadFile /usr/lib/libxml2.so
> 
> LoadFile /usr/lib/liblua5.1.so.0
> 
> LoadModule security2_module /usr/lib/apache2/modules/mod_security2.so

**5.- Activamos modSecurity:** Antes de activar modSecurity debemos activar unique_id

> a2enmod unique_id
> 
> y activamos modSecurity ahora:
> 
> a2enmod mod-security2

**6.-Configuramos las reglas:** Una vez hemos instalado modSecurity es necesario establecer las reglas que establecer√°n las condiciones del filtrado de m√©todos. Descargamos las reglas de filtrado en /etc/apache2:

> cd/etc/apache2
> 
> apt-get install git
> 
> git clone[https://github.com/SpiderLabs/owasp-modsecurity-crs](https://github.com/SpiderLabs/owasp-modsecurity-crs)

Una vez descargado veremos varios directorios adem√°s de diversas utilidades. Para una primera aproximaci√≥n renombraremos modsecurity_crs_10_config.conf.example a modsecurity_crs_10_config.conf:

> cp modsecurity_crs_10_config.conf.example modsecurity_crs_10_config.conf

Para finalizar editamos apache2.conf con el siguiente contenido: vim /etc/apache2/apache2.conf

SecRuleEngine On

SecRequestBodyAccess On

SecResponseBodyAccess Off

SecDebugLog /var/log/apache2/modsec_debug.log

SecDebugLogLevel 1

SecAuditEngine RelevantOnly

SecAuditLogRelevantStatus ^5

SecAuditLogParts ABIFHZ

SecAuditLogType Serial

SecAuditLog /var/log/apache2/modsec_audit.log

SecRequestBodyLimit 131072

SecRequestBodyInMemoryLimit 131072

SecResponseBodyLimit 524288

SecDataDir¬† /tmp/

SecUploadDir /tmp/

SecTmpDir /tmp/

Include owasp-modsecurity-crs/modsecurity_crs_10_config.conf

Include owasp-modsecurity-crs/base_rules/*.conf

Include owasp-modsecurity-crs/optional_rules/*.conf

Include owasp-modsecurity-crs/slr_rules/*.conf

Hay que ser cuidadoso con SecDataDir, SecUploadDir y SecTmpDir ya que las aplicaciones que suban ficheros y usen temporales no van a funcionar. De forma similar, hay que prestar atenci√≥n a posibles configuraciones de los atributos SecRequestBodyLimit, SecRequestBodyInMemoryLimit, SecResponseBodyLimit que se suelen definir en el archivo apache2.conf.

Estas configuraciones nos va determinar las caracter√≠sticas de subida de archivos a trav√©s de nuestras aplicaciones web. Si todo ha ido bien, pronto comenzaremos a ver en nuestro archivo de logs de Apache, decenas por no decir centenares de logs de este tipo:

> [client 192.168.1.154] ModSecurity: Access denied withcode 403(phase 2).
> 
> Pattern match "^[\\\\d.:]+$"at REQUEST_HEADERS:Host.
> 
> [file "owasp-modsecurity-crsbase_rules/modsecurity_crs_21_protocol_anomalies.conf"]
> 
> [line "98"] [id "960017"]
> 

Si queremos ampliar el potencial de filtrado de nuestro m√≥dulo podemos acudir a [http://www.gotroot.com/mod_security+rules](https://wiki.atomicorp.com/wiki/index.php/Atomic_ModSecurity_Rules) y descargarnos libremente sus colecciones de reglas propias. Espero que esta primera introducci√≥n a modSecurity les sirva para reforzar la seguridad de sus servidores web Apache, tarea primordial en estos tiempos.

BAS: Breach and attack simulation

### **¬øQu√© es la simulaci√≥n de ataques e infracciones (BAS)?**

La simulaci√≥n de infracciones y ataques (BAS) es un enfoque innovador de ciberseguridad que utiliza herramientas automatizadas para simular continuamente el ciclo de vida completo del ataque contra la infraestructura de una organizaci√≥n.

Al emplear soluciones BAS, las organizaciones pueden identificar vulnerabilidades, priorizar los esfuerzos de remediaci√≥n y mejorar sus capacidades de detecci√≥n y mitigaci√≥n de amenazas. Con informes en tiempo real e informaci√≥n procesable, estas soluciones permiten a los equipos de seguridad tomar decisiones informadas y adoptar un enfoque de ciberseguridad centrado en las amenazas.

Como resultado, BAS se ha convertido en un componente esencial de las mejores pr√°cticas de seguridad empresarial modernas, ayudando a las organizaciones a estar un paso por delante de las amenazas cibern√©ticas.

### **¬øQu√© es la simulaci√≥n de ataques e infracciones (BAS)?**

La simulaci√≥n de infracciones y ataques (BAS) es un enfoque de evaluaci√≥n de seguridad proactiva que permite a las organizaciones evaluar su postura de seguridad simulando ciberataques del mundo real y generando resultados procesables. Este enfoque de vanguardia complementa los m√©todos de evaluaci√≥n tradicionales, como el escaneo de vulnerabilidades, las pruebas de penetraci√≥n y el equipo rojo, para proporcionar una evaluaci√≥n integral de la postura de seguridad de una organizaci√≥n.

Al simular varios vectores de ataque, incluidos ataques de infiltraci√≥n de red y correo electr√≥nico, movimiento lateral y exfiltraci√≥n de datos, las soluciones BAS ayudan a las organizaciones a identificar vulnerabilidades y debilidades potenciales en sus sistemas antes de que atacantes puedan explotarlas. Estas simulaciones generan informes detallados que resaltan las brechas de seguridad, lo que permite a las organizaciones priorizar los esfuerzos de remediaci√≥n seg√∫n el nivel de riesgo.

### **¬øC√≥mo funciona una simulaci√≥n de ataque e infracci√≥n (BAS)?**

BAS funciona **imitando las t√°cticas, t√©cnicas y procedimientos (TTP) utilizados por los ciberdelincuentes** para identificar vulnerabilidades y evaluar la eficacia de los controles de seguridad de una organizaci√≥n.

El proceso BAS normalmente comienza con la selecci√≥n de un escenario, que podr√≠a basarse en

- Amenazas emergentes
- Situaciones definidas a medida
- Patrones de ataque conocidos aprovechados en la naturaleza
- Grupos de amenazas persistentes avanzadas (APT) que se dirigen especialmente a su industria.

![BAS](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/bas.png?raw=true)

A continuaci√≥n, la plataforma BAS **despliega agentes** (en algunos casos especiales, por ejemplo, en pruebas contra ataques de movimiento lateral, las soluciones de simulaci√≥n no despliegan un agente sino un implante que s√≥lo se ejecuta en la RAM para imitar ataques sigilosos) dentro de la red de la organizaci√≥n para imitar el comportamiento de un agresor. Estos agentes intentan infiltrarse en la red, explotar vulnerabilidades y moverse lateralmente para acceder a activos cr√≠ticos o datos confidenciales.

Durante la simulaci√≥n, la **plataforma BAS monitorea continuamente los controles de seguridad de la organizaci√≥n**, incluidos, entre otros,

- Firewalls de pr√≥xima generaci√≥n (NGFW),
- Sistemas de Detecci√≥n de Intrusos (IDS),
- Sistemas de Prevenci√≥n de Intrusiones (IPS),
- Software antivirus y antimalware,
- Detecci√≥n y respuesta de terminales (EDR),
- Prevenci√≥n de fuga de datos (DLP),
- Soluciones de gesti√≥n de eventos e informaci√≥n de seguridad (SIEM),
- Puertas de enlace de correo electr√≥nico y evaluar su eficacia en la detecci√≥n, prevenci√≥n y mitigaci√≥n del ataque simulado.

La plataforma tambi√©n **recopila datos valiosos sobre el progreso del ataque** , proporcionando a la organizaci√≥n informaci√≥n sobre los **riesgos potenciales y las brechas en su postura de seguridad**.

Al finalizar la simulaci√≥n, la plataforma BAS genera un informe completo que detalla los hallazgos, incluidas las vulnerabilidades descubiertas, el desempe√±o del control de seguridad y recomendaciones para su soluci√≥n. Esta informaci√≥n permite a las organizaciones priorizar las mejoras de seguridad y protegerse mejor contra amenazas cibern√©ticas reales.

Al ofrecer un entorno seguro y controlado para pruebas de ciberseguridad, BAS permite a las organizaciones identificar y abordar vulnerabilidades antes de que puedan ser explotadas por atacantes reales, mejorando en √∫ltima instancia su postura general de seguridad.

### **¬øPor qu√© es importante la simulaci√≥n de ataques e infracciones (BAS)?**

La simulaci√≥n de infracciones y ataques (BAS) es importante porque permite a las organizaciones **evaluar de forma proactiva su postura de seguridad** e **identificar vulnerabilidades antes de que sean explotadas por ciberdelincuentes reales** . A trav√©s de la simulaci√≥n de escenarios de ataques del mundo real, BAS proporciona informaci√≥n valiosa sobre la eficacia de los controles de seguridad y destaca √°reas de mejora.

Una soluci√≥n BAS ayuda a las organizaciones

- **priorizar las inversiones en seguridad**.
- **mitigar los riesgos potenciales**.
- **Minimizar la probabilidad de que se produzcan ciberataques exitosos**.

A medida que el panorama de las amenazas cibern√©ticas contin√∫a evolucionando, BAS se ha convertido en un componente crucial de una estrategia integral de ciberseguridad, garantizando que las organizaciones est√©n un paso por delante de los atacantes y mantengan una defensa s√≥lida contra posibles infracciones.

### **¬øCu√°les son los beneficios de una simulaci√≥n automatizada de ataques e infracciones (BAS)?**

Hay tres beneficios principales de una soluci√≥n BAS.

- **Pruebas Continuas de Controles de Seguridad**.
- **Integraci√≥n del marco MITRE ATT&CK**.
- **Resultados procesables y sugerencias de mitigaci√≥n**.

En las siguientes secciones, ofrecemos una explicaci√≥n concisa de cada uno de estos tres aspectos clave.

### **Pruebas continuas de controles de seguridad**

Aunque las pr√°cticas de seguridad tradicionales como Red Teaming y Penetration Testing requieren profesionales de seguridad ofensiva h√°biles para llevar a cabo evaluaciones de seguridad en la infraestructura de las organizaciones, dichos m√©todos no logran medir la efectividad de los controles de seguridad porque los controles de seguridad tradicionales

- **Tiene un alcance de prueba limitado**.
- **Dependen en gran medida de las habilidades de los operadores humanos**.
- **Consumen muchos recursos**.
- **No proporcionan resultados consistentes**.
- **Se llevan a cabo en un √∫nico momento en el tiempo**.

Por otro lado, las soluciones de simulaci√≥n de ataques y violaciones (BAS) permiten a las organizaciones identificar debilidades de prevenci√≥n y detecci√≥n en sus sistemas de defensa mediante la evaluaci√≥n continua y proactiva de la efectividad de los controles de seguridad existentes:

![BAS1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/bas1.png?raw=true)

Resultados generales de prevenci√≥n y detecci√≥n de un host arbitrario de la plataforma de validaci√≥n de control de seguridad continuo Picus.

Estas simulaciones se pueden programar las 24 horas del d√≠a, los 7 d√≠as de la semana, lo que proporciona un enfoque flexible para evaluar y fortalecer la postura de seguridad de una organizaci√≥n.

### **Poniendo en funcionamiento el marco MITRE ATT&CK**

La integraci√≥n del marco MITRE ATT&CK en una soluci√≥n BAS ofrece a los profesionales de la seguridad un recurso valioso para comprender y abordar t√©cnicas adversas. Al **mapear cada t√©cnica de ataque** dentro del marco, permite simulaciones personalizables dirigidas a grupos de amenazas espec√≠ficos, mejorando la precisi√≥n y eficacia de las evaluaciones de seguridad.

![MITRE ATT&CK](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/mitre-attt&ck.png?raw=true)

Integraci√≥n del marco MITRE ATT&CK con simulaci√≥n de ataques y violaciones (BAS). Esto permite a las organizaciones mejorar su detecci√≥n, mitigaci√≥n y postura general de seguridad de amenazas.

### **Resultados procesables y sugerencias de mitigaci√≥n**

Uno de los beneficios m√°s importantes de las soluciones BAS es su capacidad para proporcionar resultados procesables y sugerencias de mitigaci√≥n basadas en datos, que son esenciales para una gesti√≥n de riesgos y una toma de decisiones eficaces.

- **Informaci√≥n detallada**

Las soluciones BAS ofrecen informaci√≥n detallada sobre la postura de seguridad de una organizaci√≥n, destacando vulnerabilidades espec√≠ficas, configuraciones err√≥neas y brechas en los controles de seguridad. Este nivel de detalle permite a los equipos de seguridad identificar las √°reas exactas que requieren atenci√≥n, lo que les ayuda a asignar recursos de manera m√°s eficiente.

- **Priorizaci√≥n basada en datos**

Al analizar los resultados de la simulaci√≥n, las soluciones BAS permiten a las organizaciones priorizar las vulnerabilidades en funci√≥n de su posible impacto y explotabilidad. Este enfoque basado en datos garantiza que las amenazas m√°s cr√≠ticas se abordan primero, minimizando el riesgo de una infracci√≥n exitosa.

- **Recomendaciones contextuales de mitigaci√≥n**

Las soluciones BAS brindan sugerencias de mitigaci√≥n basadas en el contexto, teniendo en cuenta factores como la infraestructura de la organizaci√≥n, los controles de seguridad existentes y el panorama de amenazas. Estas recomendaciones personalizadas gu√≠an a los equipos de seguridad en la implementaci√≥n de estrategias de remediaci√≥n espec√≠ficas, como aplicar parches, actualizar configuraciones o implementar nuevas medidas de seguridad, para abordar de manera efectiva las debilidades identificadas.

- **Tiempo reducido para la remediaci√≥n**

A trav√©s de simulaciones continuas e informes en tiempo real, las soluciones BAS ayudan a los equipos de seguridad a identificar y remediar vulnerabilidades m√°s r√°pido que los m√©todos de evaluaci√≥n tradicionales. Esta reducci√≥n del tiempo necesario para la reparaci√≥n minimiza la ventana de oportunidad para los atacantes, lo que aumenta la seguridad y la resiliencia generales de la organizaci√≥n.

Al ofrecer resultados procesables y sugerencias de mitigaci√≥n basadas en datos, las soluciones BAS permiten a las organizaciones tomar decisiones informadas y optimizar sus inversiones en seguridad, mejorando en √∫ltima instancia su capacidad para defenderse contra las amenazas cibern√©ticas en evoluci√≥n.

### **¬øQu√© tipos de ataques se pueden simular con BAS?**

Las plataformas de simulaci√≥n de ataques y violaciones (BAS) est√°n dise√±adas para simular una amplia gama de escenarios de ataque, cubriendo diversas t√°cticas, t√©cnicas y procedimientos (TTP) empleados por los ciberdelincuentes. Algunos tipos comunes de ataques que se pueden simular con BAS incluyen:

- **Ataques de infiltraci√≥n de correo electr√≥nico**

Las plataformas BAS pueden simular ataques de infiltraci√≥n de correo electr√≥nico enviando correos electr√≥nicos maliciosos a direcciones espec√≠ficas dentro de una organizaci√≥n, con el objetivo principal de probar los controles de seguridad de la puerta de enlace de correo electr√≥nico. Estas simulaciones implican **el env√≠o de correos electr√≥nicos que contienen archivos adjuntos o enlaces maliciosos para evaluar la eficacia de los sistemas de filtrado de correo electr√≥nico** y las pol√≠ticas de seguridad de la organizaci√≥n.

Durante la simulaci√≥n, no se requiere ni se espera interacci√≥n humana. El objetivo principal es **evaluar si las puertas de enlace de correo electr√≥nico pueden bloquear eficazmente los correos electr√≥nicos maliciosos** o, al menos, **eliminar o poner en cuarentena los archivos adjuntos maliciosos** . Al identificar posibles debilidades en la seguridad de la puerta de enlace del correo electr√≥nico y los mecanismos de filtrado, las plataformas BAS permiten a las organizaciones mejorar sus defensas contra las amenazas transmitidas por el correo electr√≥nico y reducir el riesgo de ataques de infiltraci√≥n exitosos.

- **Malware y ransomware**

Las plataformas BAS pueden simular con precisi√≥n el comportamiento de diversas infecciones de malware y ransomware, incluido malware de descarga o limpieza, ladrones de informaci√≥n sigilosos o puertas traseras para probar la eficacia de las soluciones de protecci√≥n de endpoints, los mecanismos de detecci√≥n de amenazas y las capacidades de respuesta a incidentes.

Al simular ataques del mundo real, BAS permite a las organizaciones evaluar su capacidad para prevenir, detectar y remediar infecciones de malware, incluso cuando estas amenazas contin√∫an evolucionando. Al identificar posibles debilidades y brechas en sus controles de seguridad, las organizaciones pueden priorizar las mejoras de seguridad y desarrollar defensas m√°s s√≥lidas para protegerse mejor contra el panorama cada vez mayor de amenazas de malware y ransomware.

- **Ataques con credenciales comprometidas y amenazas internas**

BAS puede simular ataques sofisticados basados ‚Äã‚Äãen credenciales que aprovechan m√©todos de acceso avanzados, como **el volcado del Servicio del Subsistema de la Autoridad de Seguridad Local (LSASS) y la extracci√≥n de secretos de la Autoridad de Seguridad Local (LSA)** .

Estas t√©cnicas permiten a los atacantes obtener datos de autenticaci√≥n confidenciales, evitando los controles de seguridad t√≠picos que pueden detectar y generar alertas r√°pidamente para m√©todos m√°s comunes como la fuerza bruta o los ataques de rociado y oraci√≥n. Al simular estos m√©todos de acceso avanzados, las plataformas BAS ayudan a las organizaciones a identificar posibles debilidades en sus mecanismos de protecci√≥n de credenciales y mejorar la seguridad de sus procesos de autenticaci√≥n.

## **Explotaci√≥n de vulnerabilidades conocidas**

Las plataformas de simulaci√≥n de infracciones y ataques pueden **explotar vulnerabilidades conocidas y emergentes** en software y sistemas para probar los procesos de gesti√≥n de parches y vulnerabilidades de una organizaci√≥n.¬† Para garantizar que los clientes puedan realizar simulaciones actualizadas contra las √∫ltimas amenazas, incluidas las vulnerabilidades de d√≠a cero, las soluciones BAS mantienen una biblioteca de exploits completa y constantemente actualizada.

Los profesionales del equipo rojo monitorean activamente fuentes como la **base de datos de vulnerabilidades y exposiciones comunes (CVE)** , as√≠ como los resultados de las investigaciones de seguridad, para identificar e integrar las **√∫ltimas vulnerabilidades de prueba de concepto (PoC)** en la biblioteca de amenazas. Al simular ataques utilizando vulnerabilidades conocidas y recientemente descubiertas, las plataformas BAS brindan a las organizaciones informaci√≥n valiosa sobre su postura de seguridad, lo que les permite abordar riesgos potenciales de manera proactiva y fortalecer sus defensas contra las amenazas en evoluci√≥n.

- **Campa√±as de ataque de amenazas persistentes avanzadas (APT)**

Las plataformas BAS pueden simular ataques de m√∫ltiples etapas utilizados por grupos APT, como APT42, Gamaredon, MuddyWater y Cozy Bear (APT29), para probar la capacidad de una organizaci√≥n para detectar, responder y recuperarse de amenazas sofisticadas y altamente espec√≠ficas. Los grupos APT a menudo emplean t√°cticas, t√©cnicas y procedimientos (TTP) avanzados, incluido malware personalizado, explotaci√≥n de vulnerabilidades cr√≠ticas y sin parches, y t√©cnicas de movimiento lateral, para infiltrarse en sus objetivos y mantener una presencia persistente.

Al imitar el comportamiento de estos notorios actores de amenazas, las plataformas BAS permiten a las organizaciones obtener informaci√≥n valiosa sobre su postura de seguridad e identificar debilidades en sus estrategias de defensa. Estas simulaciones pueden revelar vulnerabilidades potenciales en la seguridad de la red, la protecci√≥n de terminales y la concientizaci√≥n de los empleados que podr√≠an ser explotadas por grupos APT reales. Al comprender las t√°cticas utilizadas por estos adversarios avanzados, las organizaciones pueden mejorar su resiliencia general y desarrollar defensas espec√≠ficas para protegerse contra el panorama de amenazas en evoluci√≥n que plantean las APT .

- **Movimiento lateral**

Las plataformas BAS pueden simular ataques de movimiento lateral incorporando **t√©cnicas de reconocimiento** y ataque de recolecci√≥n dentro de la red organizacional. Durante la simulaci√≥n, las plataformas BAS primero realizan **la recopilaci√≥n de informaci√≥n** , de forma muy similar a como lo har√≠a un atacante real, utilizando t√©cnicas que incluyen, entre otras, consultas sobre GPO y LDAP, escaneo de host/IP y enumeraci√≥n de redes, etc. Esta fase de reconocimiento permite que la plataforma identifique objetivos potenciales, vulnerabilidades y configuraciones err√≥neas en la red.

Una vez que se ha recopilado la informaci√≥n, la plataforma BAS contin√∫a con el ataque de movimiento lateral aprovechando **los datos recopilados para acceder a otros puntos finales, servidores o repositorios de datos confidenciales dentro de la red**. La simulaci√≥n emplea varias t√©cnicas de ataque de acceso, como explotar vulnerabilidades del sistema, credenciales comprometidas o configuraciones incorrectas, para pasar a otra m√°quina o escalar privilegios.

Al replicar con precisi√≥n todo el proceso de ataque, desde el reconocimiento hasta el movimiento lateral, **las plataformas BAS brindan a las organizaciones informaci√≥n valiosa sobre posibles rutas de ataque** y la efectividad de la segmentaci√≥n de su red y las medidas de control de acceso. Esta informaci√≥n permite a las organizaciones mejorar sus medidas de seguridad, mejorar las defensas de la red y protegerse mejor contra ciberadversarios sofisticados.

- **Exfiltraci√≥n de datos**

BAS puede simular diferentes m√©todos de exfiltraci√≥n de datos, incluido el uso de canales encubiertos y t√©cnicas de ofuscaci√≥n de tr√°fico, **para probar la eficacia de** las soluciones de prevenci√≥n de p√©rdida de datos (DLP) y las capacidades de monitoreo. Al identificar posibles debilidades en las estrategias de protecci√≥n de datos, las organizaciones pueden salvaguardar mejor la informaci√≥n confidencial y reducir el riesgo de costosas violaciones de datos.

### **¬øQu√© tipos de controles de seguridad se pueden probar con simulaci√≥n de ataques e infracciones (BAS)?**

Las plataformas de simulaci√≥n de ataques y violaciones (BAS) pueden evaluar una amplia gama de controles de seguridad en toda la infraestructura de una organizaci√≥n, lo que ayuda a identificar debilidades potenciales y mejorar la postura general de seguridad. Algunos de los controles de seguridad que se pueden probar con BAS incluyen

1. **Controles de seguridad de la red**

Las plataformas BAS pueden simular ataques dirigidos a **firewalls de pr√≥xima generaci√≥n (NGFW)**, **sistemas de detecci√≥n de intrusiones (IDS)** , **sistemas de prevenci√≥n de intrusiones (IPS)**, **firewalls de aplicaciones web (WAF)** y **segmentaci√≥n de red**.

Por ejemplo, para probar la efectividad de una soluci√≥n IDS, BAS puede simular un ataque espec√≠fico que genera patrones de tr√°fico de red que se asemejan a firmas de ataques conocidas, como escaneo de puertos, volcado de memoria del proceso lsass.exe, solicitud de un TGT para realizar un Kerberoasting. ataque o intentar explotar vulnerabilidades conocidas. Este proceso prueba las capacidades de detecci√≥n del IDS y su capacidad para generar alertas en respuesta a actividades sospechosas.

2. **Controles de seguridad de terminales**

BAS puede simular infecciones de malware y ransomware para probar la eficacia de las **soluciones antivirus y antimalware** , **los sistemas de prevenci√≥n de intrusiones basados ‚Äã‚Äãen host (HIPS)** , las soluciones **de detecci√≥n y respuesta de endpoints (EDR)** y los firewalls basados ‚Äã‚Äãen host. Esto puede implicar intentar ejecutar cargas √∫tiles maliciosas en los puntos finales o intentar desactivar el software de seguridad.

3. **Controles de seguridad del correo electr√≥nico**

Al enviar **correos electr√≥nicos de phishing simulados** con **archivos adjuntos o enlaces maliciosos** , las plataformas BAS pueden probar los sistemas de filtrado de correo electr√≥nico de la organizaci√≥n, la seguridad de la puerta de enlace de correo electr√≥nico, los filtros de spam y las medidas antiphishing.

4. **Medidas de control de acceso**

BAS puede intentar eludir **la autenticaci√≥n multifactor** (MFA), explotar las debilidades en las configuraciones **de control de acceso basado en roles** (RBAC) o probar la resistencia de las soluciones **de gesti√≥n de identidad y acceso** (IAM) simulando ataques basados ‚Äã‚Äãen credenciales.

5. **Pol√≠ticas de gesti√≥n de vulnerabilidades**

Las plataformas BAS pueden explotar vulnerabilidades conocidas en software y sistemas para probar la efectividad de los procesos de administraci√≥n de parches, la administraci√≥n de inventario de software y hardware y las soluciones de escaneo de vulnerabilidades.

6. **Controles de seguridad de datos**

Al simular intentos de exfiltrar datos confidenciales, BAS puede probar la eficacia de las soluciones de prevenci√≥n de p√©rdida de datos (DLP), las tecnolog√≠as de cifrado y las configuraciones de almacenamiento seguro. Esto puede incluir simular transferencias de archivos, violaciones de bases de datos o acceso no autorizado a informaci√≥n confidencial.

7. **Controles de respuesta a incidentes**

BAS puede generar incidentes de seguridad simulados para probar las soluciones de gesti√≥n de eventos e informaci√≥n de seguridad (SIEM), los sistemas de gesti√≥n de registros y los procesos de respuesta a incidentes de la organizaci√≥n. Esto podr√≠a implicar la creaci√≥n de alertas de falsos positivos, la simulaci√≥n de una violaci√≥n de datos o la activaci√≥n de otros eventos de seguridad para evaluar el tiempo de respuesta y la eficacia del equipo de respuesta a incidentes.

## **Validaci√≥n del control de seguridad como caso de uso principal de simulaci√≥n de infracciones y ataques**

**La validaci√≥n del control de seguridad (SCV) se ha convertido en un caso de uso cr√≠tico para la simulaci√≥n de ataques e infracciones (BAS)** en el complejo panorama de amenazas actual. Al adoptar un enfoque centrado en las amenazas, las organizaciones pueden probar, medir y mejorar de forma eficaz el rendimiento de sus controles de seguridad en m√∫ltiples capas de prevenci√≥n y detecci√≥n. SCV ofrece informaci√≥n procesable que no solo optimiza la utilizaci√≥n de herramientas sino que tambi√©n identifica vulnerabilidades dentro de la infraestructura de seguridad de una organizaci√≥n.

SCV ofrece informaci√≥n valiosa que permite a las organizaciones **maximizar la eficiencia de sus herramientas de seguridad** e identificar vulnerabilidades dentro de su arquitectura de seguridad. Al simular una amplia variedad de escenarios de amenazas, como malware, ransomware y amenazas persistentes avanzadas (APT), como APT28 (Fancy Bear), APT32 y FIN7, una soluci√≥n de validaci√≥n de control de seguridad (SCV) facilita evaluaciones tanto continuas como bajo demanda. garantizando una puntuaci√≥n de seguridad actualizada.

Este enfoque din√°mico permite a las organizaciones **mantenerse a la vanguardia del cambiante panorama de amenazas y abordar de manera proactiva las amenazas emergentes** . Con SCV, las organizaciones pueden lograr una postura de seguridad m√°s s√≥lida y resiliente, listas para enfrentar los desaf√≠os de ciberseguridad en constante cambio que enfrentan.

![SCV](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/scv.png?raw=true)

Validaci√≥n del control de seguridad (SCV) como caso de uso principal de BAS. Si bien algunas herramientas BAS se centran principalmente en la gesti√≥n de la ruta de ataque o la gesti√≥n de la superficie de ataque, **las soluciones SCV se destacan por su conocimiento.**

**profundo y centrado en las amenazas**. En comparaci√≥n con las herramientas de prueba de penetraci√≥n automatizadas, las plataformas SCV poseen varias ventajas distintas:

## **Evaluaci√≥n de preparaci√≥n para amenazas de precisi√≥n**

Las plataformas SCV permiten a las organizaciones evaluar sus defensas contra amenazas espec√≠ficas del mundo real, como los ransomware LockBit, Royal y BlackByte.

Al simular estos vectores de ataque, SCV permite a las organizaciones priorizar los esfuerzos de remediaci√≥n y asignar recursos de manera eficiente, garantizando que las vulnerabilidades m√°s cr√≠ticas se aborden primero. Este enfoque espec√≠fico ayuda a las organizaciones a comprender y mitigar mejor sus riesgos √∫nicos.

- **Simulaci√≥n de cadena de muerte cibern√©tica de espectro completo**

**Las plataformas SCV simulan t√°cticas, t√©cnicas y procedimientos (TTP) en todas las etapas de la cadena de ciberataque** , desde el reconocimiento inicial hasta la filtraci√≥n de datos. Este enfoque integral permite a las organizaciones identificar y abordar vulnerabilidades en cada etapa, como un filtrado de correo electr√≥nico d√©bil que permite correos electr√≥nicos de phishing o una segmentaci√≥n de red inadecuada que permite el movimiento lateral. Al cubrir todo el ciclo de vida del ataque, SCV proporciona una visi√≥n hol√≠stica y profunda de la postura de seguridad de una organizaci√≥n.

- **Monitoreo continuo no disruptivo**

Los enfoques tradicionales de evaluaci√≥n de la seguridad, como los equipos rojos y las pruebas de penetraci√≥n, pueden alterar las operaciones comerciales porque a menudo requieren excepciones, como otorgar acceso al firewall. Una vez completada la evaluaci√≥n, estos cambios deben revertirse y los profesionales de seguridad deben asegurarse de no crear involuntariamente ninguna debilidad de seguridad en la postura general. Por el contrario, las plataformas de validaci√≥n del control de seguridad (SCV) brindan informaci√≥n continua sobre la infraestructura de seguridad de una organizaci√≥n. Esto permite realizar evaluaciones peri√≥dicas sin afectar negativamente la productividad. El monitoreo continuo ayuda a las organizaciones a identificar y abordar r√°pidamente las vulnerabilidades emergentes, manteniendo una postura de seguridad s√≥lida.

- **Contexto granular a trav√©s del an√°lisis de registros**

Las plataformas SCV aprovechan el an√°lisis de registros de eventos y otros datos contextuales, como patrones de tr√°fico de red y comportamiento de los usuarios, para ofrecer una comprensi√≥n integral de la infraestructura de seguridad de una organizaci√≥n. Este an√°lisis en profundidad puede revelar vectores de ataque ocultos e interdependencias entre los controles de seguridad, lo que permite a las organizaciones abordar las vulnerabilidades de manera m√°s efectiva. Por ejemplo, SCV puede identificar que el sistema de detecci√≥n de intrusiones de una organizaci√≥n no est√° configurado correctamente, lo que genera la posibilidad de que se produzcan infracciones no detectadas.

- **Sugerencias de mitigaci√≥n viables y priorizadas**

Las soluciones SCV generan recomendaciones pr√°cticas y priorizadas para abordar las brechas de seguridad identificadas. Por ejemplo, si se descubre que una organizaci√≥n es vulnerable a un tipo espec√≠fico de ransomware, la plataforma SCV puede recomendar actualizar el software antivirus, implementar una estrategia de respaldo m√°s s√≥lida o brindar capacitaci√≥n espec√≠fica a los empleados. Estas recomendaciones priorizadas ayudan a las organizaciones a centrar sus esfuerzos en las vulnerabilidades m√°s urgentes, mejorando su postura general de seguridad.

- **Escenarios de prueba personalizables**

Las plataformas SCV permiten a las organizaciones crear escenarios de prueba personalizados que se alineen con su panorama de amenazas espec√≠fico, apetito de riesgo y requisitos de cumplimiento. Por ejemplo, una instituci√≥n financiera podr√≠a configurar una plataforma SCV para centrarse en probar controles contra amenazas dirigidas a sistemas SWIFT, garantizando que la validaci√≥n sea espec√≠fica y relevante.

- **Integraci√≥n con herramientas de seguridad existentes**

Las plataformas SCV se integran perfectamente con las herramientas de seguridad existentes de una organizaci√≥n , como sistemas SIEM, soluciones de protecci√≥n de terminales y esc√°neres de vulnerabilidades. Esta integraci√≥n permite a las organizaciones maximizar la efectividad de sus inversiones en seguridad al brindar una vista unificada de su postura de seguridad, simplificar la administraci√≥n y permitir una colaboraci√≥n m√°s efectiva entre los equipos de seguridad.

Al utilizar una soluci√≥n SCV, las organizaciones pueden comprender mejor las debilidades y tomar medidas m√°s efectivas para mejorar su postura general de seguridad.

### **¬øEn qu√© se diferencia BAS de otros tipos de pruebas de ciberseguridad?**

La simulaci√≥n de infracciones y ataques (BAS) ofrece un enfoque de pruebas de ciberseguridad proactivo y automatizado que difiere de los m√©todos tradicionales, como las pruebas de penetraci√≥n, los equipos rojos y el escaneo de vulnerabilidades. Las soluciones de BAS se centran en validar la eficacia de los controles de seguridad existentes mediante la simulaci√≥n de ataques del mundo real a los sistemas de una organizaci√≥n, lo que permite una evaluaci√≥n y mejora continua de las defensas de seguridad.

En esta secci√≥n, vamos a examinar el BAS frente a otras soluciones tradicionales de evaluaci√≥n de seguridad, como:

- **Equipo rojo.**
- **Pruebas de penetraci√≥n.**
- **Escaneo de vulnerabilidades** .

# Simulaci√≥n de ataques e infracciones (BAS) frente a Red Teaming

La simulaci√≥n de infracciones y ataques (BAS) y el equipo rojo son m√©todos valiosos para evaluar la postura de ciberseguridad de una organizaci√≥n, pero difieren en varios aspectos clave. El equipo rojo involucra a un grupo de hackers √©ticos, o "equipo rojo", que simulan ataques del mundo real a los sistemas de una organizaci√≥n para identificar debilidades de seguridad. Si bien el equipo rojo puede proporcionar informaci√≥n valiosa, generalmente es un proceso manual, que consume mucho tiempo y recursos, con resultados puntuales que son v√°lidos por un corto per√≠odo de tiempo.

Por el contrario, **BAS ofrece una evaluaci√≥n automatizada, continua y escalable de los controles de seguridad de una organizaci√≥n** . Permite a las organizaciones probar sus defensas contra una amplia gama de escenarios de amenazas, incluidos malware, ransomware y amenazas persistentes avanzadas (APT), **sin necesidad de intervenci√≥n humana** . Esta automatizaci√≥n permite evaluaciones consistentes y continuas, lo cual es una ventaja significativa sobre la naturaleza puntual de los ejercicios de equipos rojos.

BAS tambi√©n se centra en validar la **eficacia de los controles de seguridad en toda la cadena de ciberataque** , proporcionando una visi√≥n integral de las defensas de una organizaci√≥n. Los equipos rojos, si bien exploran de manera similar la cadena de muerte cibern√©tica, est√°n limitados por la experiencia y la disponibilidad de los miembros del equipo rojo. Adem√°s, la **naturaleza automatizada de BAS permite a las organizaciones** probar una mayor cantidad de sistemas y controles de seguridad de manera m√°s eficiente que el equipo rojo.

Por √∫ltimo, BAS proporciona m√©tricas cuantificables que permiten a las organizaciones medir el desempe√±o de sus controles de seguridad y realizar un seguimiento de las mejoras a lo largo del tiempo. Los equipos rojos, por otro lado, a menudo producen resultados cualitativos que pueden ser m√°s dif√≠ciles de medir y comparar. Esta distinci√≥n hace que BAS sea un enfoque m√°s viable y basado en datos para evaluar la postura de ciberseguridad de una organizaci√≥n.

# Simulaci√≥n de ataques e infracciones (BAS) frente a pruebas de penetraci√≥n

La simulaci√≥n de infracciones y ataques (BAS) y las pruebas de penetraci√≥n sirven para evaluar la postura de ciberseguridad de una organizaci√≥n, pero difieren en varios aspectos clave. Uno de esos aspectos es el nivel de automatizaci√≥n y coherencia proporcionado por BAS, que permite evaluaciones continuas y peri√≥dicas de los controles de seguridad de una organizaci√≥n. Por el contrario, las pruebas de penetraci√≥n suelen ser manuales o semiautom√°ticas, lo que genera posibles inconsistencias en los resultados y una frecuencia limitada de las pruebas.

Adem√°s, BAS eval√∫a la eficacia de los controles de seguridad en toda la cadena de ciberataque, ofreciendo una visi√≥n integral de las defensas de una organizaci√≥n. Las pruebas de penetraci√≥n, por otro lado, normalmente se centran en objetivos o sistemas espec√≠ficos, que pueden no proporcionar una evaluaci√≥n completa de la postura general de seguridad.

Si bien las pruebas de penetraci√≥n identifican principalmente vulnerabilidades, BAS va un paso m√°s all√° al validar la efectividad de los controles de seguridad. Esta distinci√≥n permite a las organizaciones priorizar los esfuerzos de remediaci√≥n en funci√≥n del riesgo real, en lugar de simplemente abordar una lista de vulnerabilidades. Finalmente, la naturaleza automatizada de BAS permite una mayor escalabilidad, lo que permite a las organizaciones probar una mayor cantidad de sistemas y controles de seguridad de manera m√°s eficiente de lo que es posible con las pruebas de penetraci√≥n.

# Simulaci√≥n de ataques e infracciones (BAS) frente a escaneo de vulnerabilidades

La simulaci√≥n de infracciones y ataques (BAS) y el escaneo de vulnerabilidades son componentes esenciales de una estrategia integral de ciberseguridad, pero tienen diferentes prop√≥sitos y ofrecen beneficios √∫nicos. El escaneo de vulnerabilidades es un proceso automatizado que identifica posibles debilidades en los sistemas de una organizaci√≥n, como software desactualizado, configuraciones incorrectas o vulnerabilidades sin parches. Si bien este enfoque puede descubrir una amplia gama de problemas de seguridad, no valida la efectividad de los controles de seguridad implementados ni simula escenarios de ataques del mundo real.

Por otro lado, BAS se centra en probar el rendimiento de los controles de seguridad simulando varios escenarios de amenazas, incluidos malware, ransomware y amenazas persistentes avanzadas (APT). Este enfoque no s√≥lo identifica vulnerabilidades potenciales sino que tambi√©n valida qu√© tan bien los controles de seguridad pueden detectar, prevenir y responder a estas amenazas. A diferencia del escaneo de vulnerabilidades, que proporciona una instant√°nea de la postura de seguridad de una organizaci√≥n en un momento espec√≠fico, BAS ofrece evaluaciones continuas y automatizadas, lo que permite a las organizaciones mantener una comprensi√≥n actualizada de su postura de seguridad.

Adem√°s, BAS cubre toda la cadena de ciberataque, proporcionando una visi√≥n m√°s completa de las defensas de una organizaci√≥n, mientras que el escaneo de vulnerabilidades identifica principalmente debilidades en sistemas espec√≠ficos. BAS tambi√©n ofrece informaci√≥n pr√°ctica y recomendaciones de mitigaci√≥n para abordar las brechas de seguridad identificadas, lo que lo convierte en un enfoque m√°s espec√≠fico y estrat√©gico para mejorar la postura de seguridad general de una organizaci√≥n.

# Simulaci√≥n de infracciones y ataques (BAS) frente a evaluaciones de seguridad tradicionales

La siguiente tabla proporciona una comparaci√≥n concisa de la simulaci√≥n de ataques y violaciones (BAS) con otros m√©todos tradicionales de evaluaci√≥n de la ciberseguridad, como Red Teaming, pruebas de penetraci√≥n y escaneo de vulnerabilidades. Al examinar aspectos clave, como la automatizaci√≥n, la frecuencia de las evaluaciones, la validaci√≥n del control de seguridad y los conocimientos de mitigaci√≥n, esta tabla destaca las ventajas √∫nicas de BAS e ilustra por qu√© se ha convertido en un componente esencial de una estrategia integral de ciberseguridad.

|  | Simulaci√≥n de ataques e infracciones (BAS) | Pruebas de penetraci√≥n | equipo rojo | Escaneo de vulnerabilidades |
| --- | --- | --- | --- | --- |
| M√©todo de prueba | Automatizado y Continuo | Manual o semiautom√°tico | Manual | Automatizado |
| Frecuencia de prueba | Continuo y bajo demanda | Punto en el tiempo | Punto en el tiempo o peri√≥dico | Peri√≥dico o bajo demanda |
| Enfoque de control de seguridad | Validaci√≥n de la eficacia del control de seguridad | Explotaci√≥n de vulnerabilidades | Violar las defensas | Identificar vulnerabilidades |
| Escenarios de ataques del mundo real | Simulado | Limitado | S√≠ | Limitado |
| Velocidad y eficiencia | Alto | Moderado a bajo | Bajo | Alto |
| Intensidad de recursos | Bajo | Alto | Alto | Bajo |
| Alcance | A trav√©s de capas de prevenci√≥n y detecci√≥n | Sistemas/Aplicaciones Espec√≠ficas | En toda la organizaci√≥n | Sistemas/Aplicaciones Espec√≠ficas |
| Recomendaciones pr√°cticas | S√≠ | Limitado | Limitado | Limitado |
| Integraci√≥n con marcos de seguridad | S√≠ (por ejemplo, MITRE ATT&CK) | Limitado | Limitado | Limitado |
| M√©tricas cuantificables | S√≠ | Limitado | Limitado | Limitado |
| Pruebas no disruptivas | S√≠ | Puede causar interrupciones | Puede causar interrupciones | Interrupciones m√≠nimas |

## ¬øEs posible que las pruebas de simulaci√≥n de ataques e infracciones causen da√±os a los sistemas o datos de una organizaci√≥n?

Las pruebas de simulaci√≥n de ataques y violaciones (BAS) est√°n dise√±adas para ser un m√©todo seguro y no intrusivo para evaluar la postura de seguridad de una organizaci√≥n. Uno de los beneficios clave de BAS es su capacidad para simular ataques sin exponer datos confidenciales, lo que elimina el riesgo de violaciones o fugas de datos que podr√≠an preocupar a los profesionales de TI. Adem√°s, las pruebas BAS tienen un impacto m√≠nimo en el rendimiento del sistema, **lo que permite a las organizaciones realizar simulaciones sin ninguna interrupci√≥n en sus operaciones diarias** . Estas simulaciones se llevan a cabo en un entorno controlado, lo que garantiza que se eviten consecuencias no deseadas o efectos en cascada en otros sistemas.

Adem√°s, las soluciones BAS **est√°n dise√±adas para cumplir con los marcos regulatorios y de cumplimiento** , brindando a las organizaciones la seguridad de que sus actividades de prueba siguen cumpliendo. Las plataformas tambi√©n ofrecen par√°metros de prueba personalizables, lo que permite a los profesionales de TI adaptar las simulaciones de acuerdo con su entorno espec√≠fico y su tolerancia al riesgo. **Esta personalizaci√≥n ayuda a reducir la probabilidad de que se produzcan impactos no deseados en los sistemas que se prueban** .

Otro aspecto que hace de BAS una soluci√≥n confiable para los profesionales de TI es que **no requiere escaneo de red intrusivo ni excepciones de firewall** . Esto significa que la infraestructura de seguridad existente permanece intacta y sin alteraciones durante las pruebas, lo que refuerza a√∫n m√°s la seguridad y la **naturaleza no intrusiva de BAS** .

<aside>
üìñ En resumen, las pruebas BAS proporcionan a los profesionales de TI un m√©todo seguro, eficaz y no disruptivo para evaluar y validar la postura de seguridad de su organizaci√≥n. Al abordar posibles preocupaciones y ofrecer un enfoque libre de riesgos para mejorar las defensas de ciberseguridad, las soluciones BAS infunden confianza en los profesionales de TI que buscan un m√©todo confiable y seguro para probar sus controles de seguridad.
</aside>

## ¬øQu√© considerar al elegir una simulaci√≥n de ataque e infracci√≥n?

### Actualizado contra amenazas actuales y emergentes

Mantenerse actualizado contra **las amenazas emergentes** es esencial para una soluci√≥n BAS eficaz. El panorama de las ciberamenazas evoluciona constantemente y, como resultado, la biblioteca de amenazas utilizada por BAS debe actualizarse peri√≥dicamente para mantenerse al d√≠a con las nuevas t√©cnicas, vulnerabilidades y campa√±as.

### Simulaci√≥n de amenazas durante todo el ciclo de vida del ataque

Este criterio es esencial para una soluci√≥n BAS, ya que implica comprender y simular diversas t√©cnicas de ciberamenazas en todas las etapas del ciclo de vida del ataque, incluidas

- Ataques previos al compromiso
- Ataques de correo electr√≥nico
- Ataques de descarga de malware
- Ataques de explotaci√≥n de vulnerabilidades
- Ataques a aplicaciones web
- Ataques posteriores al compromiso
- Ataques a terminales at√≥micos
- Ataques de exfiltraci√≥n de datos
- Ataques de movimiento lateral
- Campa√±as de ataque
- Escenarios de ataque de malware
- Campa√±as de ataque de grupos de amenazas

dirigido por actores de amenazas como los grupos APT MuddyWater y Fancy Bear.

## Validaci√≥n de controles de seguridad empresarial

Las organizaciones utilizan numerosos controles de seguridad en diversas redes y ubicaciones. Una soluci√≥n BAS eficaz debe evaluar toda la infraestructura de seguridad e **integrarse** perfectamente con una gama de **tecnolog√≠as de prevenci√≥n y detecci√≥n** , incluidas, entre otras,

- Firewalls de pr√≥xima generaci√≥n (NGFW).
- Cortafuegos de aplicaciones web (WAF).
- Sistemas de Detecci√≥n de Intrusos (IDS).
- Sistemas de Prevenci√≥n de Intrusiones (IPS).
- Software antivirus y antimalware.
- Detecci√≥n y respuesta de terminales (EDR).
- Detecci√≥n y respuesta extendidas (XDR).
- Prevenci√≥n de p√©rdida de datos (DLP).
- Soluciones de gesti√≥n de eventos e informaci√≥n de seguridad (SIEM).
- Pasarelas de correo electr√≥nico.

### Simulaci√≥n continua y automatizada

**BAS proporciona simulaciones de ataques** continuas y automatizadas , identificando eficientemente puntos d√©biles en los controles de seguridad y monitoreando los cambios en las configuraciones de control. Este proceso **no requiere un operador** y puede detectar el estado de varios controles de seguridad.

### Validaci√≥n de reglas de detecci√≥n

BAS ayuda a abordar las ineficiencias en las operaciones del SOC causadas por alertas de falsos positivos. BAS valida las reglas de detecci√≥n, lo que permite a los equipos SOC evaluarlas y ajustarlas, lo que hace que el proceso de dise√±o y prueba de estas reglas sea m√°s eficiente y requiera menos tiempo.

### Personalizaci√≥n de amenazas

El panorama de amenazas cibern√©ticas de cada organizaci√≥n es √∫nico y requiere una priorizaci√≥n de amenazas personalizada. BAS deber√≠a ofrecer perfiles de amenazas para ayudar a los equipos de SOC a priorizar los riesgos. BAS tambi√©n deber√≠a permitir campa√±as y simulaciones de ataques personalizados, lo que permitir√≠a a los equipos de seguridad simular su panorama de amenazas espec√≠fico y evaluar su postura de seguridad de manera efectiva.

### Informaci√≥n de mitigaci√≥n directa y pr√°ctica

Las simulaciones de amenazas ayudan a evaluar los controles de seguridad e identificar brechas. Para abordar eficazmente estas brechas, una soluci√≥n BAS debe proporcionar contenido de mitigaci√≥n procesable para diversos controles de seguridad, incluso para amenazas emergentes y vulnerabilidades de d√≠a cero. Esto permite a los equipos SOC desarrollar r√°pidamente estrategias de mitigaci√≥n personalizadas.

### Informes personalizados y en tiempo real

Las soluciones BAS deben generar informes de evaluaci√≥n adecuados para diversas partes interesadas, incluidos ejecutivos, equipos SOC y auditores. Estos informes deben presentar m√©tricas en tiempo real, como puntuaci√≥n de seguridad general, tasa de detecci√≥n, recopilaci√≥n de registros, detecci√≥n y prevenci√≥n.

### Mapeo a MITRE ATT&CK y otros marcos

Una soluci√≥n BAS eficaz debe proporcionar soporte integral para los marcos industriales establecidos, como el marco MITRE ATT&CK. Al asignar sus t√©cnicas y simulaciones de amenazas a estos marcos, una soluci√≥n BAS puede ayudar a las organizaciones a identificar sus brechas de seguridad bas√°ndose en metodolog√≠as estandarizadas. Esta alineaci√≥n tambi√©n permite a los equipos de seguridad comparar su postura de seguridad con las mejores pr√°cticas de la industria y priorizar los esfuerzos de remediaci√≥n en funci√≥n de las amenazas m√°s relevantes y prevalentes.

### Facilidad de uso y facilidad de implementaci√≥n

Una soluci√≥n BAS debe ser f√°cil de implementar y utilizar para garantizar una integraci√≥n perfecta con la infraestructura de seguridad existente de una organizaci√≥n. La soluci√≥n debe tener una interfaz f√°cil de usar y proporcionar instrucciones claras para la implementaci√≥n, configuraci√≥n y mantenimiento. Adem√°s, debe ofrecer opciones de implementaci√≥n flexibles, como local, basada en la nube o h√≠brida, para adaptarse a diferentes necesidades organizativas y arquitecturas de red. Una soluci√≥n f√°cil de usar y de implementar fomentar√° la adopci√≥n y ayudar√° a las organizaciones a maximizar los beneficios de una soluci√≥n BAS.

# Preguntas frecuentes (FAQ)

Estas son las preguntas m√°s frecuentes sobre la simulaci√≥n de ataques e infracciones

- **¬øSe pueden integrar las herramientas de simulaci√≥n de ataques e infracciones con otras tecnolog√≠as de seguridad en mi organizaci√≥n?**

S√≠, las herramientas de simulaci√≥n de infracciones y ataques se pueden integrar con otras tecnolog√≠as de seguridad, como SIEM, esc√°neres de vulnerabilidades, IDS/IPS y EPP. La integraci√≥n puede mejorar la eficacia de BAS al proporcionar contexto y visibilidad adicionales de la postura de seguridad de la organizaci√≥n.

- **¬øC√≥mo puedo medir la eficacia de los controles de seguridad mediante la simulaci√≥n de ataques e infracciones?**

Puede medir la eficacia de los controles de seguridad simulando varios escenarios de ataque y evaluando c√≥mo responden sus controles de seguridad a ellos. BAS tambi√©n puede monitorear y evaluar continuamente su postura de seguridad, identificar vulnerabilidades y priorizar los esfuerzos de remediaci√≥n en funci√≥n del riesgo

- **¬øCu√°les son algunas de las mejores pr√°cticas para implementar y gestionar un programa de simulaci√≥n de ataques e infracciones?**

Las mejores pr√°cticas para implementar y gestionar un programa BAS incluyen establecer objetivos claros, seleccionar herramientas adecuadas, definir escenarios de prueba, involucrar a las partes interesadas clave y priorizar los esfuerzos de remediaci√≥n en funci√≥n del riesgo. Tambi√©n es importante revisar y actualizar peri√≥dicamente el programa BAS para garantizar su eficacia.

## **Las 19 principales herramientas de simulaci√≥n de ataques e infracciones (BAS) en 2024**

Las herramientas de simulaci√≥n de infracciones y ataques (BAS) pueden detectar autom√°ticamente vulnerabilidades en las defensas cibern√©ticas de una organizaci√≥n, de forma similar a las pruebas de penetraci√≥n continuas y automatizadas. Las soluciones BAS a menudo recomiendan y priorizan la reparaci√≥n para maximizar los recursos de seguridad y minimizar el riesgo cibern√©tico.

Algunos proveedores se refieren a las soluciones BAS avanzadas como *validaci√≥n de seguridad* o *gesti√≥n continua de exposici√≥n a amenazas* (CTEM). Varias de estas herramientas tambi√©n eval√∫an defensas de seguridad m√°s amplias y posibles rutas de ataque, un mercado conocido como *gesti√≥n de la superficie de ataque* . La inteligencia artificial y el aprendizaje autom√°tico son una parte importante del mercado BAS, ya que se necesitan herramientas de ciberseguridad automatizadas para mantenerse al d√≠a con el enorme volumen de vulnerabilidades y amenazas emergentes.

Analizamos el mercado de herramientas BAS para elaborar esta lista de los 19 principales proveedores, adem√°s de 8 menciones honor√≠ficas adicionales, seguidas de m√°s informaci√≥n sobre tecnolog√≠a de simulaci√≥n de ataques e infracciones y consideraciones de compra.

**Cuadro comparativo de los 20 mejores proveedores de simulaci√≥n de ataques e infracciones (BAS)**

|  | Mejor para | Gesti√≥n de exposici√≥n | An√°lisis de ruta de ataque | Integraci√≥n con servicio de terceros. | APT de cadena de eliminaci√≥n completa | Precio inicial |
| --- | --- | --- | --- | --- | --- | --- |
| AttackIQ | Pruebas de seguridad de IA/ML | S√≠ | S√≠ | S√≠ | S√≠ | $227,500.00 pago √∫nico, por a√±o |
| Cymulate | Experiencia de usuario | S√≠ | S√≠ | S√≠ | S√≠ | $7,000 |
| Picus Security | Detecci√≥n de registros y lagunas de alerta | S√≠ | S√≠ | S√≠ | S√≠ | $30,000 |
| SafeBreach | Integraci√≥n con otras herramientas de seguridad. | S√≠ | S√≠ | S√≠ | S√≠ | $18,000 |
| XM Cyber | Gesti√≥n de rutas de ataque | S√≠ | S√≠ | S√≠ | S√≠ | $7,500 |
| CyCognito | Detecci√≥n y priorizaci√≥n de riesgos | S√≠ | S√≠ | S√≠ | S√≠ | $30,000 |
| FireMon | Herramienta BAS para visualizaci√≥n. | S√≠ | S√≠ | S√≠ | S√≠ | No proporcionado por el proveedor |
| Akamai Guardicore
Infection Monkey | Microsegmentaci√≥n, visibilidad y control de la red | S√≠ | S√≠ | S√≠ | S√≠ | C√≥digo abierto y gratuito |
| Mandiant | Inteligencia de amenazas | S√≠ | S√≠ | S√≠ | Limitado | No proporcionado por el proveedor |
| qualys | Gesti√≥n de vulnerabilidades y cumplimiento de seguridad. | S√≠ | S√≠ | S√≠ | S√≠ | $542 por mes |
| randori | equipo rojo | S√≠ | S√≠ | S√≠ | Limitado | No proporcionado por el proveedor |
| Rapid7 | An√°lisis de riesgos asequible | S√≠ | S√≠ | S√≠ | S√≠ | $1.62 por activo por mes |
| BreachLock | Pentesting de redes y web | S√≠ | No | S√≠ | No | No proporcionado por el proveedor |
| Horizon3.ai | Startups y peque√±as empresas | S√≠ | S√≠ | S√≠ | S√≠ | $24,999 por a√±o |
| NetSPI | Herramienta BAS para probadores de pluma | S√≠ | Limitado | S√≠ | S√≠ | No proporcionado por el proveedor |
| Pentera | Validaci√≥n de seguridad automatizada | S√≠ | S√≠ | S√≠ | No | No proporcionado por el proveedor |
| Scythe | Emulaci√≥n del adversario | S√≠ | Limitado | S√≠ | Limitado | No proporcionado por el proveedor |
| Skybox Security | Integraci√≥n con diferentes fuentes de datos | S√≠ | S√≠ | S√≠ | Limitado | No proporcionado por el proveedor |
| Tenable | An√°lisis y visibilidad de la superficie de ataque | S√≠ | S√≠ | S√≠ | Limitado | $2,934.75 por a√±o |

# AttackIQ

**Lo mejor para pruebas de seguridad de IA/ML**

[AttackIQ](https://www.attackiq.com/) comenz√≥ como una plataforma de validaci√≥n automatizada en 2013 en San Diego, California. La plataforma permite a las organizaciones probar y medir su postura de seguridad en todos los entornos. Informados por la matriz MITRE ATT&CK y su riqueza en comportamiento de adversarios cibern√©ticos, los clientes pueden ejecutar escenarios avanzados dirigidos a activos cr√≠ticos y mejorar continuamente su postura defensiva.

El motor anat√≥mico de AttackIQ es una caracter√≠stica destacada, ya que puede probar componentes de ciberseguridad basados ‚Äã‚Äãen ML y IA. Con la capacidad de ejecutar emulaciones de m√∫ltiples etapas, probar controles de red y analizar respuestas a infracciones, AttackIQ sigue siendo uno de los principales competidores entre las soluciones BAS.

**Funciones De AttackIQ**

- **Integraci√≥n:** se integra con varias soluciones de terceros, incluidas Palo Alto Networks, Splunk, Cisco y RSA.
- **Compatibilidad con sistemas operativos:** admite todos los principales sistemas operativos, incluidos Windows, Linux y macOS.
- **Implementaci√≥n flexible:** AttackIQ se puede implementar localmente y en la nube
- **Insight de la postura de seguridad:** visibilidad en tiempo real del rendimiento de la seguridad
- **Seguridad en la nube:** valide los controles de seguridad nativos integrados en proveedores de la nube como Azure y AWS.
- **Gesti√≥n de riesgos:** utiliza el marco MITRE ATT&CK para validar los controles de seguridad NIST 800-53 y CMMC autom√°ticamente

### **Ventajas**

- Soporte para entornos locales y en la nube
- Valida los controles de seguridad nativos de la nube
- Validaci√≥n de seguridad de IA/ML

### **Contras**

- A los usuarios les gustar√≠a ver m√°s integraciones
- Algunas quejas sobre los desaf√≠os de implementaci√≥n

### **Precios**

AttackIQ no incluye p√∫blicamente informaci√≥n sobre precios en su sitio web. Sin embargo, ofrecen una prueba gratuita y una demostraci√≥n personalizada en l√≠nea para ayudar a los compradores potenciales a comprender sus servicios y determinar la mejor opci√≥n de precio para sus necesidades.

El peque√±o precio que est√° [disponible p√∫blicamente](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/attackiq.attackiq-platform?tab=PlansAndPrice) en Azure Marketplace sugiere que no es un producto barato (paquete de inicio AttackIQ: pago √∫nico de $227,500.00 por a√±o, o pago √∫nico de $580,125.00 por un per√≠odo de facturaci√≥n de 3 a√±os), pero los usuarios entienden que Est√°s adquiriendo un producto que va mucho m√°s all√° de lo b√°sico.

Tenga en cuenta que las tarifas del paquete de inicio de AttackIQ est√°n sujetas a cambios a partir del 1 de agosto de 2023. El precio actualizado para el per√≠odo de facturaci√≥n de un a√±o ser√° un pago √∫nico de $250 250, mientras que el precio del per√≠odo de facturaci√≥n de 3 a√±os aumentar√° a un pago √∫nico de $638 138. .

# Cymulate

**Lo mejor para usabilidad y experiencia de usuario.**

[Cymulate](https://cymulate.com/) es el primero de dos proveedores israel√≠es de nuestras soluciones BAS de primer nivel. Fundado en 2016, el proveedor con sede en Rishon LeZion se especializa en simulaci√≥n de ataques e infracciones y verificaci√≥n de posturas de seguridad. Al emplear el marco MITRE ATT&CK e imitar una variedad de estrategias avanzadas de piratas inform√°ticos , la plataforma Cymulate eval√∫a segmentos de red, detecta vulnerabilidades y optimiza la soluci√≥n.

Para enfrentar el panorama din√°mico de amenazas, Cymulate ofrece validaci√≥n de seguridad continua que brinda una gu√≠a consistente para la acci√≥n. La implementaci√≥n de Cymulate con simulaciones de ataques casi ilimitadas se puede completar en cuesti√≥n de minutos a trav√©s de un √∫nico agente liviano.

**Funciones De Cymulate**

- **Correcci√≥n de ataques:** le permite priorizar la correcci√≥n en funci√≥n de las vulnerabilidades atacables.
- **Seguridad de endpoints:** detecta y previene TTP ATT&CK de endpoints, como ransomware y gusanos.
- **Exfiltraci√≥n de datos:** garantiza que los datos confidenciales de la empresa no puedan ser extra√≠dos.
- **APT de cadena de destrucci√≥n completa:** valide la defensa de su empresa contra escenarios de ataques APT como Fin8, APT38, Lazarus y escenarios personalizados.
- **Puerta de enlace de correo electr√≥nico:** pruebe su seguridad frente a miles de formatos de correo electr√≥nico, archivos adjuntos y URL maliciosos
- **Firewall de aplicaciones web:** eval√∫e su seguridad contra ataques de aplicaciones web como los diez primeros de OWASP

### **Ventajas**

- Los usuarios elogian sus recursos para evaluaciones de riesgos cibern√©ticos y pruebas de penetraci√≥n.
- F√°cil de configurar y utilizar
- Ofrece alertas de amenazas instant√°neas.
- Seguridad de endpoints basada en firmas y comportamientos

### **Contras**

- Algunos usuarios informaron que la capacidad de escaneo se puede mejorar
- Agregar m√°s integraci√≥n con otras herramientas de seguridad puede mejorar a√∫n m√°s la herramienta.
- La capacidad de generaci√≥n de informes se puede mejorar

### **Precios**

La informaci√≥n de precios de este producto no est√° disponible en el sitio web del proveedor. Los compradores potenciales pueden comunicarse con el equipo de ventas de Cymulate para obtener cotizaciones personalizadas adaptadas a sus necesidades. Cymulate ofrece una prueba gratuita de 14 d√≠as y los compradores potenciales tambi√©n pueden solicitar una demostraci√≥n del producto. [Los precios disponibles p√∫blicamente](https://aws.amazon.com/marketplace/pp/prodview-dkbtesatc6b4o) en AWS muestran que el paquete de vector de ataque Cymulate 7 para organizaciones con hasta 1.000 puntos finales puede costar alrededor de $7.000 al mes o $91.000 al a√±o.

## Picus Security

**Lo mejor para detectar registros y lagunas de alerta**

[Picus Security](https://www.picussecurity.com/) es un proveedor de validaci√≥n de seguridad continua fundado en 2013 y ubicado en San Francisco, California. Reconocido en cada una de nuestras principales listas de BAS, Picus ha recaudado m√°s de $32 millones a trav√©s de la Serie B y una ronda de financiaci√≥n corporativa de Mastercard en mayo de 2022. La plataforma Picus Security Control Validation (SCV) busca vulnerabilidades y ofrece orientaci√≥n para configurar controles de seguridad.

Al integrarse en un sistema de gesti√≥n de eventos e informaci√≥n de seguridad (SIEM) existente, Picus SCV ayuda a identificar brechas de registro y alerta donde se requieren acciones adicionales para optimizar su SIEM. Con MITRE ATT&CK y la visibilidad de la cadena de destrucci√≥n, los administradores que implementan SCV pueden tomar las medidas necesarias para prevenir el pr√≥ximo ataque avanzado.

### **Funciones De Seguridad De Picus**

- **Biblioteca de amenazas:** la biblioteca de amenazas de Picus Security con m√°s de 3500 amenazas que cubren el marco MITRE ATT&CK se actualiza peri√≥dicamente
- **Validaci√≥n del control de seguridad:** pruebe la eficacia de los controles de detecci√≥n y seguridad de su red , incluidos firewalls , puertas de enlace web y de correo electr√≥nico, herramientas SIEM, EDR y SOAR.
- **Biblioteca de mitigaci√≥n:** Picus Security proporciona m√°s de 70 000 recomendaciones pr√°cticas para solucionar las brechas de seguridad, as√≠ como sugerencias de mitigaci√≥n espec√≠ficas del proveedor dirigidas a su entorno.
- **Validaci√≥n de ruta de ataque (APV):** Picus APV ayuda a los equipos de seguridad a detectar y visualizar autom√°ticamente la ruta de un atacante evasivo hacia sistemas y cuentas importantes.
- **Integraci√≥n:** Picus se integra con varias herramientas de terceros, incluidas Citrix, Cisco, IBM Security, McAfee, F5, Trend Micro y m√°s.

### **Ventajas**

- Evaluaci√≥n continua
- Proporciona a los usuarios recomendaciones para ayudar a fortalecer a√∫n m√°s sus redes.
- Pruebas automatizadas
- Admite m√°s de 100 escenarios de APT y malware

### **Contras**

- Los comentarios de los usuarios de los sitios de revisi√≥n muestran que Picus Security tiene una configuraci√≥n inicial compleja
- Algunos usuarios dicen que el tiempo de soporte t√©cnico es insuficiente, la documentaci√≥n del producto se puede mejorar para ayudar a los usuarios a resolver problemas menores r√°pidamente.

### **Precios**

Picus Security no anuncia precios en su sitio web, ya que los paquetes y servicios se adaptan a las necesidades exactas del cliente. Generalmente, los precios de sus servicios oscilan entre $30.000 y $120.000, dependiendo del alcance del paquete elegido. Para recibir un presupuesto personalizado adaptado a sus necesidades, p√≥ngase en contacto con su equipo de ventas. Tambi√©n puedes aprovechar su prueba gratuita de 14 d√≠as o solicitar una demostraci√≥n del producto.

## SafeBreach

Lo mejor para la integraci√≥n con otras herramientas de seguridad

[SafeBreach](https://www.safebreach.com/) posee m√∫ltiples patentes y premios por su tecnolog√≠a BAS. Fundado en 2014, el proveedor con sede en California es pionero en simulaci√≥n de infracciones. Desde nuestra √∫ltima actualizaci√≥n, SafeBreach obtuvo una ronda de financiaci√≥n Serie D de 53,5 millones de d√≥lares en noviembre de 2021. La plataforma BAS puede detectar infiltraci√≥n, movimiento lateral y exfiltraci√≥n de datos al ofrecer simuladores de nube, red y terminales .

SafeBreach valida continuamente las herramientas y la postura general de seguridad de la organizaci√≥n ante un panorama de amenazas en constante cambio. Cuando se marcan, los administradores tienen la visibilidad para tomar medidas inmediatas contra posibles vulnerabilidades. Con la plataforma SafeBreach implementada, las organizaciones pueden esperar una mayor eficacia del control de seguridad, una emulaci√≥n de amenazas reales y una seguridad mejorada en la nube .

### **Funciones De SafeBreach**

- **Integraci√≥n:** SafeBreach se integra con varios proveedores de soluciones tecnol√≥gicas, incluidos Splunk, ServiceNow, Google BigQuery, Tanium, Checkpoint, IBM, Slack, Qualys y m√°s.
- **Informes:** proporciona informes en tiempo real y acciones correctivas.
- **SafeBreach-as-a-Service:** SafeBreach est√° disponible como una soluci√≥n de software totalmente administrada que consta de licencias de plataforma, estrategia continua y soporte completo.
- **RansomwareRx:** permite a los usuarios ejecutar un escenario de ataque personalizado y sin costo basado en el comportamiento real del ransomware, incluidos los TTP de MITRE ATT&CK.
- **Sin c√≥digo:** permite a los usuarios planificar todos los aspectos del ataque en un √∫nico entorno sin c√≥digo.

### **Ventajas**

- Capacidad para simular m√°s de 15.000 ataques.
- Los paneles muestran los riesgos de seguridad a lo largo del tiempo
- Ofrece simuladores de nube, red y endpoints.

### **Contras**

- La atenci√≥n al cliente se puede mejorar. Los usuarios informaron un tiempo de respuesta lento
- Se necesita tiempo para aprender y acostumbrarse a la interfaz de usuario

### **Precios**

SafeBreach no anuncia precios en su sitio web. Los compradores interesados ‚Äã‚Äãpueden ponerse en contacto con su equipo de ventas para obtener presupuestos personalizados. Tambi√©n puede solicitar una demostraci√≥n gratuita para aprender c√≥mo aprovechar el producto para su entorno. [Los precios disponibles p√∫blicamente](https://aws.amazon.com/marketplace/pp/prodview-72hqyj4k5upty?sr=0-1&ref_=beagle&applicationId=AWSMPContessa) en AWS muestran que el simulador SafeBreach puede costar alrededor de $18,000 por una suscripci√≥n anual.

## XM Cyber

**Lo mejor para la gesti√≥n de rutas de ataque**

[XM Cyber](https://www.xmcyber.com/) ‚Äã‚Äães un proveedor de seguridad en la nube y an√°lisis de riesgos cibern√©ticos con sede en Tel Aviv lanzado en 2016. Nacido del liderazgo intelectual del sector de inteligencia israel√≠, XM Cyber ‚Äã‚ÄãBreach and Attack Simulator, anteriormente conocido como HaXM, es una soluci√≥n BAS l√≠der. En su corta trayectoria, el proveedor ha estado a la vanguardia de la innovaci√≥n de BAS, ganando varios premios e impulsando a otros proveedores hacia adelante.

XM Cyber ‚Äã‚Äãidentifica los activos m√°s cr√≠ticos de una organizaci√≥n y trabaja hacia atr√°s con priorizaci√≥n de exposici√≥n centrada en ataques, identificando las rutas de explotaci√≥n. El an√°lisis de cada posible ruta de ataque y la elaboraci√≥n de opciones de soluci√≥n basadas en el impacto del riesgo brindan a los administradores visibilidad en tiempo real para proteger su red. Gracias a su √©xito, Schwarz Group adquiri√≥ XM Cyber ‚Äã‚Äãpor 700 millones de d√≥lares en noviembre de 2021.

### **Funciones Cibern√©ticas De XM**

- **Flexible:** permite a las organizaciones priorizar las exposiciones de seguridad y centrar las actividades de remediaci√≥n en la nube, SaaS y en las instalaciones.
- **Validaci√≥n de cumplimiento:** automatice la validaci√≥n y los informes de cumplimiento para est√°ndares clave como ISO, NIST, GDPR, SWIFT y PCI.
- **Gesti√≥n de rutas de ataque:** APM permite a los usuarios detectar ataques antes de que ocurran de forma proactiva
- **Seguridad de la nube h√≠brida:** identifique las exposiciones en sus entornos AWS, Azure y GCP
- **Seguridad de Active Directory:** Neutralice los riesgos de Active Directory en entornos locales y en la nube
- **Red Teaming y pruebas de penetraci√≥n automatizadas:** proporciona una evaluaci√≥n en tiempo real del rendimiento de sus herramientas de seguridad y utiliza modelos de ataques para revelar configuraciones incorrectas, credenciales mal administradas y actividad de usuario riesgosa.

### **Ventajas**

- Realice un seguimiento de la postura general de seguridad y el nivel de riesgo de los usuarios.
- Capacidad de an√°lisis avanzado
- Escaneo de red de extremo a extremo
- Proporciona a los usuarios visibilidad de sus rutas de ataque cr√≠ticas.

### **Contras**

- Los usuarios informan que la herramienta es cara, lo que dificulta la compra de las peque√±as empresas.
- La atenci√≥n al cliente se puede mejorar y optimizar para lograr un tiempo de respuesta r√°pido.

### **Precios**

Esta es una herramienta basada en cotizaciones y el precio est√° disponible previa solicitud. Comun√≠quese con XM Cyber ‚Äã‚Äãpara obtener cotizaciones personalizadas. Tambi√©n puede solicitar una demostraci√≥n personalizada para conocer m√°s sobre la soluci√≥n. [AWS Marketplace](https://aws.amazon.com/marketplace/pp/prodview-erpca7xqvyocu?sr=0-1&ref_=beagle&applicationId=AWSMPContessa) muestra que los precios de la simulaci√≥n de ataque h√≠brido de XM Cyber ‚Äã‚Äãpara hasta 1000 activos cuestan alrededor de $7500 por mes o $90 000 por a√±o, mientras que su gesti√≥n de vulnerabilidades de pr√≥xima generaci√≥n cuesta alrededor de $1083 por mes o $13 000 por a√±o para hasta 1000 activos.

## CyCognito

**La mejor herramienta BAS para la detecci√≥n y priorizaci√≥n de riesgos**

[CyCognito](https://www.cycognito.com/) se compromete a exponer el riesgo oculto y poner a la vista las amenazas avanzadas. Uno de los proveedores de BAS m√°s j√≥venes inici√≥ operaciones en 2017 y reside en Palo Alto, California. Fundada por profesionales titulares de inteligencia nacional, CyCognito identifica activos expuestos a atacantes para mejorar la visibilidad del ataque y proteger las superficies.

Seg√∫n el proveedor, los clientes identifican hasta un 300% m√°s [de activos](https://www.esecurityplanet.com/products/top-it-asset-management-tools-for-security/) de los que sab√≠an que exist√≠an en su red. A trav√©s de la plataforma CyCognito, las organizaciones pueden definir categor√≠as de riesgo, automatizar operaciones ofensivas de ciberseguridad y prepararse para cualquier ataque avanzado posterior. El vendedor en ciernes contin√∫a creciendo con una Serie D de $100 millones en diciembre de 2021.

### **Caracter√≠sticas De CyCognito**

**Grafique las relaciones comerciales y de activos:** la plataforma CyCognito aprovecha el aprendizaje autom√°tico, el procesamiento del lenguaje natural y la